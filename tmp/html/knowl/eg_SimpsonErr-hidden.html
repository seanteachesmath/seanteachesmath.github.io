<!DOCTYPE html>
<html lang="en-US">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*       on 2021-04-15T17:03:16-05:00       *-->
<!--*   A recent stable commit (2020-08-09):   *-->
<!--* 98f21740783f166a773df4dc83cab5293ab63a4a *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body><article class="example example-like"><p xmlns:svg="http://www.w3.org/2000/svg">Suppose now that we wish evaluate \(\int_0^1 e^{-x^2}\,\dee{x}\) to within an accuracy of  \(10^{-6}\) — but now using Simpson's rule. How many steps should we use?</p>
<p><em xmlns:svg="http://www.w3.org/2000/svg" class="alert">Solution:</em></p>
<ul class="disc">
<li>Again we have \(a=0,b=1\text{.}\)</li>
<li>We then need to bound \(\ddiff{4}{}{x}e^{-x^2}\) on the domain of integration, \(0\leq  x\leq 1\text{.}\)<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{align*}
\ddiff{3}{}{x}e^{-x^2}
&amp;=\diff{}{x}\big\{2(2x^2-1)e^{-x^2}\big\}
=8xe^{-x^2}-4x(2x^2-1)e^{-x^2}\\
&amp;=4(-2x^3+3x)e^{-x^2}\\
\ddiff{4}{}{x}e^{-x^2}
&amp;=\diff{}{x}\big\{4(-2x^3+3x)e^{-x^2}\big\}\\
&amp;=4(-6x^2+3)e^{-x^2}\hskip-4pt-8x(-2x^3+3x)e^{-x^2}\\
&amp;=4(4x^4-12x^2+3)e^{-x^2}
\end{align*}
</div>
</li>
<li>Now, for any \(x\text{,}\)  \(e^{-x^2}\le 1\text{.}\) Also, for \(0\le x\le 1\text{,}\)<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{align*}
0 &amp; \leq x^2, x^4 \leq 1 &amp; \text{ so}\\
3 &amp; \leq 4x^4+3 \leq 7 &amp; \text{ and }\\
-12 &amp; \leq -12x^2 \leq 0 &amp; \text{adding these together gives}\\
-9 &amp; \leq 4x^4-12x^2 + 3 \leq 7
\end{align*}
</div>Consequently, \(|4x^4-12x^2+3|\) is bounded by \(9\) and so<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{gather*}
\left|\ddiff{4}{}{x}e^{-x^2}\right| \leq 4\times 9=36
\end{gather*}
</div>So take \(L=36\text{.}\)</li>
<li>The error introduced by the \(n\) step Simpson's rule is at most<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{align*}
e_n &amp; \leq \frac{L}{180}\frac{(b-a)^5}{n^4}\\
&amp; \leq \frac{36}{180} \frac{(1-0)^5}{n^4} = \frac{1}{5n^4}
\end{align*}
</div>
</li>
<li>In order for this error to be no more than \(10^{-6}\) we require \(n\) to satisfy<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{align*}
e_n &amp;\leq \frac{1}{5n^4} \leq 10^{-6} &amp; \text{and so}\\
5n^4 &amp; \geq 10^6\\
n^4 &amp;\geq 200000 &amp; \text{take fourth root}\\
n &amp; \geq 21.15
\end{align*}
</div>So \(22\) steps of Simpson's rule will do the job.</li>
<li>\(n=22\) steps actually results in an error of \(3.5\times 10^{-8}\text{.}\) The reason that  we get an error so much smaller than we need is that we have overestimated the number of  steps required. This, in turn, occurred because we made quite a rough bound of  \(\left|\ddiff{4}{}{x}f(x)\right|\leq 36\text{.}\) If we are more careful then we will get a  slightly smaller \(n\text{.}\) It actually turns out <a class="fn-knowl original" data-knowl="./knowl/fn-261-hidden.html" title="Footnote 6.11.12"><sup> 12 </sup></a> that you only need \(n=10\) to approximate within \(10^{-6}\text{.}\)</li>
</ul></article></body>
</html>
