<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*       on 2021-04-15T15:30:45-05:00       *-->
<!--*   A recent stable commit (2020-08-09):   *-->
<!--* 98f21740783f166a773df4dc83cab5293ab63a4a *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Numerical Integration</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.min.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/0.13/pretext.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script xmlns:svg="http://www.w3.org/2000/svg">sagecellEvalName='Evaluate (Sage)';
</script><link xmlns:svg="http://www.w3.org/2000/svg" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/colors_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link xmlns:svg="http://www.w3.org/2000/svg" href="developer.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div xmlns:svg="http://www.w3.org/2000/svg" class="hidden-content" style="display:none">\(\require{palatino}\require{mathrsfs}\require{cancel}\require{nicefrac} \newcommand{\dee}[1]{\mathrm{d}#1}
 \newcommand{\half}{ \frac{1}{2} }
 \newcommand{\veps}{\varepsilon}
 \newcommand{\ds}{\displaystyle}
 \newcommand{\ts}{\textstyle}
 \newcommand{\es}{ {\varnothing}}
 \newcommand{\st}{ {\mbox{ s.t. }} }
 \newcommand{\pow}[1]{ \mathcal{P}\left(#1\right) }
 \newcommand{\set}[1]{ \left\{#1\right\} }
 \newcommand{\lin}{{\text{LIN}}}
 \newcommand{\quot}{{\text{QR}}}
 \newcommand{\simp}{{\text{SMP}}}
 \newcommand{\diff}[2]{ \frac{\mathrm{d}#1}{\mathrm{d}#2}}
 \newcommand{\pdiff}[2]{ \frac{\partial #1}{\partial #2}}
 \newcommand{\bdiff}[2]{ \frac{\mathrm{d}}{\mathrm{d}#2} \left( #1 \right)}
 \newcommand{\ddiff}[3]{ \frac{\mathrm{d}^#1#2}{\mathrm{d}{#3}^#1}}
 \newcommand{\difftwo}[2]{ \frac{\mathrm{d^2}#1}{\mathrm{d}{#2}^2}}

 \newcommand{\eqf}[1]{{\buildrel \rm #1 \over =}}

 \renewcommand{\neg}{ {\sim} }
 \newcommand{\limp}{ {\;\Rightarrow\;} }
 \newcommand{\nimp}{ {\;\not\Rightarrow\;} }
 \newcommand{\liff}{ {\;\Leftrightarrow\;} }
 \newcommand{\niff}{ {\;\not\Leftrightarrow\;} }
 \newcommand{\De}{\Delta}
 \newcommand{\bbbn}{\mathbb{N}}
 \newcommand{\bbbr}{\mathbb{R}}
 \newcommand{\bbbp}{\mathbb{P}}
 \newcommand{\cD}{\mathcal{D}}
 \newcommand{\cI}{\mathcal{I}}
 \newcommand{\Si}{\Sigma}

 \newcommand{\arccsc}{\mathop{\mathrm{arccsc}}}
 \newcommand{\arcsec}{\mathop{\mathrm{arcsec}}}
 \newcommand{\arccot}{\mathop{\mathrm{arccot}}}
 \newcommand{\erf}{\mathop{\mathrm{erf}}}
 \newcommand{\smsum}{\mathop{{\ts \sum}}}
 \newcommand{\atp}[2]{ \genfrac{}{}{0in}{}{#1}{#2} }

 \newcommand{\ave}{\mathrm{ave}}
 \newcommand{\llt}{\left \lt }
 \newcommand{\rgt}{\right \gt }


 \newcommand{\vd}{\mathbf{d}}
 \newcommand{\he}{\mathbf{e}}
 \newcommand{\vg}{\mathbf{g}}
 \newcommand{\vt}{\mathbf{t}}
 \newcommand{\vw}{\mathbf{w}}
 \def\eqover#1{\ {\buildrel #1 \over =}\ }
 \newcommand{\impliesover}[1]{ {\buildrel #1 \over\implies} }



 \newcommand{\vr}{\mathbf{r}}
 \newcommand{\vR}{\mathbf{R}}
 \newcommand{\vs}{\mathbf{s}}
 \newcommand{\vv}{\mathbf{v}}
 \newcommand{\va}{\mathbf{a}}
 \newcommand{\vb}{\mathbf{b}}
 \newcommand{\vc}{\mathbf{c}}
 \newcommand{\ve}{\mathbf{e}}
 \newcommand{\vC}{\mathbf{C}}
 \newcommand{\vp}{\mathbf{p}}
 \newcommand{\vq}{\mathbf{q}}
 \newcommand{\vn}{\mathbf{n}}
 \newcommand{\vu}{\mathbf{u}}
 
 \newcommand{\vV}{\mathbf{V}}
 \newcommand{\vx}{\mathbf{x}}
 \newcommand{\vX}{\mathbf{X}}
 \newcommand{\vy}{\mathbf{y}}
 \newcommand{\vz}{\mathbf{z}}
 \newcommand{\vF}{\mathbf{F}}
 \newcommand{\vG}{\mathbf{G}}
 \newcommand{\vH}{\mathbf{H}}
 \newcommand{\vT}{\mathbf{T}}
 \newcommand{\vN}{\mathbf{N}}
 \newcommand{\vL}{\mathbf{L}}
 \newcommand{\vA}{\mathbf{A}}
 \newcommand{\vB}{\mathbf{B}}
 \newcommand{\vD}{\mathbf{D}}
 \newcommand{\vE}{\mathbf{E}}
 \newcommand{\vJ}{\mathbf{J}}
 \newcommand{\vZero}{\mathbf{0}}
 \newcommand{\vPhi}{\mathbf{\Phi}}
 \newcommand{\vOmega}{\mathbf{\Omega}}
 \newcommand{\vTheta}{\mathbf{\Theta}}
 \newcommand{\cA}{\mathcal{A}}
 \newcommand{\cB}{\mathcal{B}}
 \newcommand{\cL}{\mathcal{L}}
 \newcommand{\cM}{\mathcal{M}}
 \newcommand{\cO}{\mathcal{O}}
 \newcommand{\cP}{\mathcal{P}}
 \newcommand{\cR}{\mathcal{R}}
 \newcommand{\cS}{\mathcal{S}}
 \newcommand{\cT}{\mathcal{T}}
 \newcommand{\cU}{\mathcal{U}}
 \newcommand{\cV}{\mathcal{V}}
 \newcommand{\cW}{\mathcal{W}}
 \newcommand{\cX}{\mathcal{X}}

 
 
 \newcommand{\hi}{\hat{\pmb{\imath}}}
 \newcommand{\hj}{\hat{\pmb{\jmath}}}
 \newcommand{\hk}{\hat{\mathbf{k}}}
 \newcommand{\hn}{\hat{\mathbf{n}}}
 \newcommand{\hr}{\hat{\mathbf{r}}}
 \newcommand{\hvt}{\hat{\mathbf{t}}}
 \newcommand{\hN}{\hat{\mathbf{N}}}
 \newcommand{\vth}{{\pmb{\theta}}}
 \newcommand{\vTh}{{\pmb{\Theta}}}
 
 \newcommand{\vnabla}{   { \mathchoice{\pmb{\nabla}}
                             {\pmb{\nabla}}
                             {\pmb{\scriptstyle\nabla}}
                             {\pmb{\scriptscriptstyle\nabla}} }   }
 \newcommand{\ha}[1]{\mathbf{\hat e}^{(#1)}}

 \newcommand{\bbbc}{\mathbb{C}}

 \newcommand{\Om}{\Omega}
 \newcommand{\om}{\omega}
 \newcommand{\vOm}{\pmb{\Omega}}
 \newcommand{\svOm}{\pmb{\scriptsize\Omega}}
 \newcommand{\al}{\alpha}
 \newcommand{\be}{\beta}
 \newcommand{\de}{\delta}
 \newcommand{\ga}{\gamma}
 \newcommand{\ka}{\kappa}
 \newcommand{\la}{\lambda}

 \newcommand{\cC}{\mathcal{C}}
 \newcommand{\bbbone}{\mathbb{1}}

 \DeclareMathOperator{\sgn}{sgn}
 \def\tr{\mathop{\rm tr}}
 \newcommand{\Atop}[2]{\genfrac{}{}{0pt}{}{#1}{#2}}


 \newcommand{\dblInt}{\iint}
 \newcommand{\tripInt}{\iiint}

 \newcommand{\Set}[2]{\big\{ \ #1\ \big|\ #2\ \big\}}
 \newcommand{\rhof}{{\rho_{\!{\scriptscriptstyle f}}}}
 \newcommand{\rhob}{{\rho_{{\scriptscriptstyle b}}}}


 \newcommand{\YEaxis}[2]{\draw[help lines] (-#1,0)--(#1,0) node[right]{$x$};\draw[help lines] (0,-#2)--(0,#2) node[above]{$y$};}

\newcommand{\YEaaxis}[4]{\draw[help lines] (-#1,0)--(#2,0) node[right]{$x$};\draw[help lines] (0,-#3)--(0,#4) node[above]{$y$};}

\newcommand{\YEtaxis}[4]{\draw[help lines] (-#1,0)--(#2,0) node[right]{$t$};\draw[help lines] (0,-#3)--(0,#4) node[above]{$y$};}
\newcommand{\YEtaaxis}[4]{\draw[help lines, &lt;-&gt;] (-#1,0)--(#2,0) node[right]{$t$}; \draw[help lines, &lt;-&gt;] (0,-#3)--(0,#4) node[above]{$y$};}

\newcommand{\YExcoord}[2]{\draw (#1,.2)--(#1,-.2) node[below]{$#2$};}
\newcommand{\YEycoord}[2]{\draw (.2,#1)--(-.2,#1) node[left]{$#2$};}
\newcommand{\YEnxcoord}[2]{\draw (#1,-.2)--(#1,.2) node[above]{$#2$};}
\newcommand{\YEnycoord}[2]{\draw (-.2,#1)--(.2,#1) node[right]{$#2$};}

\newcommand{\YEstickfig}[3]{
\draw (#1,#2) arc(-90:270:2mm);
\draw (#1,#2)--(#1,#2-.5) (#1-.25,#2-.75)--(#1,#2-.5)--(#1+.25,#2-.75) (#1-.2,#2-.2)--(#1+.2,#2-.2);}
\renewcommand{\neg}{ {\sim} }
 \newcommand{\limp}{ {\;\Rightarrow\;} }
 \newcommand{\nimp}{ {\;\not\Rightarrow\;} }
 \newcommand{\liff}{ {\;\Leftrightarrow\;} }
 \newcommand{\niff}{ {\;\not\Leftrightarrow\;} }

 \newcommand{\st}{ {\mbox{ s.t. }} }
 \newcommand{\es}{ {\varnothing}}
 \newcommand{\ds}{ \displaystyle }
 \newcommand{\pow}[1]{ \mathcal{P}\left(#1\right) }
 \newcommand{\set}[1]{ \left\{#1\right\} }

 \newcommand{\bdiff}[2]{ \frac{\mathrm{d}}{\mathrm{d}#2} \left( #1 \right)}
 \newcommand{\ddiff}[3]{ \frac{\mathrm{d}^#1#2}{\mathrm{d}{#3}^#1}}

 \newcommand{\pdiff}[2]{ \frac{\partial #1}{\partial #2}}

 \newcommand{\bbbn}{\mathbb{N}}
 \newcommand{\bbbr}{\mathbb{R}}
 \newcommand{\bbbp}{\mathbb{P}}
 \newcommand{\De}{\Delta}
 \newcommand{\cD}{\mathcal{D}}
 \newcommand{\cP}{\mathcal{P}}
 \newcommand{\cI}{\mathcal{I}}
 \newcommand{\veps}{\varepsilon}
 \newcommand{\half}{\tfrac{1}{2}}
 \newcommand{\ts}{ \textstyle }
 \newcommand{\diff}[2]{ \frac{\mathrm{d} #1 }{\mathrm{d}#2}}
 \newcommand{\difftwo}[2]{ \frac{\mathrm{d^2} #1 }{\mathrm{d}{#2}^2}}
 \newcommand{\dee}[1]{\mathrm{d}#1}
 \newcommand{\soln}{ \medskip\noindent\emph{Solution.}\ \ \  }
 \newcommand{\arccsc}{\mathop{\mathrm{arccsc}}}
 \newcommand{\arcsec}{\mathop{\mathrm{arcsec}}}
 \newcommand{\arccot}{\mathop{\mathrm{arccot}}}
 \newcommand{\erf}{\mathop{\mathrm{erf}}}
 \newcommand{\smsum}{\mathop{{\ts \sum}}}
 \newcommand{\atp}[2]{ \genfrac{}{}{0in}{}{#1}{#2} }


 \newcommand{\Ha}{\hat{\mathbf{a}}}
 
 \newcommand{\he}{\hat{\mathbf{e}}}
 
 
 \newcommand{\hi}{\hat{\pmb{\imath}}}
 \newcommand{\hj}{\hat{\pmb{\jmath}}}
 \newcommand{\hk}{\hat{\mathbf{k}}}
 \newcommand{\hn}{\hat{\mathbf{n}}}
 \newcommand{\hr}{\hat{\mathbf{r}}}
 \newcommand{\hvt}{\hat{\mathbf{t}}}
 \newcommand{\hN}{\hat{\mathbf{N}}}
 \newcommand{\vth}{{\pmb{\theta}}}
 \newcommand{\vTh}{{\pmb{\Theta}}}

 \newcommand{\vnabla}{   { \mathchoice{\pmb{\nabla}}
                             {\pmb{\nabla}}
                             {\pmb{\scriptstyle\nabla}}
                             {\pmb{\scriptscriptstyle\nabla}} }   }
 \newcommand{\ha}[1]{\mathbf{\hat e}^{(#1)}}

 \newcommand{\Om}{\Omega}
 \newcommand{\om}{\omega}
 \newcommand{\vOm}{\pmb{\Omega}}
 \newcommand{\vom}{\pmb{\omega}}
 \newcommand{\svOm}{\pmb{\scriptsize\Omega}}
 \newcommand{\al}{\alpha}
 \newcommand{\be}{\beta}
 \newcommand{\ga}{\gamma}
 \newcommand{\ka}{\kappa}
 \newcommand{\la}{\lambda}

 \newcommand{\cC}{\mathcal{C}}
 \newcommand{\bbbone}{\mathbb{1}}

 \DeclareMathOperator{\sgn}{sgn}
 \def\tr{\mathop{\rm tr}}
 \newcommand{\Atop}[2]{\genfrac{}{}{0pt}{}{#1}{#2}}

 \newcommand{\dblInt}{\iint}
 \newcommand{\tripInt}{\iiint}

 \newcommand{\Set}[2]{\big\{ \ #1\ \big|\ #2\ \big\}}
 \newcommand{\rhof}{{\rho_{\!{\scriptscriptstyle f}}}}
 \newcommand{\rhob}{{\rho_{{\scriptscriptstyle b}}}}



 \newcommand{\hT}{\hat{\mathbf{T}}}
 \newcommand{\hB}{\hat{\mathbf{B}}}


 \newcommand{\YEaxis}[2]{\draw[help lines, &lt;-&gt;] (-#1,0)--(#1,0) node[right]{$x$};
 \draw[help lines, &lt;-&gt;] (0,-#2)--(0,#2) node[above]{$y$};}
 \newcommand{\YEaaxis}[4]{\draw[help lines, &lt;-&gt;] (-#1,0)--(#2,0)
 node[right]{$x$};
 \draw[help lines, &lt;-&gt;] (0,-#3)--(0,#4) node[above]{$y$};}
 \newcommand{\YEtaaxis}[4]{\draw[help lines, &lt;-&gt;] (-#1,0)--(#2,0)
 node[right]{$t$};
 \draw[help lines, &lt;-&gt;] (0,-#3)--(0,#4) node[above]{$y$};}
 \newcommand{\YEtaxis}[4]{\draw[help lines, &lt;-&gt;] (-#1,0)--(#2,0)
 node[right]{$t$};
 \draw[help lines, &lt;-&gt;] (0,-#3)--(0,#4) node[above]{$y$};}
 \newcommand{\YExcoord}[2]{
 	\draw (#1,.2)--(#1,-.2) node[below]{$#2$};}
 \newcommand{\YEycoord}[2]{
 	\draw (.2,#1)--(-.2,#1) node[left]{$#2$};}
 \newcommand{\YEnxcoord}[2]{
 	\draw (#1,-.2)--(#1,.2) node[above]{$#2$};}
 \newcommand{\YEnycoord}[2]{
 	\draw (-.2,#1)--(.2,#1) node[right]{$#2$};}
 \newcommand{\YEstickfig}[3]{
 	\draw (#1,#2) arc(-90:270:2mm);
 	\draw (#1,#2)--(#1,#2-.5) (#1-.25,#2-.75)--(#1,#2-.5)--(#1+.25,#2-.75) (#1-.2,#2-.2)--(#1+.2,#2-.2);}

 \newcommand{\trigtri}[4]{
 \begin{tikzpicture}
 \draw (-.5,0)--(2,0)--(2,1.5)--cycle;
 \draw (1.8,0) |- (2,.2);
 \draw[double] (0,0) arc(0:30:.5cm);
 \draw (0,.2) node[right]{$#1$};
 \draw (1,-.5) node{$#2$};
 \draw (2,.75) node[right]{$#3$};
 \draw (.6,1.1) node[rotate=30]{$#4$};
 \end{tikzpicture}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="CLP-Calculus.html"><span class="title"></span></a></h1>
<p class="byline"></p>
</div>
</div></div>
<nav xmlns:svg="http://www.w3.org/2000/svg" id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="sec_parfrac.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chap_integral.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="sec_improp_int.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="sec_parfrac.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chap_integral.html" title="Up">Up</a><a class="next-button button toolbar-item" href="sec_improp_int.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div xmlns:svg="http://www.w3.org/2000/svg" id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link part"><a href="part-differential.html" data-scroll="part-differential"><span class="codenumber">I</span> <span class="title">CLP-1 Differential Calculus</span></a></li>
<li class="link frontmatter">
<a href="part-differential.html#index" data-scroll="index"><span class="title">Front Matter</span></a><ul>
<li><a href="part-differential.html#colophon-1" data-scroll="colophon-1">Colophon</a></li>
<li><a href="part-differential.html#preface-1" data-scroll="preface-1">Preface</a></li>
<li><a href="part-differential.html#dedication-1" data-scroll="dedication-1">Dedication</a></li>
<li><a href="part-differential.html#acknowledgement-1" data-scroll="acknowledgement-1">Acknowledgements</a></li>
<li><a href="part-differential.html#preface-2" data-scroll="preface-2">Using the exercises in this book</a></li>
<li><a href="part-differential.html#preface-3" data-scroll="preface-3">Feedback about the text</a></li>
</ul>
</li>
<li class="link">
<a href="chap_basics.html" data-scroll="chap_basics"><span class="codenumber">1</span> <span class="title">The basics</span></a><ul>
<li><a href="section-1.html" data-scroll="section-1">Numbers</a></li>
<li><a href="sec_sets.html" data-scroll="sec_sets">Sets</a></li>
<li><a href="section-3.html" data-scroll="section-3">Other Important Sets</a></li>
<li><a href="section-4.html" data-scroll="section-4">Functions</a></li>
<li><a href="sec_parsing.html" data-scroll="sec_parsing">Parsing Formulas</a></li>
<li><a href="sec_inverse_functions.html" data-scroll="sec_inverse_functions">Inverse Functions</a></li>
</ul>
</li>
<li class="link">
<a href="chap_limits.html" data-scroll="chap_limits"><span class="codenumber">2</span> <span class="title">Limits</span></a><ul>
<li><a href="sec_first_lim.html" data-scroll="sec_first_lim">Drawing Tangents and a First Limit</a></li>
<li><a href="sec_velocity.html" data-scroll="sec_velocity">Another Limit and Computing Velocity</a></li>
<li><a href="sec_lim_func.html" data-scroll="sec_lim_func">The Limit of a Function</a></li>
<li><a href="section-10.html" data-scroll="section-10">Calculating Limits with Limit Laws</a></li>
<li><a href="section-11.html" data-scroll="section-11">Limits at Infinity</a></li>
<li><a href="section-12.html" data-scroll="section-12">Continuity</a></li>
<li><a href="sec_opt_formal_limit.html" data-scroll="sec_opt_formal_limit">(Optional) — Making the Informal a Little More Formal</a></li>
<li><a href="sec_lim_inf_formal.html" data-scroll="sec_lim_inf_formal">(Optional) — Making Infinite Limits a Little More Formal</a></li>
<li><a href="sec_proof_arith_lim.html" data-scroll="sec_proof_arith_lim">(Optional) — Proving the Arithmetic of Limits</a></li>
</ul>
</li>
<li class="link">
<a href="chap_deriv.html" data-scroll="chap_deriv"><span class="codenumber">3</span> <span class="title">Derivatives</span></a><ul>
<li><a href="section-16.html" data-scroll="section-16">Revisiting Tangent Lines</a></li>
<li><a href="sec_def_deriv.html" data-scroll="sec_def_deriv">Definition of the Derivative</a></li>
<li><a href="section-18.html" data-scroll="section-18">Interpretations of the Derivative</a></li>
<li><a href="section-19.html" data-scroll="section-19">Arithmetic of Derivatives - a Differentiation Toolbox</a></li>
<li><a href="sec_proof_arith_deriv.html" data-scroll="sec_proof_arith_deriv">Proofs of the Arithmetic of Derivatives</a></li>
<li><a href="section-21.html" data-scroll="section-21">Using the Arithmetic of Derivatives –  Examples</a></li>
<li><a href="sec_exp_func.html" data-scroll="sec_exp_func">Derivatives of Exponential Functions</a></li>
<li><a href="sec_diff_trig.html" data-scroll="sec_diff_trig">Derivatives of Trigonometric Functions</a></li>
<li><a href="sec_chain_rule.html" data-scroll="sec_chain_rule">One More Tool  – the Chain Rule</a></li>
<li><a href="sec_diff_logs.html" data-scroll="sec_diff_logs">The Natural Logarithm</a></li>
<li><a href="section-26.html" data-scroll="section-26">Implicit Differentiation</a></li>
<li><a href="sec_invTrig.html" data-scroll="sec_invTrig">Inverse Trigonometric Functions</a></li>
<li><a href="sec_mvt.html" data-scroll="sec_mvt">The Mean Value Theorem</a></li>
<li><a href="sec_higher_diff.html" data-scroll="sec_higher_diff">Higher Order Derivatives</a></li>
<li><a href="sec_cont_deriv.html" data-scroll="sec_cont_deriv">(Optional) --- Is \(\lim_{x\to c}f'(x)\) Equal to \(f'(c)\text{?}\)</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-4.html" data-scroll="chapter-4"><span class="codenumber">4</span> <span class="title">Applications of derivatives</span></a><ul>
<li><a href="sec_vel_acc.html" data-scroll="sec_vel_acc">Velocity and Acceleration</a></li>
<li><a href="sec_rrates.html" data-scroll="sec_rrates">Related Rates</a></li>
<li><a href="sec_ExpGthDecay.html" data-scroll="sec_ExpGthDecay">Exponential Growth and Decay</a></li>
<li><a href="sec_DIFFTaylor.html" data-scroll="sec_DIFFTaylor">Taylor Polynomials</a></li>
<li><a href="sec_optimise.html" data-scroll="sec_optimise">Optimisation</a></li>
<li><a href="sec_curve_sketch.html" data-scroll="sec_curve_sketch">Sketching Graphs</a></li>
<li><a href="section-37.html" data-scroll="section-37">L'Hôpital's Rule and Indeterminate Forms</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-5.html" data-scroll="chapter-5"><span class="codenumber">5</span> <span class="title">Towards Integral Calculus</span></a><ul><li><a href="sec_antidiff.html" data-scroll="sec_antidiff">Introduction to Antiderivatives</a></li></ul>
</li>
<li class="link part"><a href="part-integral.html" data-scroll="part-integral"><span class="codenumber">II</span> <span class="title">CLP-2 Integral Calculus</span></a></li>
<li class="link">
<a href="chap_integral.html" data-scroll="chap_integral"><span class="codenumber">6</span> <span class="title">Integration</span></a><ul>
<li><a href="sec_intdef.html" data-scroll="sec_intdef">Definition of the Integral</a></li>
<li><a href="sec_def_int.html" data-scroll="sec_def_int">Basic properties of the definite integral</a></li>
<li><a href="sec_fundamental.html" data-scroll="sec_fundamental">The Fundamental Theorem of Calculus</a></li>
<li><a href="sec_subs.html" data-scroll="sec_subs">Substitution</a></li>
<li><a href="sec_area.html" data-scroll="sec_area">Area between curves</a></li>
<li><a href="sec_int_volumes.html" data-scroll="sec_int_volumes">Volumes</a></li>
<li><a href="sec_intbyparts.html" data-scroll="sec_intbyparts">Integration by parts</a></li>
<li><a href="sec_trigint.html" data-scroll="sec_trigint">Trigonometric Integrals</a></li>
<li><a href="sec_trigsub.html" data-scroll="sec_trigsub">Trigonometric Substitution</a></li>
<li><a href="sec_parfrac.html" data-scroll="sec_parfrac">Partial Fractions</a></li>
<li><a href="sec_numeric_int.html" data-scroll="sec_numeric_int" class="active">Numerical Integration</a></li>
<li><a href="sec_improp_int.html" data-scroll="sec_improp_int">Improper Integrals</a></li>
<li><a href="section-51.html" data-scroll="section-51">More Integration Examples</a></li>
</ul>
</li>
<li class="link">
<a href="chap_int_app.html" data-scroll="chap_int_app"><span class="codenumber">7</span> <span class="title">Applications of Integration</span></a><ul>
<li><a href="sec_work.html" data-scroll="sec_work">Work</a></li>
<li><a href="sec_avg.html" data-scroll="sec_avg">Averages</a></li>
<li><a href="sec_com.html" data-scroll="sec_com">Centre of Mass and Torque</a></li>
<li><a href="sec_sep_de.html" data-scroll="sec_sep_de">Separable Differential Equations</a></li>
</ul>
</li>
<li class="link">
<a href="chap_seq_ser.html" data-scroll="chap_seq_ser"><span class="codenumber">8</span> <span class="title">Sequence and series</span></a><ul>
<li><a href="section-56.html" data-scroll="section-56">Sequences</a></li>
<li><a href="section-57.html" data-scroll="section-57">Series</a></li>
<li><a href="section-58.html" data-scroll="section-58">Convergence Tests</a></li>
<li><a href="section-59.html" data-scroll="section-59">Absolute and Conditional Convergence</a></li>
<li><a href="section-60.html" data-scroll="section-60">Power Series</a></li>
<li><a href="section-61.html" data-scroll="section-61">Taylor Series</a></li>
<li><a href="sec_RatIrr.html" data-scroll="sec_RatIrr">Optional — Rational and irrational numbers</a></li>
</ul>
</li>
<li class="link part"><a href="part-multi.html" data-scroll="part-multi"><span class="codenumber">III</span> <span class="title">CLP-3 Multivariable Calculus</span></a></li>
<li class="link">
<a href="chap_geometry.html" data-scroll="chap_geometry"><span class="codenumber">9</span> <span class="title">Vectors and Geometry in Two and Three Dimensions</span></a><ul>
<li><a href="sec-points.html" data-scroll="sec-points">Points</a></li>
<li><a href="sec_vectors.html" data-scroll="sec_vectors">Vectors</a></li>
<li><a href="sec_lines_2d.html" data-scroll="sec_lines_2d">Equations of Lines in 2d</a></li>
<li><a href="sec_planes_3d.html" data-scroll="sec_planes_3d">Equations of Planes in 3d</a></li>
<li><a href="sec_lines_3d.html" data-scroll="sec_lines_3d">Equations of Lines in 3d</a></li>
<li><a href="sec_curves.html" data-scroll="sec_curves">Curves and their Tangent Vectors</a></li>
<li><a href="sec_sketching.html" data-scroll="sec_sketching">Sketching Surfaces in 3d</a></li>
<li><a href="sec_cylinders.html" data-scroll="sec_cylinders">Cylinders</a></li>
<li><a href="sec_quadrics.html" data-scroll="sec_quadrics">Quadric Surfaces</a></li>
</ul>
</li>
<li class="link">
<a href="chap_partials.html" data-scroll="chap_partials"><span class="codenumber">10</span> <span class="title">Partial Derivatives</span></a><ul>
<li><a href="sec_limits.html" data-scroll="sec_limits">Limits</a></li>
<li><a href="sec_partials.html" data-scroll="sec_partials">Partial Derivatives</a></li>
<li><a href="sec_higher_order.html" data-scroll="sec_higher_order">Higher Order Derivatives</a></li>
<li><a href="sec_chain_rule.html" data-scroll="sec_chain_rule">The Chain Rule</a></li>
<li><a href="sec_tangent_planes.html" data-scroll="sec_tangent_planes">Tangent Planes and Normal Lines</a></li>
<li><a href="sec_lin_approx.html" data-scroll="sec_lin_approx">Linear Approximations and Error</a></li>
<li><a href="sec_directional_derivatives.html" data-scroll="sec_directional_derivatives">Directional Derivatives and the Gradient</a></li>
<li><a href="sec_wave.html" data-scroll="sec_wave">Optional — Solving the Wave Equation</a></li>
<li><a href="sec_max.html" data-scroll="sec_max">Maximum and Minimum Values</a></li>
<li><a href="sec_Lagrange.html" data-scroll="sec_Lagrange">Lagrange Multipliers</a></li>
</ul>
</li>
<li class="link">
<a href="chap_integrals.html" data-scroll="chap_integrals"><span class="codenumber">11</span> <span class="title">Multiple Integrals</span></a><ul>
<li><a href="sec_2d_integrals.html" data-scroll="sec_2d_integrals">Double Integrals</a></li>
<li><a href="sec_polars.html" data-scroll="sec_polars">Double Integrals in Polar Coordinates</a></li>
<li><a href="sec_int_2d_applications.html" data-scroll="sec_int_2d_applications">Applications of Double Integrals</a></li>
<li><a href="sec_surface_area.html" data-scroll="sec_surface_area">Surface Area</a></li>
<li><a href="sec_3d_integrals.html" data-scroll="sec_3d_integrals">Triple Integrals</a></li>
<li><a href="sec_cylindrical.html" data-scroll="sec_cylindrical">Triple Integrals in Cylindrical Coordinates</a></li>
<li><a href="sec_spherical.html" data-scroll="sec_spherical">Triple Integrals in Spherical Coordinates</a></li>
<li><a href="sec_Jacobian.html" data-scroll="sec_Jacobian">Optional— Integrals in General Coordinates</a></li>
</ul>
</li>
<li class="link part"><a href="part-vector.html" data-scroll="part-vector"><span class="codenumber">IV</span> <span class="title">CLP-4 Vector Calculus</span></a></li>
<li class="link">
<a href="chap_curves.html" data-scroll="chap_curves"><span class="codenumber">12</span> <span class="title">Curves</span></a><ul>
<li><a href="sec_curve_derivs.html" data-scroll="sec_curve_derivs">Derivatives, Velocity, Etc.</a></li>
<li><a href="sec_reparam.html" data-scroll="sec_reparam">Reparametrization</a></li>
<li><a href="sec_curvature.html" data-scroll="sec_curvature">Curvature</a></li>
<li><a href="sec_Curve3d.html" data-scroll="sec_Curve3d">Curves in Three Dimensions</a></li>
<li><a href="sec_CurveCompendium.html" data-scroll="sec_CurveCompendium">A Compendium of Curve Formula</a></li>
<li><a href="sec_lineIntegral.html" data-scroll="sec_lineIntegral">Integrating Along a Curve</a></li>
<li><a href="sec_Sliding.html" data-scroll="sec_Sliding">Sliding on a Curve</a></li>
<li><a href="sec_polar.html" data-scroll="sec_polar">Optional — Polar Coordinates</a></li>
<li><a href="sec_central_forces.html" data-scroll="sec_central_forces">Optional — Central Forces</a></li>
<li><a href="sec_planet.html" data-scroll="sec_planet">Optional — Planetary Motion</a></li>
<li><a href="sec_astroid.html" data-scroll="sec_astroid">Optional — The Astroid</a></li>
<li><a href="sec_paramCircles.html" data-scroll="sec_paramCircles">Optional — Parametrizing Circles</a></li>
</ul>
</li>
<li class="link">
<a href="chap_vector_fields.html" data-scroll="chap_vector_fields"><span class="codenumber">13</span> <span class="title">Vector Fields</span></a><ul>
<li><a href="sec_vfDefs.html" data-scroll="sec_vfDefs">Definitions and First Examples</a></li>
<li><a href="sec_fieldLines.html" data-scroll="sec_fieldLines">Optional — Field Lines</a></li>
<li><a href="sec_conservativeFields.html" data-scroll="sec_conservativeFields">Conservative Vector Fields</a></li>
<li><a href="sec_workIntegrals.html" data-scroll="sec_workIntegrals">Line Integrals</a></li>
<li><a href="sec_Pendulum.html" data-scroll="sec_Pendulum">Optional — The Pendulum</a></li>
</ul>
</li>
<li class="link">
<a href="chap_surface_integrals.html" data-scroll="chap_surface_integrals"><span class="codenumber">14</span> <span class="title">Surface Integrals</span></a><ul>
<li><a href="sec_paramSurfaces.html" data-scroll="sec_paramSurfaces">Parametrized Surfaces</a></li>
<li><a href="sec_tangentPlanes.html" data-scroll="sec_tangentPlanes">Tangent Planes</a></li>
<li><a href="sec_surfaceIntegrals.html" data-scroll="sec_surfaceIntegrals">Surface Integrals</a></li>
<li><a href="sec_fluxIntegrals.html" data-scroll="sec_fluxIntegrals">Interpretation of Flux Integrals</a></li>
<li><a href="sec_orientation.html" data-scroll="sec_orientation">Orientation of Surfaces</a></li>
</ul>
</li>
<li class="link">
<a href="chap_integral_theorems.html" data-scroll="chap_integral_theorems"><span class="codenumber">15</span> <span class="title">Integral Theorems</span></a><ul>
<li><a href="sec_graadDivCurl.html" data-scroll="sec_graadDivCurl">Gradient, Divergence and Curl</a></li>
<li><a href="sec_divergenceThm.html" data-scroll="sec_divergenceThm">The Divergence Theorem</a></li>
<li><a href="sec_GreenThm.html" data-scroll="sec_GreenThm">Green's Theorem</a></li>
<li><a href="sec_StokesThm.html" data-scroll="sec_StokesThm">Stokes' Theorem</a></li>
<li><a href="sec_cohomology.html" data-scroll="sec_cohomology">Optional — Which Vector Fields Obey  \(\vnabla\times\vF=0\)</a></li>
<li><a href="section-117.html" data-scroll="section-117">Really Optional — More Interpretation of Div and Curl</a></li>
<li><a href="sec_unified.html" data-scroll="sec_unified">Optional — A Generalized Stokes' Theorem</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-16.html" data-scroll="chapter-16"><span class="codenumber">16</span> <span class="title">True/False and Other Short Questions</span></a><ul>
<li><a href="section-119.html" data-scroll="section-119">True/False and Other Short Questions</a></li>
<li><a href="exercises-110.html" data-scroll="exercises-110">Exercises</a></li>
</ul>
</li>
<li class="link backmatter"><a href="backmatter-1.html" data-scroll="backmatter-1"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="app_hint.html" data-scroll="app_hint"><span class="codenumber">A</span> <span class="title">Hints for Exercises</span></a></li>
<li class="link"><a href="app_answ.html" data-scroll="app_answ"><span class="codenumber">B</span> <span class="title">Answers to Exercises</span></a></li>
<li class="link"><a href="app_soln.html" data-scroll="app_soln"><span class="codenumber">C</span> <span class="title">Solutions to Exercises</span></a></li>
</ul></nav><div class="extras"><nav><a class="feedback-link" href="mailto:clp@ugrad.math.ubc.ca?subject=clp3-pretext" target="_blank">Feedback</a><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section xmlns:svg="http://www.w3.org/2000/svg" class="section" id="sec_numeric_int"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">6.11</span> <span class="title">Numerical Integration</span>
</h2>
<section class="introduction" id="introduction-229"><p id="p-7608">By now the reader will have come to appreciate that integration is generally quite a bit  more difficult than differentiation. There are a great many simple-looking integrals,  such as \(\int e^{-x^2}\dee{x}\text{,}\) that are either very difficult or even impossible to  express in terms of standard functions <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-250" id="fn-250"><sup> 1 </sup></a>. Such integrals are not merely mathematical  curiosities, but arise very naturally in many contexts. For example, the error function</p>
<div class="displaymath">
\begin{gather*}
\mathrm{erf}(x) = \frac{2}{\sqrt{\pi}}\int_0^x e^{-t^2}\dee{t}
\end{gather*}
</div>
<p data-braille="continuation">is extremely important in many areas of mathematics, and also in many practical  applications of statistics.</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-250"><div class="fn">We apologise for being a little sloppy  here — but we just want to say that it can be very hard or even impossible to write some  integrals as some finite sized expression involving polynomials, exponentials, logarithms  and trigonometric functions. We don't want to get into a discussion of computability,  though that is a very interesting topic.</div></div>
<p id="p-7609">In such applications we need to be able to evaluate this integral (and many others) at a  given numerical value of \(x\text{.}\) In this section we turn to the problem of how to find  (approximate) numerical values for integrals, without having to evaluate them  algebraically. To develop these methods we return to Riemann sums and our  geometric interpretation of the definite integral as the signed area.</p>
<p id="p-7610">We start by describing (and applying) three simple algorithms for generating,  numerically, approximate values for the definite integral \(\int_a^b f(x)\,\dee{x}\text{.}\) In  each algorithm, we begin in much the same way as we approached Riemann sums.</p>
<ul class="disc">
<li id="li-2842">We first select an integer \(n \gt 0\text{,}\) called the “number of steps”.</li>
<li id="li-2843">We then divide the interval of integration, \(a\le x\le b\text{,}\) into \(n\) equal subintervals, each of length \(\De x=\frac{b-a}{n}\text{.}\) The first subinterval runs  from \(x_0=a\) to \(x_1=a+\De x\text{.}\) The second runs from \(x_1\) to \(x_2=a+2\De x\text{,}\) and so on.  The last runs from \(x_{n-1}=b-\De x\) to \(x_n=b\text{.}\)</li>
</ul>
<div class="sidebyside"><div class="sbsrow" style="margin-left:25%;margin-right:25%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="text/figs/decomposition.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7611">This splits the original integral into \(n\) pieces:</p>
<div class="displaymath">
\begin{equation*}
\int_a^b f(x)\,\dee{x}
=\int_{x_0}^{x_1} f(x)\,\dee{x}
+\int_{x_1}^{x_2} f(x)\,\dee{x}
+\cdots
+\int_{x_{n-1}}^{x_n} f(x)\,\dee{x}
\end{equation*}
</div>
<p data-braille="continuation">Each subintegral \(\int_{x_{j-1}}^{x_j} f(x)\,\dee{x}\) is approximated by the area of a simple geometric figure. The three algorithms we consider approximate the area  by rectangles, trapezoids and parabolas (respectively).</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:10%;margin-right:10%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="text/figs/three_shapes.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7612">We will explain these rules in detail below, but we give a brief overview here:</p>
<ol class="decimal">
<li id="li-2844">The midpoint rule approximates each subintegral by the area of a rectangle of  height given by the value of the function at the midpoint of the subinterval<div class="displaymath">
\begin{align*}
\int_{x_{j-1}}^{x_{j}} f(x) \dee{x} &amp; \approx f\left( \frac{x_{j-1}+x_{j}}{2} \right)  \De x
\end{align*}
</div>This is illustrated in the leftmost figure above.</li>
<li id="li-2845">The trapezoidal rule approximates each subintegral by the area of a trapezoid with  vertices at \((x_{j-1},0), (x_{j-1},f(x_{j-1})), (x_{j},f(x_{j})), (x_{j},0)\text{:}\)<div class="displaymath">
\begin{align*}
\int_{x_{j-1}}^{x_{j}} f(x) \dee{x}
&amp; \approx \frac{1}{2} \left[f(x_{j-1})+f(x_j) \right] \De x
\end{align*}
</div>The trapezoid is illustrated in the middle figure above. We shall derive the formula  for the area shortly.</li>
<li id="li-2846">Simpson's rule approximates two adjacent subintegrals by the area under  a parabola that passes through the points \((x_{j-1},f(x_{j-1}))\text{,}\) \((x_{j},f(x_{j}))\) and \((x_{j+1},f(x_{j+1}))\text{:}\)<div class="displaymath">
\begin{align*}
\int_{x_{j-1}}^{x_{j+1}} f(x) \dee{x}
&amp; \approx \frac{1}{3} \left[f(x_{j-1})+4f(x_j)+f(x_{j+1}) \right] \De x
\end{align*}
</div>The parabola is illustrated in the right hand figure above. We shall derive the  formula for the area shortly.</li>
</ol>
<article class="definition definition-like" id="definition-52"><h6 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">6.11.1</span><span class="period">.</span><span class="space"> </span><span class="title">Midpoints.</span>
</h6>
<p id="p-7613">In what follows we need to refer to the midpoint between \(x_{j-1}\) and \(x_j\) very  frequently. To save on writing (and typing) we introduce the notation</p>
<div class="displaymath">
\begin{align*}
\bar x_j &amp;= \frac{1}{2} \left(x_{j-1}+x_j \right).
\end{align*}
</div></article></section><section class="subsection" id="sec_midpointRule"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.11.1</span> <span class="title">The midpoint rule</span>
</h3>
<p id="p-7614">The integral \(\int_{x_{j-1}}^{x_j} f(x)\,\dee{x}\) represents the area between the curve \(y=f(x)\) and the \(x\)-axis with \(x\) running from \(x_{j-1}\)  to \(x_j\text{.}\) The width of this region is \(x_j-x_{j-1}=\De x\text{.}\) The height varies  over the different values that \(f(x)\) takes as \(x\) runs from \(x_{j-1}\)  to \(x_j\text{.}\)</p>
<p id="p-7615">The midpoint rule approximates this area by the area of a rectangle  of width \(x_j-x_{j-1}=\De x\) and height \(f(\bar x_j)\) which  is the exact height at the midpoint of the range covered by \(x\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:10%;margin-right:10%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="text/figs/midPt.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7616">The area of the approximating rectangle is \(f(\bar x_j)\De x\text{,}\) and the midpoint rule  approximates each subintegral by</p>
<div class="displaymath">
\begin{equation*}
\int_{x_{j-1}}^{x_j} f(x)\,\dee{x}\approx f(\bar x_j)\De x\text{.}
\end{equation*}
</div>
<p id="p-7617">Applying this approximation to each subinterval and summing gives us the following  approximation of the full integral:</p>
<div class="displaymath">
\begin{align*}
\int_a^b f(x)\,\dee{x}&amp;=
\int_{x_0}^{x_1}\!\! f(x)\,\dee{x} +
\int_{x_1}^{x_2}\!\! f(x)\,\dee{x} +\cdots +
\int_{x_{n-1}}^{x_n} f(x)\,\dee{x}\\
&amp;\approx
f(\bar x_1)\De x +
f(\bar x_2)\De x
+ \cdots +
f(\bar x_n)\De x
\end{align*}
</div>
<p data-braille="continuation">So notice that the approximation is the sum of the function evaluated at the midpoint of  each interval and then multiplied by \(\De x\text{.}\) Our other approximations will have similar  forms.</p>
<p id="p-7618">In summary:</p>
<article class="fact theorem-like" id="eq_MPrule"><h6 class="heading">
<span class="type">Equation</span><span class="space"> </span><span class="codenumber">6.11.2</span><span class="period">.</span><span class="space"> </span><span class="title">The midpoint rule.</span>
</h6>
<p id="p-7619">The midpoint rule approximation is</p>
<div class="displaymath">
\begin{gather*}
\int_a^b f(x)\,\dee{x}\approx\Big[f(\bar x_1)+f(\bar x_2)+\cdots +f(\bar x_n)\Big]\De x
\end{gather*}
</div>
<p data-braille="continuation">where \(\De x = \tfrac{b-a}{n}\) and</p>
<div class="displaymath">
\begin{align*}
x_0&amp;=a&amp;
x_1&amp;=a+\De x&amp;
x_2&amp;=a+2\De x&amp;
&amp;\cdots&amp;
x_{n-1}&amp;=b-\De x&amp;
x_n&amp;=b\\
&amp; &amp;
\bar x_1&amp;=\tfrac{x_0+x_1}{2}&amp;
\bar x_2&amp;=\tfrac{x_1+x_2}{2}&amp;
&amp;\cdots&amp;
\bar x_{n-1}&amp;=\tfrac{x_{n-2}+x_{n-1}}{2}&amp;
\bar x_n&amp;=\tfrac{x_{n-1}+x_n}{2}
\end{align*}
</div></article><article class="example example-like" id="eg_MidpointB"><a data-knowl="" class="id-ref example-knowl original" data-refid="hk-eg_MidpointB"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.11.3</span><span class="period">.</span><span class="space"> </span><span class="title">\(\int_0^1 \frac{4}{1+x^2}\,\dee{x}\).</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-eg_MidpointB"><article class="example example-like"><p id="p-7620">We approximate the above integral using the midpoint rule with \(n=8\) step.</p>
<p id="p-7621"><em class="alert">Solution:</em></p>
<ul class="disc">
<li id="li-2847">First we set up all the \(x\)-values that we will need. Note that \(a=0\text{,}\) \(b=1\text{,}\) \(\De x=\tfrac{1}{8}\) and<div class="displaymath">
\begin{align*}
x_0&amp;=0 &amp; x_1&amp;=\tfrac{1}{8} &amp; x_2&amp;=\tfrac{2}{8}
&amp;&amp; \cdots &amp;
x_7&amp;=\tfrac{7}{8}&amp;
x_8&amp;=\tfrac{8}{8}=1
\end{align*}
</div>Consequently<div class="displaymath">
\begin{align*}
\bar x_1&amp;= \tfrac{1}{16} &amp;
\bar x_2&amp;= \tfrac{3}{16} &amp;
\bar x_3&amp;= \tfrac{5}{16} &amp;
\cdots&amp;&amp;
\bar x_8 &amp;= \tfrac{15}{16}
\end{align*}
</div>
</li>
<li id="li-2848">We now apply Equation <a class="xref" data-knowl="./knowl/eq_MPrule.html" title="Equation 6.11.2: The midpoint rule">6.11.2</a> to the integrand \(f(x)=\frac{4}{1+x^2}\text{:}\)<div class="displaymath">
\begin{align*}
&amp;\int_0^1 \frac{4}{1+x^2}\,\dee{x} \approx
\bigg[\overbrace{\frac{4}{1+\bar x_1^2}}^{f(\bar x_1)}
+\overbrace{\frac{4}{1+\bar x_2^2}}^{f(\bar x_2)}
+\!\cdots\!
+\overbrace{\frac{4}{1+\bar x_7^2}}^{f(\bar x_{n-1})}
+\overbrace{\frac{4}{1+\bar x_8^2}}^{f(\bar x_n)}
\bigg]\De x\\
&amp;=\bigg[\frac{4}{1+\tfrac{1}{16^2}}+
\frac{4}{1+\tfrac{3^2}{16^2}}+
\frac{4}{1+\tfrac{5^2}{16^2}}+
\frac{4}{1+\tfrac{7^2}{16^2}}
+\frac{4}{1+\tfrac{9^2}{16^2}}\\
&amp;\hskip2in
+\frac{4}{1+\tfrac{11^2}{16^2}}+
\frac{4}{1+\tfrac{13^2}{16^2}}+
\frac{4}{1+\tfrac{15^2}{16^2}}\bigg]\frac{1}{8}\\
&amp;=\big[      3.98444 +
3.86415 +
3.64413 +
3.35738 +
3.03858 +\\
&amp;\hskip2in
2.71618 +
2.40941 +
2.12890 \big]\frac{1}{8}\\
&amp;=  3.1429
\end{align*}
</div>where we have rounded to four decimal places.</li>
<li id="li-2849">In this case we can compute the integral exactly (which is one of the reasons it  was chosen as a first example):<div class="displaymath">
\begin{gather*}
\int_0^1\frac{4}{1+x^2}\dee{x} =4\arctan x\Big|_0^1 = \pi
\end{gather*}
</div>
</li>
<li id="li-2850">So the error in the approximation generated by eight steps of the midpoint rule is<div class="displaymath">
\begin{align*}
|3.1429-\pi| &amp;=0.0013
\end{align*}
</div>
</li>
<li id="li-2851">The relative error is then<div class="displaymath">
\begin{align*}
\frac{|\text{approximate}-\text{exact}|}{\text{exact}}
&amp;= \frac{|3.1429-\pi|}{\pi}=0.0004
\end{align*}
</div>That is the error is \(0.0004\) times the actual value of the integral.</li>
<li id="li-2852">We can write this as a percentage error by multiplying it by 100<div class="displaymath">
\begin{align*}
\text{percentage error} &amp;= 100 \times
\frac{|\text{approximate}-\text{exact}|}{\text{exact}}
= 0.04 \%
\end{align*}
</div>That is, the error is about \(0.04\%\) of the exact value.</li>
</ul></article></div>
<p id="p-7622">The midpoint rule gives us quite good estimates of the integral without too much work  — though it is perhaps a little tedious to do by hand <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-251" id="fn-251"><sup> 2 </sup></a>. Of course, it would be very helpful  to quantify what we mean by “good” in this context and that requires us to discuss  errors.</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-251"><div class="fn">Thankfully it is very easy to write a program to apply the midpoint rule.</div></div>
<article class="definition definition-like" id="def_errorType"><h6 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">6.11.4</span><span class="period">.</span>
</h6>
<p id="p-7623">Suppose that \(\alpha\) is an approximation to \(A\text{.}\) This approximation has</p>
<ul class="disc">
<li id="li-2853">absolute error \(|A-\alpha|\) and</li>
<li id="li-2854">relative error \(\frac{|A-\alpha|}{A}\) and</li>
<li id="li-2855">percentage error \(100\frac{|A-\alpha|}{A}\)</li>
</ul></article><p id="p-7624">We will discuss errors further in Section <a href="sec_numeric_int.html#ssec_num_int_err" class="internal" title="Subsection 6.11.4: Three Simple Numerical Integrators — Error Behaviour">6.11.4</a> below.</p>
<article class="example example-like" id="eg_Midpoint"><a data-knowl="" class="id-ref example-knowl original" data-refid="hk-eg_Midpoint"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.11.5</span><span class="period">.</span><span class="space"> </span><span class="title">\(\int_0^\pi\sin x\,\dee{x}\).</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-eg_Midpoint"><article class="example example-like"><p id="p-7625">As a second example, we apply the midpoint rule with \(n=8\) steps to the above integral.</p>
<ul id="p-7626" class="disc">
<li id="li-2856">We again start by setting up all the \(x\)-values that we will need. So \(a=0\text{,}\)  \(b=\pi\text{,}\) \(\De x=\tfrac{\pi}{8}\) and<div class="displaymath">
\begin{align*}
x_0&amp;=0&amp; x_1&amp;=\tfrac{\pi}{8}&amp;
x_2&amp;=\tfrac{2\pi}{8}&amp; \cdots&amp;&amp;
x_7&amp;=\tfrac{7\pi}{8}&amp;
x_8&amp;=\tfrac{8\pi}{8}=\pi
\end{align*}
</div>Consequently,<div class="displaymath">
\begin{align*}
\bar x_1&amp;=\tfrac{\pi}{16}&amp;
\bar x_2&amp;=\tfrac{3\pi}{16} &amp; \cdots&amp;&amp;
\bar x_7&amp;=\tfrac{13\pi}{16} &amp;
\bar x_8&amp;=\tfrac{15\pi}{16}
\end{align*}
</div>
</li>
<li id="li-2857">Now apply Equation <a class="xref" data-knowl="./knowl/eq_MPrule.html" title="Equation 6.11.2: The midpoint rule">6.11.2</a> to the integrand \(f(x)=\sin x\text{:}\)<div class="displaymath">
\begin{align*}
&amp;\int_0^\pi\sin x\,\dee{x}
\approx\Big[\sin(\bar x_1)+\sin(\bar x_2)+\cdots+\sin(\bar x_8)\Big]\De x\\
&amp;=\Big[\sin(\tfrac{\pi}{16})+
\sin(\tfrac{3\pi}{16})+
\sin(\tfrac{5\pi}{16})+
\sin(\tfrac{7\pi}{16})+
\sin(\tfrac{9\pi}{16})+\\
&amp;\hskip2in
\sin(\tfrac{11\pi}{16})+
\sin(\tfrac{13\pi}{16})+
\sin(\tfrac{15\pi}{16})\Big]\tfrac{\pi}{8}\\
&amp;=\Big[0.1951+
0.5556+
0.8315+
0.9808+
0.9808+\\
&amp;\hskip2in
0.8315+
0.5556+
0.1951\Big]\times 0.3927\\
&amp;=5.1260\times 0.3927
=2.013
\end{align*}
</div>
</li>
<li id="li-2858">Again, we have chosen this example so that we can compare it against the exact  value:<div class="displaymath">
\begin{align*}
\int_0^\pi \sin x \dee{x} &amp;= \big[ -\cos x \big]_0^\pi = -\cos\pi + \cos 0 = 2.
\end{align*}
</div>
</li>
<li id="li-2859">So with eight steps of the midpoint rule we achieved<div class="displaymath">
\begin{align*}
\text{absolute error} &amp;= |2.013-2|=0.013\\
\text{relative error} &amp;= \frac{|2.013-2|}{2} = 0.0065\\
\text{percentage error} &amp;= 100 \times \frac{|2.013-2|}{2} = 0.65 \%
\end{align*}
</div>With little work we have managed to estimate the integral to within \(1\%\) of its true value.</li>
</ul></article></div></section><section class="subsection" id="sec_trapRule"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.11.2</span> <span class="title">The trapezoidal rule</span>
</h3>
<p id="p-7627">Consider again the area represented by the integral \(\int_{x_{j-1}}^{x_j} f(x)\,\dee{x}\text{.}\)  The trapezoidal rule <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-252" id="fn-252"><sup> 3 </sup></a> (unsurprisingly) approximates this area by a trapezoid <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-253" id="fn-253"><sup> 4 </sup></a> whose vertices lie at</p>
<div class="displaymath">
\begin{gather*}
(x_{j-1},0), (x_{j-1},f(x_{j-1})), (x_{j},f(x_{j})) \text{ and } (x_{j},0).
\end{gather*}
</div>
<div class="hidden-content tex2jax_ignore" id="hk-fn-252"><div class="fn">This method is also called the “trapezoid rule” and  “trapezium rule”.</div></div>
<div class="hidden-content tex2jax_ignore" id="hk-fn-253"><div class="fn">A  trapezoid is a four sided polygon, like a rectangle. But, unlike a rectangle, the top and  bottom of a trapezoid need not be parallel.</div></div>
<div class="sidebyside"><div class="sbsrow" style="margin-left:10%;margin-right:10%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="text/figs/trap.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7628">The trapezoidal approximation of the integral \(\int_{x_{j-1}}^{x_j} f(x)\,\dee{x}\) is the  shaded region in the figure on the right above. It has width \(x_j-x_{j-1}=\De x\text{.}\) Its left hand side has height \(f(x_{j-1})\) and its right hand side has height \(f(x_j)\text{.}\)</p>
<p id="p-7629">As the figure below shows, the area of a trapezoid is its width times its average height.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:20%;margin-right:20%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="text/figs/trapArea.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7630">So the trapezoidal rule approximates each subintegral by</p>
<div class="displaymath">
\begin{equation*}
\int_{x_{j-1}}^{x_j} f(x)\,\dee{x}\approx \tfrac{f(x_{j-1})+f(x_j)}{2}\De x
\end{equation*}
</div>
<p data-braille="continuation">Applying this approximation to each subinterval and then summing the result gives us the  following approximation of the full integral</p>
<div class="displaymath">
\begin{align*}
\int_a^b f(x)\,\dee{x}&amp;=
\int_{x_0}^{x_1} f(x)\,\dee{x} + \int_{x_1}^{x_2} f(x)\,\dee{x}
+\cdots+\int_{x_{n-1}}^{x_n} f(x)\,\dee{x}\\
&amp; \approx \tfrac{f(x_0)+f(x_1)}{2}\De x +  \tfrac{f(x_1)+f(x_2)}{2}\De x
+ \cdots +
\tfrac{f(x_{n-1})+f(x_n)}{2}\De x\\
&amp;=
\Big[\half f(x_0)+f(x_1)+f(x_2)+\cdots+ f(x_{n-1})+\half f(x_n)\Big]\De x
\end{align*}
</div>
<p data-braille="continuation">So notice that the approximation has a very similar form to the midpoint rule, excepting that</p>
<ul class="disc">
<li id="li-2860">we evaluate the function at the \(x_j\)'s rather than at the midpoints, and</li>
<li id="li-2861">we multiply the value of the function at the endpoints \(x_0,x_n\) by \(\frac12\text{.}\)</li>
</ul>
<p id="p-7631">In summary:</p>
<article class="fact theorem-like" id="eq_TRPrule"><h6 class="heading">
<span class="type">Equation</span><span class="space"> </span><span class="codenumber">6.11.6</span><span class="period">.</span><span class="space"> </span><span class="title">The trapezoidal rule.</span>
</h6>
<p id="p-7632">The trapezoidal rule approximation is</p>
<div class="displaymath">
\begin{align*}
\int_a^b f(x)\,\dee{x}
&amp;\approx\Big[\half f(x_0)+f(x_1)+f(x_2)+\cdots+ f(x_{n-1})+\half f(x_n)\Big]\De x
\end{align*}
</div>
<p data-braille="continuation">where</p>
<div class="displaymath">
\begin{gather*}
\De x = \tfrac{b-a}{n},\quad
x_0=a,\quad x_1=a+\De x,\quad
x_2=a+2\De x,\quad
\cdots,\quad x_{n-1}=b-\De x,\quad
x_n=b
\end{gather*}
</div></article><p id="p-7633">To compare and contrast we apply the trapezoidal rule to the examples we did above with the midpoint rule.</p>
<article class="example example-like" id="eg_TrapB"><a data-knowl="" class="id-ref example-knowl original" data-refid="hk-eg_TrapB"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.11.7</span><span class="period">.</span><span class="space"> </span><span class="title">\(\int_0^1 \frac{4}{1+x^2}\,\dee{x}\) — using the trapezoidal rule.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-eg_TrapB"><article class="example example-like"><p id="p-7634"><em class="alert">Solution:</em> We proceed very similarly to Example <a class="xref" data-knowl="./knowl/eg_MidpointB.html" title="Example 6.11.3: \(\int_0^1 \frac{4}{1+x^2}\,\dee{x}\)">6.11.3</a> and again use \(n=8\) steps.</p>
<ul class="disc">
<li id="li-2862">We again have \(f(x)=\frac{4}{1+x^2}\text{,}\) \(a=0\text{,}\) \(b=1\text{,}\) \(\De x=\tfrac{1}{8}\) and<div class="displaymath">
\begin{align*}
x_0&amp;=0 &amp; x_1&amp;=\tfrac{1}{8} &amp; x_2&amp;=\tfrac{2}{8}
&amp;&amp; \cdots &amp;
x_7&amp;=\tfrac{7}{8}&amp;
x_8&amp;=\tfrac{8}{8}=1
\end{align*}
</div>
</li>
<li id="li-2863">Applying the trapezoidal rule, Equation <a class="xref" data-knowl="./knowl/eq_TRPrule.html" title="Equation 6.11.6: The trapezoidal rule">6.11.6</a>, gives<div class="displaymath">
\begin{align*}
&amp;\int_0^1 \frac{4}{1+x^2}\,\dee{x}
\approx
\bigg[\frac{1}{2}\overbrace{\frac{4}{1\!+\!x_0^2}}^{f(x_0)}
+\overbrace{\frac{4}{1\!+\!x_1^2}}^{f(x_1)}
+\!\cdots\!
+\overbrace{\frac{4}{1\!+\!x_7^2}}^{f(x_{n-1})}
+\frac{1}{2}\overbrace{\frac{4}{1\!+\!x_8^2}}^{f(x_n)}
\bigg]\De x\\
&amp;\hskip0.25in=\bigg[\frac{1}{2}\frac{4}{1+0^2}+
\frac{4}{1+\tfrac{1}{8^2}}+
\frac{4}{1+\tfrac{2^2}{8^2}}+
\frac{4}{1+\tfrac{3^2}{8^2}}\\
&amp;\hskip0.5in +\frac{4}{1+\tfrac{4^2}{8^2}}+
\frac{4}{1+\tfrac{5^2}{8^2}}+
\frac{4}{1+\tfrac{6^2}{8^2}}+
\frac{4}{1+\tfrac{7^2}{8^2}}+
\frac{1}{2}\frac{4}{1+\tfrac{8^2}{8^2}}\bigg]\frac{1}{8}\\
&amp;\hskip0.25in=\Big[\frac{1}{2}\times 4+
3.939+
3.765+
3.507\\
&amp;\hskip0.5in  +3.2+
2.876+
2.56+
2.266+
\frac{1}{2}\times 2\Big]\frac{1}{8}\\
&amp;\hskip0.25in =3.139
\end{align*}
</div>to three decimal places.</li>
<li id="li-2864">The exact value of the integral is still \(\pi\text{.}\) So the error in the approximation  generated by eight steps  of the trapezoidal rule is  \(|3.139-\pi|=0.0026\text{,}\) which is  \(100\tfrac{|3.139-\pi|}{\pi}\% =0.08\%\) of the exact answer. Notice that this is roughly twice the error that we achieved using the midpoint  rule in Example <a class="xref" data-knowl="./knowl/eg_MidpointB.html" title="Example 6.11.3: \(\int_0^1 \frac{4}{1+x^2}\,\dee{x}\)">6.11.3</a>.</li>
</ul></article></div>
<p id="p-7635">Let us also redo Example <a class="xref" data-knowl="./knowl/eg_Midpoint.html" title="Example 6.11.5: \(\int_0^\pi\sin x\,\dee{x}\)">6.11.5</a> using the trapezoidal rule.</p>
<article class="example example-like" id="eg_Trap"><a data-knowl="" class="id-ref example-knowl original" data-refid="hk-eg_Trap"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.11.8</span><span class="period">.</span><span class="space"> </span><span class="title">\(\int_0^\pi\sin x\,\dee{x}\) — using the trapezoidal rule.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-eg_Trap"><article class="example example-like"><p id="p-7636"><em class="alert">Solution:</em> We proceed very similarly to Example <a class="xref" data-knowl="./knowl/eg_Midpoint.html" title="Example 6.11.5: \(\int_0^\pi\sin x\,\dee{x}\)">6.11.5</a> and again use \(n=8\) steps.</p>
<ul class="disc">
<li id="li-2865">We again have \(a=0\text{,}\) \(b=\pi\text{,}\) \(\De x=\tfrac{\pi}{8}\) and<div class="displaymath">
\begin{align*}
x_0&amp;=0&amp; x_1&amp;=\tfrac{\pi}{8}&amp;
x_2&amp;=\tfrac{2\pi}{8}&amp; \cdots&amp;&amp;
x_7&amp;=\tfrac{7\pi}{8}&amp;
x_8&amp;=\tfrac{8\pi}{8}=\pi
\end{align*}
</div>
</li>
<li id="li-2866">Applying the trapezoidal rule, Equation <a class="xref" data-knowl="./knowl/eq_TRPrule.html" title="Equation 6.11.6: The trapezoidal rule">6.11.6</a>, gives<div class="displaymath">
\begin{align*}
&amp;\int_0^\pi\sin x\,\dee{x}
\approx
\Big[\half\sin(x_0)+\sin(x_1)+\cdots+\sin(x_7)+\half\sin(x_8)\Big]\De x\\
&amp;=\Big[\half\sin0 +
\sin\tfrac{\pi}{8}+
\sin\tfrac{2\pi}{8}+
\sin\tfrac{3\pi}{8}+
\sin\tfrac{4\pi}{8}+
\sin\tfrac{5\pi}{8}\\
&amp;\hskip0.5in+\sin\tfrac{6\pi}{8}+
\sin\tfrac{7\pi}{8}+
\half\sin\tfrac{8\pi}{8}\Big]\tfrac{\pi}{8}\\
&amp;=\Big[\half\!\times\! 0+
0.3827+
0.7071+
0.9239+
1.0000+
0.9239+\\
&amp;\hskip0.5in
0.7071+
0.3827+
\half\!\times\! 0\Big]\times 0.3927\\
&amp;=5.0274\times 0.3927
=1.974
\end{align*}
</div>
</li>
<li id="li-2867">The exact answer is \(\int_0^\pi\sin x\,\dee{x}=-\cos x\Big|_0^\pi=2\text{.}\) So with eight steps  of the trapezoidal rule we  achieved \(100\tfrac{|1.974-2|}{2}=1.3\%\)  accuracy. Again this is approximately twice the error we achieved in  Example <a class="xref" data-knowl="./knowl/eg_Midpoint.html" title="Example 6.11.5: \(\int_0^\pi\sin x\,\dee{x}\)">6.11.5</a> using the midpoint rule.</li>
</ul></article></div>
<p id="p-7637">These two examples suggest that the midpoint rule is more accurate than the  trapezoidal rule. Indeed, this observation is born out by a rigorous analysis of  the error — see Section <a href="sec_numeric_int.html#ssec_num_int_err" class="internal" title="Subsection 6.11.4: Three Simple Numerical Integrators — Error Behaviour">6.11.4</a>.</p></section><section class="subsection" id="sec_Simpson"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.11.3</span> <span class="title">Simpson's Rule</span>
</h3>
<p id="p-7638">When we use the trapezoidal rule we approximate the area  \(\int_{x_{j-1}}^{x_j}f(x)\dee{x}\)  by the area between the \(x\)-axis and a straight line that runs from  \((x_{j-1},f(x_{j-1}))\) to \((x_j, f(x_j))\) — that is, we approximate the function \(f(x)\)  on this interval by a linear function that agrees with the function at each  endpoint. An obvious way to extend this — just as we did when extending linear  approximations to quadratic approximations in our differential calculus course — is to  approximate the function with a quadratic. This is  precisely what Simpson's <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-254" id="fn-254"><sup> 5 </sup></a> rule does.</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-254"><div class="fn">Simpson's rule is named after the 18th century English  mathematician Thomas Simpson, despite its use a century earlier by the German  mathematician and astronomer Johannes Kepler. In many German texts the rule is often  called Kepler's rule.</div></div>
<p id="p-7639">Simpson's rule approximates the integral over two neighbouring subintervals by the area  between a parabola and the \(x\)-axis. In order to describe this parabola we need 3  distinct points (which is why we approximate two subintegrals at a time). That is, we  approximate</p>
<div class="displaymath">
\begin{align*}
\int_{x_0}^{x_1} f(x)\,\dee{x} + \int_{x_1}^{x_2} f(x)\,\dee{x}  &amp;= \int_{x_0}^{x_2} f(x)\,\dee{x}
\end{align*}
</div>
<p data-braille="continuation">by the area bounded by the parabola that passes through the three points  \(\big(x_0,f(x_0)\big)\text{,}\) \(\big(x_1,f(x_1)\big)\) and \(\big(x_2,f(x_2)\big)\text{,}\) the \(x\)-axis  and the vertical lines \(x=x_0\) and \(x=x_2\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:33.5%;margin-right:33.5%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="text/figs/Simpson.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7640">We repeat this on the next pair of subintervals and approximate \(\int_{x_2}^{x_4} f(x)\,\dee{x}\) by the area between the \(x\)-axis and the part of a parabola with \(x_2\le x\le x_4\text{.}\) This parabola passes  through the three points \(\big(x_2,f(x_2)\big)\text{,}\) \(\big(x_3,f(x_3)\big)\) and \(\big(x_4,f(x_4)\big)\text{.}\) And so on. Because Simpson's rule does the approximation two slices at a time, \(n\) <em class="emphasis">must be even</em>.</p>
<p id="p-7641">To derive Simpson's rule formula, we first find the equation of the parabola that passes through the three points \(\big(x_0,f(x_0)\big)\text{,}\) \(\big(x_1,f(x_1)\big)\) and \(\big(x_2,f(x_2)\big)\text{.}\) Then we find the area between the \(x\)-axis and the part of that parabola with \(x_0\le x\le x_2\text{.}\) To simplify  this computation consider a parabola passing through the points \((-h,y_{-1}), (0,y_0)\) and  \((h,y_1)\text{.}\)</p>
<p id="p-7642">Write the equation of the parabola as</p>
<div class="displaymath">
\begin{align*}
y &amp;= Ax^2 + Bx +C
\end{align*}
</div>
<p data-braille="continuation">Then the area between it and the \(x\)-axis with \(x\) running from \(-h\) to \(h\) is</p>
<div class="displaymath">
\begin{align*}
\int_{-h}^h \big[ Ax^2 + Bx +C \big] \dee{x}
&amp;= \left[ \frac{A}{3}x^3 + \frac{B}{2}x^2 + Cx \right]_{-h}^h\\
&amp;= \frac{2A}{3}h^3 + 2Ch &amp; \text{it is helpful to write it as}\\
&amp;= \frac{h}{3}\left( 2Ah^2 + 6C \right)
\end{align*}
</div>
<p id="p-7643">Now, the the three points \((-h,y_{-1}), (0,y_0)\) and \((h,y_1)\) lie on this parabola if and  only if</p>
<div class="displaymath">
\begin{align*}
A h^2 - Bh + C &amp;= y_{-1} &amp; \text{at $(-h,y_{-1})$}\\
C &amp;= y_{0} &amp; \text{at $(0,y_{0})$}\\
A h^2 + Bh + C &amp;= y_{1} &amp; \text{at $(h,y_{1})$}
\end{align*}
</div>
<p data-braille="continuation">Adding the first and third equations together gives us</p>
<div class="displaymath">
\begin{align*}
2Ah^2 + (B-B)h + 2C &amp;= y_{-1}+y_{1}
\end{align*}
</div>
<p data-braille="continuation">To this we add four times the middle equation</p>
<div class="displaymath">
\begin{align*}
2Ah^2 + 6C &amp;= y_{-1}+4y_0+y_1.
\end{align*}
</div>
<p data-braille="continuation">This means that</p>
<div class="displaymath">
\begin{align*}
\text{area} &amp;=  \int_{-h}^h \big[ Ax^2 + Bx +C \big] \dee{x}   = \frac{h}{3}\left( 2Ah^2 + 6C \right)\\
&amp;= \frac{h}{3}\left(y_{-1}+4y_0+y_1\right)
\end{align*}
</div>
<p data-braille="continuation">Note that here</p>
<ul class="disc">
<li id="li-2868">\(h\) is one half of the length of the \(x\)-interval under consideration</li>
<li id="li-2869">\(y_{-1}\) is the height of the parabola at the left hand end of the interval under  consideration</li>
<li id="li-2870">\(y_0\) is the height of the parabola at the middle point of the interval under  consideration</li>
<li id="li-2871">\(y_{1}\) is the height of the parabola at the right hand end of the interval under  consideration</li>
</ul>
<p id="p-7644">So Simpson's rule approximates</p>
<div class="displaymath">
\begin{equation*}
\int_{x_0}^{x_2} f(x)\,\dee{x}
\approx \tfrac{1}{3}\De x\big[f(x_0)+4f(x_1)+f(x_2)\big]
\end{equation*}
</div>
<p data-braille="continuation">and</p>
<div class="displaymath">
\begin{equation*}
\int_{x_2}^{x_4} f(x)\,\dee{x}
\approx \tfrac{1}{3}\De x\big[f(x_2)+4f(x_3)+f(x_4)\big]
\end{equation*}
</div>
<p data-braille="continuation">and so on. Summing these all together gives:</p>
<div class="displaymath">
\begin{align*}
\int_a^b&amp; f(x)\,\dee{x}
=\int_{x_0}^{x_2} f(x)\,\dee{x}
+\int_{x_2}^{x_4} f(x)\,\dee{x}
+\int_{x_4}^{x_6} f(x)\,\dee{x}
+\cdots
+\int_{x_{n-2}}^{x_n} f(x)\,\dee{x}\\
&amp;\approx\,\tfrac{\De x}{3}\big[f(x_0)+4f(x_1)+f(x_2)\big]
+\,\tfrac{\De x}{3}\big[f(x_2)+4f(x_3)+f(x_4)\big] \cr
&amp;\ \ \ +\,\tfrac{\De x}{3}\big[f(x_4)+4f(x_5)+f(x_6)\big]
+\,\cdots\
+\,\tfrac{\De x}{3}\big[f(x_{n-2})+4f(x_{n-1})+f(x_n)\big]\\
&amp;=\Big[f(x_0)\!+4f(x_1)\!+2f(x_2)\!+4f(x_3)\!+2f(x_4)\!
+\cdots+ 2f(x_{n-2})\!+4f(x_{n-1})\!+ f(x_n)\Big]\tfrac{\De x}{3}
\end{align*}
</div>
<p id="p-7645">In summary</p>
<article class="fact theorem-like" id="eq_SIMPrule"><h6 class="heading">
<span class="type">Equation</span><span class="space"> </span><span class="codenumber">6.11.9</span><span class="period">.</span><span class="space"> </span><span class="title">Simpson's rule.</span>
</h6>
<p id="p-7646">The Simpson's rule approximation is</p>
<div class="displaymath">
\begin{align*}
\int_a^b f(x)\,\dee{x}
&amp;\approx\Big[f(x_0)\!+4f(x_1)\!+2f(x_2)\!+4f(x_3)\!+2f(x_4)\!
+\cdots\\
&amp;\hskip2in \cdots + 2f(x_{n-2})\!+4f(x_{n-1})\!+ f(x_n)\Big]\tfrac{\De x}{3}
\end{align*}
</div>
<p data-braille="continuation">where \(n\) is even and</p>
<div class="displaymath">
\begin{gather*}
\De x = \tfrac{b-a}{n},\quad
x_0=a,\quad x_1=a+\De x,\quad
x_2=a+2\De x,\quad
\cdots,\quad x_{n-1}=b-\De x,\quad
x_n=b
\end{gather*}
</div></article><p id="p-7647">Notice that Simpson's rule requires essentially no more work than the trapezoidal rule.  In both rules we must evaluate \(f(x)\) at \(x=x_0,x_1,\cdots,x_n\text{,}\) but we add those terms  multiplied by different constants <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-255" id="fn-255"><sup> 6 </sup></a>.</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-255"><div class="fn">There is an easy generalisation of Simpson's  rule that uses cubics instead of parabolas. It is known as Simpson's second rule and Simpson's  \(\frac38\) rule. While one can push this approach further (using quartics, quintics  etc), it can sometimes lead to larger errors — the interested reader should look up  Runge's phenomenon.</div></div>
<p id="p-7648">Let's put it to work on our two running examples.</p>
<article class="example example-like" id="eg_SimpsonB"><a data-knowl="" class="id-ref example-knowl original" data-refid="hk-eg_SimpsonB"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.11.10</span><span class="period">.</span><span class="space"> </span><span class="title">\(\int_0^1 \frac{4}{1+x^2}\,\dee{x}\) — using Simpson's rule.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-eg_SimpsonB"><article class="example example-like"><p id="p-7649"><em class="alert">Solution:</em> We proceed almost identically to Example <a class="xref" data-knowl="./knowl/eg_TrapB.html" title="Example 6.11.7: \(\int_0^1 \frac{4}{1+x^2}\,\dee{x}\) — using the trapezoidal rule">6.11.7</a> and again use \(n=8\) steps.</p>
<ul class="disc">
<li id="li-2872">We have the same \(\De,a,b,x_0,\cdots, x_n\) as Example <a class="xref" data-knowl="./knowl/eg_TrapB.html" title="Example 6.11.7: \(\int_0^1 \frac{4}{1+x^2}\,\dee{x}\) — using the trapezoidal rule">6.11.7</a>.</li>
<li id="li-2873">Applying Equation <a class="xref" data-knowl="./knowl/eq_SIMPrule.html" title="Equation 6.11.9: Simpson's rule">6.11.9</a> gives<div class="displaymath">
\begin{align*}
&amp;\int_0^1 \frac{4}{1+x^2}\,\dee{x}\\
&amp;\approx
\bigg[\frac{4}{1+0^2}+
4\frac{4}{1+\tfrac{1}{8^2}}+
2\frac{4}{1+\tfrac{2^2}{8^2}}+
4\frac{4}{1+\tfrac{3^2}{8^2}}+
2\frac{4}{1+\tfrac{4^2}{8^2}}\\
&amp;\hskip0.5in
+4\frac{4}{1+\tfrac{5^2}{8^2}}+
2\frac{4}{1+\tfrac{6^2}{8^2}}+
4\frac{4}{1+\tfrac{7^2}{8^2}}+
\frac{4}{1+\tfrac{8^2}{8^2}}\bigg]\frac{1}{8\times 3}\\
&amp;=\Big[         4\!+\!
4\times 3.938461538 \!+\!
2\times 3.764705882 \!+\!
4\times 3.506849315 \!+\!
2\times 3.2 \\
&amp;\hskip0.5in
+4\times 2.876404494 +
2\times 2.56 +
4\times 2.265486726 +
2\Big]\frac{1}{8\times 3}\\
&amp;=3.14159250
\end{align*}
</div>to eight decimal places.</li>
<li id="li-2874">This agrees with \(\pi\) (the exact value of the integral) to six decimal places. So the error in the approximation generated by eight steps  of Simpson's  rule is \(|3.14159250-\pi|=1.5\times 10^{-7}\text{,}\) which is  \(100\tfrac{|3.14159250-\pi|}{\pi}\% =5\times 10^{-6}\%\) of the exact answer.</li>
</ul></article></div>
<p id="p-7650">It is striking that the absolute error approximating with Simpson's rule is so much  smaller than the error from the midpoint and trapezoidal rules.</p>
<div class="displaymath">
\begin{align*}
&amp;\text{midpoint error}\hskip-0.35in &amp;&amp;= 0.0013\\
&amp;\text{trapezoid error}\hskip-0.35in &amp;&amp;= 0.0026\\
&amp;\text{Simpson error}\hskip-0.35in &amp;&amp;= 0.00000015
\end{align*}
</div>
<p id="p-7651">Buoyed by this success, we will also redo Example <a class="xref" data-knowl="./knowl/eg_Trap.html" title="Example 6.11.8: \(\int_0^\pi\sin x\,\dee{x}\) — using the trapezoidal rule">6.11.8</a> using Simpson's rule.</p>
<article class="example example-like" id="eg_Simpson"><a data-knowl="" class="id-ref example-knowl original" data-refid="hk-eg_Simpson"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.11.11</span><span class="period">.</span><span class="space"> </span><span class="title">\(\int_0^\pi\sin x\,\dee{x}\) — Simpson's rule.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-eg_Simpson"><article class="example example-like"><p id="p-7652"><em class="alert">Solution:</em> We proceed almost identically to Example <a class="xref" data-knowl="./knowl/eg_Trap.html" title="Example 6.11.8: \(\int_0^\pi\sin x\,\dee{x}\) — using the trapezoidal rule">6.11.8</a> and again use \(n=8\) steps.</p>
<ul class="disc">
<li id="li-2875">We have the same \(\De,a,b,x_0,\cdots, x_n\) as Example <a class="xref" data-knowl="./knowl/eg_TrapB.html" title="Example 6.11.7: \(\int_0^1 \frac{4}{1+x^2}\,\dee{x}\) — using the trapezoidal rule">6.11.7</a>.</li>
<li id="li-2876">Applying Equation <a class="xref" data-knowl="./knowl/eq_SIMPrule.html" title="Equation 6.11.9: Simpson's rule">6.11.9</a> gives<div class="displaymath">
\begin{align*}
&amp;\int_0^\pi\sin x\,\dee{x}\\
&amp;\hskip0.5in\approx
\Big[\sin(x_0)+4\sin(x_1)+2\sin(x_2)+\cdots+4\sin(x_7)+\sin(x_8)\Big]\tfrac{\De x}{3}\\
&amp;\hskip0.5in=\Big[\sin(0)+
4\sin(\tfrac{\pi}{8})+
2\sin(\tfrac{2\pi}{8})+
4\sin(\tfrac{3\pi}{8})+
2\sin(\tfrac{4\pi}{8})\cr
&amp;\hskip0.5in\phantom{=\Big[\sin(0)\,}
+4\sin(\tfrac{5\pi}{8})+
2\sin(\tfrac{6\pi}{8})+
4\sin(\tfrac{7\pi}{8})+
\sin(\tfrac{8\pi}{8})\Big]\tfrac{\pi}{8\times 3}\cr
&amp;=\hskip0.5in\Big[ 0+
4\times 0.382683+
2\times 0.707107+
4\times 0.923880+
2\times 1.0\\
&amp;\hskip0.5in\phantom{=\Big[ 0\,}+
4\times 0.923880+
2\times 0.707107+
4\times 0.382683+0\Big]\tfrac{\pi}{8\times 3}\\
&amp;\hskip0.5in=15.280932\times 0.130900\\
&amp;\hskip0.5in=2.00027
\end{align*}
</div>
</li>
<li id="li-2877">With only eight steps  of Simpson's rule we  achieved  \(100\tfrac{2.00027-2}{2}=0.014\%\) accuracy.</li>
</ul></article></div>
<p id="p-7653">Again we contrast the error we achieved with the other two rules:</p>
<div class="displaymath">
\begin{align*}
&amp;\text{midpoint error}\hskip-0.35in &amp;&amp;= 0.013\\
&amp;\text{trapezoid error}\hskip-0.35in &amp;&amp;= 0.026\\
&amp;\text{Simpson error}\hskip-0.35in &amp;&amp;= 0.00027
\end{align*}
</div>
<p id="p-7654">This completes our derivation of the midpoint, trapezoidal and  Simpson's rules for approximating the values of definite integrals.  So far we have not  attempted to see how efficient and how accurate the algorithms are in general. That's our next task.</p></section><section class="subsection" id="ssec_num_int_err"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.11.4</span> <span class="title">Three Simple Numerical Integrators — Error Behaviour</span>
</h3>
<p id="p-7655">Now we are armed with our three (relatively simple) method for numerical integration we  should give thought to how practical they might be in the real world <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-256" id="fn-256"><sup> 7 </sup></a>. Two obvious  considerations when deciding whether or not  a given algorithm is of any practical value are</p>
<ol class="lower-alpha">
<li id="li-2878">the amount of computational effort required to execute the algorithm and</li>
<li id="li-2879">the accuracy that this computational effort yields.</li>
</ol>
<p data-braille="continuation">For algorithms like our simple integrators, the bulk of the computational effort usually  goes into evaluating the function \(f(x)\text{.}\) The number of evaluations of \(f(x)\) required for  \(n\) steps of the midpoint rule is \(n\text{,}\) while the number required for \(n\) steps of the  trapezoidal and Simpson's rules is \(n+1\text{.}\) So all three of our rules require essentially the same amount of effort — one evaluation of \(f(x)\) per step.</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-256"><div class="fn">Indeed,  even beyond the “real world” of many applications in first year calculus texts, some of  the methods we have described are used by actual people (such as ship builders, engineers  and surveyors) to estimate areas and volumes of actual objects!</div></div>
<p id="p-7656">To get a first impression of the error behaviour of these methods, we apply them to a  problem whose answer we know exactly:</p>
<div class="displaymath">
\begin{gather*}
\int_0^\pi\sin x\,\dee{x}=-\cos x\big|_0^\pi = 2.
\end{gather*}
</div>
<p data-braille="continuation">To be a little more precise, we would like to understand how the errors of the three  methods change as we increase the effort we put in (as measured by the number  of steps \(n\)). The following table lists the error in the approximate value  for this number generated by our three rules applied with three different  choices of \(n\text{.}\) It also lists the number of evaluations of \(f\) required to compute the approximation.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b1 r1 l1 t1 lines"></td>
<td class="l m b1 r1 l0 t1 lines" colspan="2"><em class="alert">Midpoint</em></td>
<td class="l m b1 r1 l0 t1 lines" colspan="2"><em class="alert">Trapezoidal</em></td>
<td class="l m b1 r1 l0 t1 lines" data-braille="last-cell" colspan="2"><em class="alert">Simpson's</em></td>
</tr>
<tr>
<td class="l m b1 r1 l1 t0 lines">n</td>
<td class="l m b1 r1 l0 t0 lines">error</td>
<td class="l m b1 r1 l0 t0 lines">#  evals</td>
<td class="l m b1 r1 l0 t0 lines">error</td>
<td class="l m b1 r1 l0 t0 lines">#  evals</td>
<td class="l m b1 r1 l0 t0 lines">error</td>
<td class="l m b1 r1 l0 t0 lines" data-braille="last-cell"># evals</td>
</tr>
<tr>
<td class="l m b1 r1 l1 t0 lines">10</td>
<td class="l m b1 r1 l0 t0 lines">\(4.1\times 10^{-1}\)</td>
<td class="l m b1 r1 l0 t0 lines">10</td>
<td class="l m b1 r1 l0 t0 lines">\(8.2\times 10^{-1}\)</td>
<td class="l m b1 r1 l0 t0 lines">11</td>
<td class="l m b1 r1 l0 t0 lines">\(5.5\times 10^{-3}\)</td>
<td class="l m b1 r1 l0 t0 lines" data-braille="last-cell">11</td>
</tr>
<tr>
<td class="l m b1 r1 l1 t0 lines">100</td>
<td class="l m b1 r1 l0 t0 lines">\(4.1\times 10^{-3}\)</td>
<td class="l m b1 r1 l0 t0 lines">100</td>
<td class="l m b1 r1 l0 t0 lines">\(8.2\times 10^{-3}\)</td>
<td class="l m b1 r1 l0 t0 lines">101</td>
<td class="l m b1 r1 l0 t0 lines">\(5.4\times 10^{-7}\)</td>
<td class="l m b1 r1 l0 t0 lines" data-braille="last-cell">101</td>
</tr>
<tr>
<td class="l m b1 r1 l1 t0 lines">1000</td>
<td class="l m b1 r1 l0 t0 lines">\(4.1\times 10^{-5}\)</td>
<td class="l m b1 r1 l0 t0 lines">1000</td>
<td class="l m b1 r1 l0 t0 lines">\(8.2\times 10^{-5}\)</td>
<td class="l m b1 r1 l0 t0 lines">1001</td>
<td class="l m b1 r1 l0 t0 lines">\(5.5\times 10^{-11}\)</td>
<td class="l m b1 r1 l0 t0 lines" data-braille="last-cell">1001</td>
</tr>
</table></div></div></div>
<p id="p-7657">Observe that</p>
<ul class="disc">
<li id="li-2880">Using 101 evaluations of \(f\) worth of Simpson's rule gives an error 80 times smaller than 1000 evaluations of \(f\) worth of the midpoint rule.</li>
<li id="li-2881">The trapezoidal rule error with \(n\) steps is about twice the midpoint rule  error with \(n\) steps.</li>
<li id="li-2882">With the midpoint rule, increasing the number of steps by a factor of 10 appears to reduce the error by about a factor of  \(100=10^2=n^2\text{.}\)</li>
<li id="li-2883">With the trapezoidal rule, increasing the number of steps by a factor of 10 appears to reduce the error by about a factor of \(10^2=n^2\text{.}\)</li>
<li id="li-2884">With Simpson's rule, increasing the number of steps by a factor of 10 appears to reduce the error by about a factor of \(10^4=n^4\text{.}\)</li>
</ul>
<p id="p-7658">So it looks like</p>
<div class="displaymath">
\begin{align*}
&amp;\hbox{approx value of $\ds\int_a^b f(x)\,\dee{x}$ given by $n$ midpoint steps  }
\hskip-0.35in&amp;&amp;\approx \int_a^b f(x)\,\dee{x}+K_M\cdot \frac{1}{n^2}\\
&amp;\hbox{approx value of $\ds\int_a^b f(x)\,\dee{x}$ given by $n$ trapezoidal steps  }
\hskip-0.35in&amp;&amp;\approx  \int_a^b f(x)\,\dee{x}+K_T\cdot \frac{1}{n^2}\\
&amp;\hbox{approx value of $\ds\int_a^b f(x)\,\dee{x}$ given by $n$ Simpson's steps  }
\hskip-0.35in&amp;&amp;\approx  \int_a^b f(x)\,\dee{x}+K_M\cdot \frac{1}{n^4}
\end{align*}
</div>
<p data-braille="continuation">with some constants \(K_M,\ K_T\) and \(K_S\text{.}\) It also seems that \(K_T\approx 2 K_M\text{.}\)</p>
<figure class="figure figure-like" id="fig_INTerror"><div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;">
<div class="sbspanel" style="width:44.4444444444444%;justify-content:center;"><img src="text/figs/midPtError.svg" role="img" style="width: 100%; height: auto;" alt=""></div>
<div class="sbspanel" style="width:44.4444444444444%;justify-content:center;"><img src="text/figs/SimpsonError.svg" role="img" style="width: 100%; height: auto;" alt=""></div>
</div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">6.11.12<span class="period">.</span></span><span class="space"> </span>A log-log plot of the error in the \(n\) step approximation to \(\ds \int_0^\pi \sin  x\,\dee{x}\text{.}\)</figcaption></figure><p id="p-7659">To test these conjectures for the behaviour of the errors we apply our three rules with about ten different choices of \(n\) of the form \(n=2^m \) with \(m\) integer.  Figure <a class="xref" data-knowl="./knowl/fig_INTerror.html" title="Figure 6.11.12">6.11.12</a> contains two graphs of the results. The left-hand plot  shows the results for the midpoint and trapezoidal rules and the right-hand plot shows the results for Simpson's rule.</p>
<p id="p-7660">For each rule we are expecting (based on our conjectures above) that the error</p>
<div class="displaymath">
\begin{align*}
e_n &amp;= | \text{exact value } - \text{ approximate value}|
\end{align*}
</div>
<p data-braille="continuation">with \(n\) steps is (roughly) of the form</p>
<div class="displaymath">
\begin{gather*}
e_n=K\frac{1}{n^k}
\end{gather*}
</div>
<p data-braille="continuation">for some constants \(K\) and \(k\text{.}\) We would like to test if this is really the case, by  graphing \(Y=e_n\) against \(X=n\) and seeing if the graph “looks right”.  But it is not easy to tell whether or not a given curve really  is \(Y=\frac{K}{X^k}\text{,}\) for some specific \(k\text{,}\) by just looking at it. However, your eye is  pretty good at determining whether or not a graph is a straight line. Fortunately, there  is a little trick that turns the curve \(Y=\tfrac{K}{X^k}\) into a straight line — no  matter what \(k\) is.</p>
<p id="p-7661">Instead of plotting \(Y\) against \(X\text{,}\) we plot \(\log Y\) against \(\log X\text{.}\) This  transformation <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-257" id="fn-257"><sup> 8 </sup></a> works because when \(Y=\frac{K}{X^k}\)</p>
<div class="displaymath">
\begin{align*}
\log Y &amp;= \log K - k \log X
\end{align*}
</div>
<p data-braille="continuation">So plotting \(y=\log Y\) against \(x=\log X\) gives the straight line \(y=\log K -kx\text{,}\) which  has slope \(-k\) and \(y\)-intercept \(\log K\text{.}\)</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-257"><div class="fn">There is a variant of this trick that works even when you don't  know the answer to the integral ahead of time. Suppose that you suspect that the  approximation satisfies<div class="displaymath">
\begin{equation*}
M_n=A+K\tfrac{1}{n^k}
\end{equation*}
</div>where \(A\) is the exact value of the integral and suppose that you  don't know the values of \(A\text{,}\) \(K\) and \(k\text{.}\) Then<div class="displaymath">
\begin{align*}
M_{n}-M_{2n}  &amp;=K\tfrac{1}{n^k}-K\tfrac{1}{(2n)^k} =K\big(1-\tfrac{1}{2^k}\big)\tfrac{1}{n^k}
\end{align*}
</div>so plotting \(y=\log(M_{n}-M_{2n})\) against \(x=\log n\) gives the straight  line \(y=\log \big[K\big(1-\frac{1}{2^k}\big)\big] -kx\text{.}\)</div></div>
<p id="p-7662">The three graphs in Figure <a class="xref" data-knowl="./knowl/fig_INTerror.html" title="Figure 6.11.12">6.11.12</a> plot \(y=\log_2 e_n\)  against \(x=\log_2 n\) for our three rules. Note that we have chosen to use  logarithms <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-258" id="fn-258"><sup> 9 </sup></a> with  this “unusual base” because it makes it very clear how much the error is improved if we  <em class="emphasis">double</em> the number of steps used. To be more precise — one unit step along the  \(x\)-axis represents changing \(n \mapsto 2n\text{.}\) For example, applying Simpson's rule with  \(n=2^4\) steps results in an error of \(0000166\text{,}\) so the point \((x=\log_2 2^4=4, y=\log_2  0000166 = \frac{\log 0000166}{\log 2} = -15.8)\) has been included on the graph. Doubling  the effort used — that is, doubling the number of steps to \(n=2^5\)— results in an  error of \(0.00000103\text{.}\) So, the data point \((x=\log_2 2^5=5\ ,\  y=\log_2 0.00000103 =\frac{\ln 0.00000103}{\ln 2}=-19.9)\) lies on the graph. Note that the \(x\)-coordinates of  these points differ by 1 unit.</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-258"><div class="fn">Now is a good time for a quick revision of logarithms — see  “Whirlwind review of logarithms” in Section 2.7 of the CLP-1 text.</div></div>
<p id="p-7663">For each of the three sets of data points, a straight line has also been plotted “through” the data points. A procedure called linear  regression <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-259" id="fn-259"><sup> 10 </sup></a> has  been used to decide precisely which straight line to plot. It provides a formula for the slope and \(y\)-intercept of the straight  line which “best fits” any given set of data points. From the three lines,  it sure looks like \(k=2\) for the midpoint and trapezoidal rules and  \(k=4\) for Simpson's rule. It also looks like the ratio between the value of \(K\) for the trapezoidal rule,  namely \(K=2^{0.7253}\text{,}\) and the value of \(K\) for the midpoint rule,  namely \(K=2^{-0.2706}\text{,}\) is pretty close to 2:  \(2^{0.7253}/2^{-0.2706}=2^{0.9959}\text{.}\)</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-259"><div class="fn">Linear regression is not part of  this course as its derivation  requires some multivariable calculus. It is a very standard technique in statistics.</div></div>
<p id="p-7664">The intuition, about the error behaviour, that we have just developed  is in fact correct — provided the integrand \(f(x)\) is reasonably smooth. To be more  precise</p>
<article class="theorem theorem-like" id="thm_num_int_err"><h6 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">6.11.13</span><span class="period">.</span><span class="space"> </span><span class="title">Numerical integration errors.</span>
</h6>
<p id="p-7665">Assume that \(|f''(x)| \leq M\) for all \(a\leq x \leq b\text{.}\) Then</p>
<div class="displaymath">
\begin{align*}
&amp;\text{the total error introduced by the midpoint rule is bounded by } &amp; \frac{M}{24} \frac{(b-a)^3}{n^2}\\
&amp;\text{and}\\
&amp;\text{the total error introduced by the trapezoidal rule is bounded by } &amp;
\frac{M}{12} \frac{(b-a)^3}{n^2}\\
\end{align*}
<p class="intertext">when approximating \(\ds \int_a^b f(x)\dee{x}\text{.}\) Further, if \(|f^{(4)}(x)|\leq L\)  for all \(a\leq x \leq b\text{,}\) then</p>
\begin{align*}
&amp;\text{the total error introduced by Simpson's rule is bounded by } &amp; \frac{L}{180} \frac{(b-a)^5}{n^4}.
\end{align*}
</div></article><p id="p-7666">The first of these error bounds in proven in the following (optional) section. Here are some examples which illustrate how they are used. First let us check that the  above result is consistent with our data in Figure <a class="xref" data-knowl="./knowl/fig_INTerror.html" title="Figure 6.11.12">6.11.12</a></p>
<article class="example example-like" id="eg_MidpointErr"><a data-knowl="" class="id-ref example-knowl original" data-refid="hk-eg_MidpointErr"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.11.14</span><span class="period">.</span><span class="space"> </span><span class="title">Midpoint rule error approximating \(\int_0^\pi \sin  x\,\dee{x}\).</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-eg_MidpointErr"><article class="example example-like"><ul id="p-7667" class="disc">
<li id="li-2885">The integral \(\int_0^\pi \sin x\,\dee{x}\)  has \(b-a=\pi\text{.}\)</li>
<li id="li-2886">The second derivative of the integrand satisfies<div class="displaymath">
\begin{align*}
\left|\ddiff{2}{}{x}\sin x\right| &amp;= |-\sin x| \leq 1
\end{align*}
</div>So we take \(M=1\text{.}\)</li>
<li id="li-2887">So the error, \(e_n\text{,}\) introduced when \(n\) steps are used is bounded by<div class="displaymath">
\begin{align*}
|e_n|&amp;\le\frac{M}{24}\frac{(b-a)^3}{n^2}\\
&amp;=\frac{\pi^3}{24}\frac{1}{n^2}\\
&amp;\approx 1.29\frac{1}{n^2}
\end{align*}
</div>
</li>
<li id="li-2888">The data in the graph  in Figure <a class="xref" data-knowl="./knowl/fig_INTerror.html" title="Figure 6.11.12">6.11.12</a> gives<div class="displaymath">
\begin{align*}
|e_n| &amp;\approx 2^{-.2706}\frac{1}{n^2}=0.83\frac{1}{n^2}
\end{align*}
</div>which is consistent with the bound \(|e_n|\le \frac{\pi^3}{24}\frac{1}{n^2}\text{.}\)</li>
</ul></article></div>
<p id="p-7668">In a typical application we would be asked to evaluate a given integral  to some specified accuracy. For example, if you are manufacturer and your machinery can only cut materials to an accuracy of \({\tfrac{1}{10}}^{\rm th}\) of a millimeter, there is no point in making design specifications more accurate than  \({\tfrac{1}{10}}^{\rm th}\) of a millimeter.</p>
<article class="example example-like" id="eg_MidpointErr2"><a data-knowl="" class="id-ref example-knowl original" data-refid="hk-eg_MidpointErr2"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.11.15</span><span class="period">.</span><span class="space"> </span><span class="title">How many steps  for a given accuracy?</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-eg_MidpointErr2"><article class="example example-like"><p id="p-7669">Suppose, for example, that we wish to use the midpoint rule to evaluate <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-260" id="fn-260"><sup> 11 </sup></a></p>
<div class="displaymath">
\begin{gather*}
\int_0^1 e^{-x^2}\dee{x}
\end{gather*}
</div>
<p data-braille="continuation">to within an accuracy of \(10^{-6}\text{.}\)</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-260"><div class="fn">This is  our favourite running example of an integral that cannot be evaluated algebraically —  we need to use numerical methods.</div></div>
<p id="p-7670"><em class="alert">Solution:</em></p>
<ul class="disc">
<li id="li-2889">The integral has \(a=0\) and \(b=1\text{.}\)</li>
<li id="li-2890">The first two derivatives of the integrand are<div class="displaymath">
\begin{align*}
\diff{}{x}e^{-x^2}&amp;=-2xe^{-x^2} \hskip2in \text{and}\\
\ddiff{2}{}{x}e^{-x^2}  &amp;=\diff{}{x}\big(-2xe^{-x^2}\big)  =-2e^{-x^2}+4x^2e^{-x^2}=2(2x^2-1)e^{-x^2}
\end{align*}
</div>
</li>
<li id="li-2891">As \(x\) runs from 0 to 1, \(2x^2-1\) increases from \(-1\) to \(1\text{,}\) so that<div class="displaymath">
\begin{gather*}
0\le x\le 1\implies |2x^2-1|\le 1,\ e^{-x^2}\le 1\implies \big|2(2x^2-1)e^{-x^2}\big|\le 2
\end{gather*}
</div>So we take \(M=2\text{.}\)</li>
<li id="li-2892">The error introduced by the \(n\) step midpoint rule is at most<div class="displaymath">
\begin{align*}
e_n &amp; \leq \frac{M}{24}\frac{(b-a)^3}{n^2}\\
&amp;\leq \frac{2}{24}\frac{(1-0)^3}{n^2} = \frac{1}{12n^2}
\end{align*}
</div>
</li>
<li id="li-2893">We need this error to be smaller than \(10^{-6}\) so<div class="displaymath">
\begin{align*}
e_n &amp; \leq \frac{1}{12n^2} \leq 10^{-6} &amp; \text{and so }\\
12n^2 &amp;\geq 10^6 &amp; \text{clean up}\\
n^2 &amp;\geq \frac{10^6}{12} = 83333.3 &amp; \text{square root both sides}\\
n &amp;\geq 288.7
\end{align*}
</div>So \(289\) steps of the midpoint rule will do the job.</li>
<li id="li-2894">In fact \(n=289\) results in an error of about \(3.7\times 10^{-7}\text{.}\)</li>
</ul></article></div>
<p id="p-7671">That seems like far too much work, and the trapezoidal rule will have twice the error. So  we should look at Simpson's rule.</p>
<article class="example example-like" id="eg_SimpsonErr"><a data-knowl="" class="id-ref example-knowl original" data-refid="hk-eg_SimpsonErr"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.11.16</span><span class="period">.</span><span class="space"> </span><span class="title">How many steps using Simpson's rule?</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-eg_SimpsonErr"><article class="example example-like"><p id="p-7672">Suppose now that we wish evaluate \(\int_0^1 e^{-x^2}\,\dee{x}\) to within an accuracy of  \(10^{-6}\) — but now using Simpson's rule. How many steps should we use?</p>
<p id="p-7673"><em class="alert">Solution:</em></p>
<ul class="disc">
<li id="li-2895">Again we have \(a=0,b=1\text{.}\)</li>
<li id="li-2896">We then need to bound \(\ddiff{4}{}{x}e^{-x^2}\) on the domain of integration, \(0\leq  x\leq 1\text{.}\)<div class="displaymath">
\begin{align*}
\ddiff{3}{}{x}e^{-x^2}
&amp;=\diff{}{x}\big\{2(2x^2-1)e^{-x^2}\big\}
=8xe^{-x^2}-4x(2x^2-1)e^{-x^2}\\
&amp;=4(-2x^3+3x)e^{-x^2}\\
\ddiff{4}{}{x}e^{-x^2}
&amp;=\diff{}{x}\big\{4(-2x^3+3x)e^{-x^2}\big\}\\
&amp;=4(-6x^2+3)e^{-x^2}\hskip-4pt-8x(-2x^3+3x)e^{-x^2}\\
&amp;=4(4x^4-12x^2+3)e^{-x^2}
\end{align*}
</div>
</li>
<li id="li-2897">Now, for any \(x\text{,}\)  \(e^{-x^2}\le 1\text{.}\) Also, for \(0\le x\le 1\text{,}\)<div class="displaymath">
\begin{align*}
0 &amp; \leq x^2, x^4 \leq 1 &amp; \text{ so}\\
3 &amp; \leq 4x^4+3 \leq 7 &amp; \text{ and }\\
-12 &amp; \leq -12x^2 \leq 0 &amp; \text{adding these together gives}\\
-9 &amp; \leq 4x^4-12x^2 + 3 \leq 7
\end{align*}
</div>Consequently, \(|4x^4-12x^2+3|\) is bounded by \(9\) and so<div class="displaymath">
\begin{gather*}
\left|\ddiff{4}{}{x}e^{-x^2}\right| \leq 4\times 9=36
\end{gather*}
</div>So take \(L=36\text{.}\)</li>
<li id="li-2898">The error introduced by the \(n\) step Simpson's rule is at most<div class="displaymath">
\begin{align*}
e_n &amp; \leq \frac{L}{180}\frac{(b-a)^5}{n^4}\\
&amp; \leq \frac{36}{180} \frac{(1-0)^5}{n^4} = \frac{1}{5n^4}
\end{align*}
</div>
</li>
<li id="li-2899">In order for this error to be no more than \(10^{-6}\) we require \(n\) to satisfy<div class="displaymath">
\begin{align*}
e_n &amp;\leq \frac{1}{5n^4} \leq 10^{-6} &amp; \text{and so}\\
5n^4 &amp; \geq 10^6\\
n^4 &amp;\geq 200000 &amp; \text{take fourth root}\\
n &amp; \geq 21.15
\end{align*}
</div>So \(22\) steps of Simpson's rule will do the job.</li>
<li id="li-2900">\(n=22\) steps actually results in an error of \(3.5\times 10^{-8}\text{.}\) The reason that  we get an error so much smaller than we need is that we have overestimated the number of  steps required. This, in turn, occurred because we made quite a rough bound of  \(\left|\ddiff{4}{}{x}f(x)\right|\leq 36\text{.}\) If we are more careful then we will get a  slightly smaller \(n\text{.}\) It actually turns out <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-261" id="fn-261"><sup> 12 </sup></a> that you only need \(n=10\) to approximate within \(10^{-6}\text{.}\)</li>
</ul>
<div class="hidden-content tex2jax_ignore" id="hk-fn-261"><div class="fn">The authors tested this  empirically.</div></div></article></div></section><section class="subsection" id="subsection-99"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.11.5</span> <span class="title">Optional — An error bound for the midpoint rule</span>
</h3>
<p id="p-7674">We now try develop some understanding as to why we got the above experimental results. We start with the error generated by a single step of the midpoint rule. That is, the error introduced by the approximation</p>
<div class="displaymath">
\begin{equation*}
\int_{x_0}^{x_1}f(x)\,\dee{x}\approx f(\bar x_1)\De x \qquad\hbox{ where }
\De x=x_1-x_0,\ \bar x_1=\tfrac{x_0+x_1}{2}
\end{equation*}
</div>
<p data-braille="continuation">To do this we are going to need to apply integration by parts in a sneaky way. Let us  start by considering <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-262" id="fn-262"><sup> 13 </sup></a> a subinterval \(\alpha \leq x \leq  \beta\) and let's call the width of the subinterval \(2q\) so that  \(\beta=\alpha+2q\text{.}\) If we were to now apply the midpoint rule to this  subinterval, then we would write</p>
<div class="displaymath">
\begin{align*}
\int_\alpha^\beta f(x) \dee{x} &amp; \approx 2q \cdot f(\alpha+q) = q f(\alpha+q)  + q f(\beta-q)
\end{align*}
</div>
<p data-braille="continuation">since the interval has width \(2q\) and the midpoint is \(\alpha+q=\beta-q\text{.}\)</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-262"><div class="fn">We chose this interval so that we didn't have lots of  subscripts floating around in the algebra.</div></div>
<p id="p-7675">The sneaky trick we will employ is to write</p>
<div class="displaymath">
\begin{align*}
\int_\alpha^\beta f(x) \dee{x} &amp;= \int_\alpha^{\alpha+q}f(x)\dee{x} +  \int_{\beta-q}^\beta f(x)\dee{x}
\end{align*}
</div>
<p data-braille="continuation">and then examine each of the integrals on the right-hand side (using integration by  parts) and show that they are each of the form</p>
<div class="displaymath">
\begin{align*}
\int_\alpha^{\alpha+q}f(x)\dee{x} &amp; \approx q f(\alpha+q)  + \text{small error term}\\
\int_{\beta-q}^\beta f(x)\dee{x} &amp;\approx q f(\beta-q)  + \text{small error term}
\end{align*}
</div>
<p id="p-7676">Let us apply integration by parts to \(\int_\alpha^{\alpha+q} f(x)\dee{x}\) —  with \(u=f(x),  \dee{v}=\dee{x}\) so \(\dee{u}=f'(x)\dee{x}\) and we will make the slightly  non-standard  choice of \(v=x-\alpha\text{:}\)</p>
<div class="displaymath">
\begin{align*}
\int_\alpha^{\alpha+q} f(x)\dee{x}
&amp;= \big[ (x-\alpha)f(x)\big]_\alpha^{\alpha+q}
- \int_\alpha^{\alpha+q} (x-\alpha) f'(x) \dee{x}\\
&amp;= q f(\alpha+q) - \int_\alpha^{\alpha+q} (x-\alpha) f'(x) \dee{x}
\end{align*}
</div>
<p data-braille="continuation">Notice that the first term on the right-hand side is the term we need, and that our  non-standard choice of \(v\) allowed us to avoid introducing an \(f(\alpha)\) term.</p>
<p id="p-7677">Now integrate by parts again using \(u=f'(x), \dee{v}=(x-\alpha)\dee{x}\text{,}\) so  \(\dee{u}=f''(x),  v = \frac{(x-\alpha)^2}{2}\text{:}\)</p>
<div class="displaymath">
\begin{align*}
\int_\alpha^{\alpha+q} f(x)\dee{x}
&amp;= q f(\alpha+q) - \int_\alpha^{\alpha+q} (x-\alpha)f'(x)\dee{x}\\
&amp;= q f(\alpha+q)
- \left[ \frac{(x-\alpha)^2}{2} f'(x) \right]_\alpha^{\alpha+q}
+ \int_\alpha^{\alpha+q} \frac{(x-\alpha)^2}{2}f''(x)\dee{x}\\
&amp;= q f(\alpha+q) - \frac{q^2}{2}f'(\alpha+q)
+ \int_\alpha^{\alpha+q} \frac{(x-\alpha)^2}{2}f''(x)\dee{x}
\end{align*}
</div>
<p data-braille="continuation">To obtain a similar expression for the other integral, we repeat the above steps and  obtain:</p>
<div class="displaymath">
\begin{align*}
\int_{\beta-q}^\beta f(x)\dee{x}
&amp;= q f(\beta-q) + \frac{q^2}{2}f'(\beta-q)
+ \int_{\beta-q}^\beta \frac{(x-\beta)^2}{2}f''(x)\dee{x}
\end{align*}
</div>
<p data-braille="continuation">Now add together these two expressions</p>
<div class="displaymath">
\begin{align*}
\int_\alpha^{\alpha+q} f(x)\dee{x} + \int_{\beta-q}^\beta f(x)\dee{x}
&amp;= q f(\alpha+q) + q f(\beta-q)
+ \frac{q^2}{2}\left( f'(\beta-q)-f'(\alpha+q) \right)\\
&amp; + \int_\alpha^{\alpha+q} \frac{(x-\alpha)^2}{2}f''(x)\dee{x} +
\int_{\beta-q}^\beta \frac{(x-\beta)^2}{2}f''(x)\dee{x}\\
\end{align*}
<p class="intertext">Then since \(\alpha+q=\beta-q\) we can combine the integrals on the  left-hand side and eliminate some terms from the right-hand side:</p>
\begin{align*}
\int_\alpha^\beta f(x)\dee{x}
&amp;= 2q f(\alpha+q)
+ \int_\alpha^{\alpha+q} \frac{(x-\alpha)^2}{2}f''(x)\dee{x}
+  \int_{\beta-q}^\beta \frac{(x-\beta)^2}{2}f''(x)\dee{x}
\end{align*}
</div>
<p data-braille="continuation">Rearrange this expression a little and take absolute values</p>
<div class="displaymath">
\begin{align*}
\left| \int_\alpha^\beta f(x)\dee{x} - 2q f(\alpha+q) \right|
&amp;\leq \left| \int_\alpha^{\alpha+q} \frac{(x-\alpha)^2}{2}f''(x)\dee{x} \right|
+ \left|\int_{\beta-q}^\beta \frac{(x-\beta)^2}{2}f''(x)\dee{x}\right|
\end{align*}
</div>
<p data-braille="continuation">where we have also made use of the triangle inequality <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-263" id="fn-263"><sup> 14 </sup></a>. By assumption \(|f''(x)| \leq M\) on the interval \(\alpha \leq x \leq \beta\text{,}\)  so</p>
<div class="displaymath">
\begin{align*}
\left| \int_\alpha^\beta f(x)\dee{x} - 2q f(\alpha+q) \right|
&amp; \leq M \int_\alpha^{\alpha+q} \frac{(x-\alpha)^2}{2} \dee{x}
+ M \int_{\beta-q}^\beta \frac{(x-\beta)^2}{2} \dee{x}\\
&amp;= \frac{Mq^3}{3} = \frac{M(\beta-\alpha)^3}{24}
\end{align*}
</div>
<p data-braille="continuation">where we have used \(q = \frac{\beta-\alpha}{2}\) in the last step.</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-263"><div class="fn">The  triangle inequality says that for any real numbers \(x,y\)<div class="displaymath">
\begin{equation*}
|x+y| \leq |x| + |y|.
\end{equation*}
</div>
</div></div>
<p id="p-7678">Thus on any interval \(x_i \leq x \leq x_{i+1}=x_i+\De x\)</p>
<div class="displaymath">
\begin{align*}
\left| \int_{x_i}^{x_{i+1}} f(x)\dee{x} - \De x f\left(\frac{x_i+x_{i+1}}{2}\right)  \right|
&amp; \leq \frac{M}{24} ( \De x)^3
\end{align*}
</div>
<p id="p-7679">Putting everything together we see that the error using the midpoint rule is bounded by</p>
<div class="displaymath">
\begin{gather*}
\left| \int_a^b f(x) \dee{x} - \left[
f(\bar x_1)+f(\bar x_2)+\cdots +f(\bar x_n)
\right]\De x \right|\\
\leq
\left| \int_{x_0}^{x_1} f(x)\dee{x} - \De x f(\bar x_1) \right|
+\cdots+
\left| \int_{x_{n-1}}^{x_n} f(x)\dee{x} - \De x f(\bar x_n) \right|\\
\leq n \times \frac{M}{24} ( \De x)^3
= n \times \frac{M}{24} \left( \frac{b-a}{n}\right)^3
= \frac{M(b-a)^3}{24 n^2}
\end{gather*}
</div>
<p data-braille="continuation">as required.</p>
<p id="p-7680">A very similar analysis shows that, as was stated in Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a>  above,</p>
<ul class="disc">
<li id="li-2901">the total error introduced by the trapezoidal rule is bounded by \(\ds \frac{M}{12}\frac{(b-a)^3}{n^2}\text{,}\)</li>
<li id="li-2902">the total error introduced by Simpson's rule is bounded by \(\ds \frac{M}{180}\frac{(b-a)^5}{n^4}\)</li>
</ul></section><section class="exercises" id="exercises-55"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber">6.11.6</span> <span class="title">Exercises</span>
</h3>
<section class="introduction" id="introduction-230"><p id="p-7681">Recall that we are using \(\log x\) to denote the logarithm of \(x\) with base \(e\text{.}\) In other courses it is often denoted \(\ln x\text{.}\)</p></section><div class="exercisegroup" id="exercisegroup-146">
<h6 class="heading"><span class="title"></span></h6>
<div class="introduction" id="introduction-231"></div>
<div class="exercisegroup-exercises">
<article class="exercise exercise-like" id="exercise-995"><h6 class="heading"><span class="codenumber">1<span class="period">.</span></span></h6>
<p id="p-7682">Suppose we approximate an object to have volume \(1.5 \mathrm{m}^3\text{,}\) when its exact volume is \(1.387 \mathrm{m}^3\text{.}\) Give the relative error, absolute error, and percent error of our approximation.</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-915" id="hint-915"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-915"><div class="hint solution-like"><p id="p-7683">The absolute error is  the difference of the two values; the relative error is the absolute error divided by the exact value; the percent error is one hundred times the relative error.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-995" id="answer-995"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-995"><div class="answer solution-like"><p id="p-7684">Relative error: \(\approx 0.08147\text{;}\) absolute error: \(0.113\text{;}\) percent error: \(\approx 8.147\%\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-995" id="solution-995"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-995"><div class="solution solution-like">
<p id="p-7685">The absolute error is the difference between the two values:</p>
<div class="displaymath">
\begin{equation*}
|1.387-1.5| = 0.113
\end{equation*}
</div>
<p id="p-7686">The relative error is the absolute error divided by the exact value:</p>
<div class="displaymath">
\begin{equation*}
\frac{0.113}{1.387}\approx 0.08147
\end{equation*}
</div>
<p id="p-7687">The percent error is 100 times the relative error:</p>
<div class="displaymath">
\begin{equation*}
\approx 8.147\%
\end{equation*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-996"><h6 class="heading"><span class="codenumber">2<span class="period">.</span></span></h6>
<p id="p-7688">Consider approximating \(\displaystyle\int_2^{10} f(x) \dee{x}\text{,}\) where \(f(x)\) is the function in the graph below.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:17%;margin-right:17%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-796.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<ol id="p-7689" class="lower-alpha">
<li id="li-2903">Draw the rectangles associated with the midpoint rule approximation and \(n=4\text{.}\)</li>
<li id="li-2904">Draw the trapezoids associated with the trapezoidal rule approximation and \(n=4\text{.}\)</li>
</ol>
<p data-braille="continuation">You don't have to give an approximation.</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-916" id="hint-916"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-916"><div class="hint solution-like"><p id="p-7690">You should have four rectangles in one drawing, and four trapezoids in another.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-996" id="answer-996"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-996"><div class="answer solution-like">
<p id="p-7691">Midpoint rule:</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:17%;margin-right:17%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-797.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7692">Trapezoidal rule:</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:17%;margin-right:17%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-798.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-996" id="solution-996"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-996"><div class="solution solution-like">
<p id="p-7693">Midpoint rule:</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:17%;margin-right:17%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-799.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7694">Trapezoidal rule:</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:17%;margin-right:17%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-800.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-997"><h6 class="heading"><span class="codenumber">3<span class="period">.</span></span></h6>
<p id="p-7695">Let \(f(x) = -\dfrac{1}{12}x^4+\dfrac{7}{6}x^3-3x^2\text{.}\)</p>
<ol class="lower-alpha">
<li id="li-2905">Find a reasonable value \(M\) such that \(|f''(x)| \leq M\) for all \(1 \leq x \leq 6\text{.}\)</li>
<li id="li-2906">Find a reasonable value \(L\) such that \(|f^{(4)}(x)| \leq L\) for all \(1 \leq x \leq 6\text{.}\)</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-917" id="hint-917"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-917"><div class="hint solution-like"><p id="p-7696">Sketch the second derivative--it's quadratic.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-997" id="answer-997"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-997"><div class="answer solution-like"><p id="p-7697">\(M=6.25\text{,}\) \(L=2\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-997" id="solution-997"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-997"><div class="solution solution-like"><ol id="p-7698" class="lower-alpha">
<li id="li-2907">
<p id="p-7699">Differentiating, we find \(f''(x) = -x^2+7x-6\text{.}\) Since \(f''(x)\) is quadratic, we have a pretty good idea of what it looks like.</p>
<ul class="disc">
<li id="li-2908">It factors as \(f(x)  = -(x-6)(x-1)\text{,}\) so its two roots are at \(x=6\) and \(x=1\text{.}\)</li>
<li id="li-2909">The “flat part” of the parabola is at \(x=3.5\) (since this is exactly half way  between \(x=1\) and \(x=6\text{;}\) alternately, we can check that \(f'''(3.5)=0\)).</li>
<li id="li-2910">Since the coefficient of \(x^2\) is negative, \(f(x)\) is increasing from \(-\infty\) to \(3.5\text{,}\) then decreasing from \(3.5\) to \(\infty\text{.}\)</li>
</ul>
<p data-braille="continuation">Therefore, over the interval \([1,6]\text{,}\) the largest positive value of \(f''(x)\) occurs when \(x=3.5\text{,}\) and this is \(f''(3.5) = -(3.5-6)(3.5-1)=6.25\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:25%;margin-right:25%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-801.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7700">So, we take \(M=6.25\text{.}\)</p>
</li>
<li id="li-2911">We differentiate further to find \(f^{(4)}(x)=-2\text{.}\) This is constant everywhere, so we take \(L=|-2|=2\text{.}\)</li>
</ol></div></div>
</div></article><article class="exercise exercise-like" id="prob_s1_11_approxM"><h6 class="heading"><span class="codenumber">4<span class="period">.</span></span></h6>
<p id="p-7701">Let \(f(x) = x\sin x+2\cos x\text{.}\) Find a reasonable value \(M\) such that \(|f''(x)| \leq M\) for all \(-3 \leq x \leq 2\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-918" id="hint-918"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-918"><div class="hint solution-like"><p id="p-7702">You don't have to find the actual, exact maximum the second derivative achieves--you only have to give a reasonable “ceiling” that it never breaks through.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-998" id="answer-998"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-998"><div class="answer solution-like"><p id="p-7703">One reasonable answer is \(M=3\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-998" id="solution-998"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-998"><div class="solution solution-like">
<p id="p-7704">Let's start by differentiating.</p>
<div class="displaymath">
\begin{align*}
f(x)&amp;=x\sin x +2\cos x\\
f'(x)&amp;=x\cos x + \sin x - 2\sin x =x\cos x - \sin x\\
f''(x)&amp;=-x\sin x + \cos x -\cos x = -x\sin x
\end{align*}
</div>
<p data-braille="continuation">For any value of \(x\text{,}\) \(|\sin x| \leq 1\text{.}\) When \(-3 \leq x \leq 2\text{,}\) then \(|x| \leq 3\text{.}\) So, it is true (and not unreasonably sloppy) that</p>
<div class="displaymath">
\begin{equation*}
f''(x) \leq 3
\end{equation*}
</div>
<p id="p-7705">whenever \(x\) is in the interval \([-3,2]\text{.}\) So, we can take \(M=3\text{.}\)</p>
<p id="p-7706">Note that \(|f''(x)|\) is actually <em class="emphasis">smaller</em> than 3 whenever \(x\) is in the interval \([-3,2]\text{,}\) because when \(x=-3\text{,}\) \(\sin x \neq 1\text{.}\) In fact, since 3 is pretty close to \(\pi\text{,}\) \(\sin 3\) is pretty small. (The actual maximum value of \(|f''(x)|\) when \(-3\leq x\leq 2\) is about 1.8.) However, we find  parameters like \(M\) for the purpose of computing error bounds. There is often not much to be gained from taking the time to find the actual maximum of a function, so we content ourselves with reasonable upper bounds. Question <a class="xref" data-knowl="./knowl/prob_s1_11_exactM.html" title="Exercise 6.11.6.31">31</a> has a further investigation of “sloppy” bounds like this.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="prob_s1_11_approxerror1"><h6 class="heading"><span class="codenumber">5<span class="period">.</span></span></h6>
<p id="p-7707">Consider the quantity \(A=\displaystyle\int_{-\pi}^{\pi} \cos x \dee{x}\text{.}\)</p>
<ol class="lower-alpha">
<li id="li-2912">Find the upper bound on the error using Simpson's rule with \(n=4\) to approximate \(A\) using Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a> in the text.</li>
<li id="li-2913">Find the Simpson's rule approximation of \(A\) using \(n=4\text{.}\)</li>
<li id="li-2914">What is the (actual) absolute error in the Simpson's rule approximation of \(A\) with \(n=4\text{?}\)</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-919" id="hint-919"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-919"><div class="hint solution-like">
<p id="p-7708">To compute the upper bound on the error, find an upper bound on the fourth derivative of cosine, then use Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a> in the text.</p>
<p id="p-7709">To find the actual error, you need to find the actual value of \(A\text{.}\)</p>
</div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-999" id="answer-999"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-999"><div class="answer solution-like">
<p id="p-7710">(a) \(\dfrac{\pi^5}{180\cdot8}\)</p>
<p id="p-7711">(b) \(0\)</p>
<p id="p-7712">(c) \(0\)</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-999" id="solution-999"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-999"><div class="solution solution-like">
<ol id="p-7713" class="lower-alpha">
<li id="li-2915">
<p id="p-7714">Let \(f(x) = \cos x\text{.}\) Then \(f^{(4)}(x)=\cos x\text{,}\) so \(|f^{(4)}(x)| \leq 1\) when \(-\pi \leq x \leq \pi\text{.}\) So, using \(L=1\text{,}\) we find the upper bound of the error using Simpson's rule with \(n=4\) is:</p>
<div class="displaymath">
\begin{equation*}
\frac{L(b-a)^5}{180 n^4} = \frac{(2\pi)^5}{180\cdot 4^4} = \frac{\pi^5}{180\cdot8}\approx 0.2
\end{equation*}
</div>
<p id="p-7715">The error bound comes from Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a> in the text. We used a calculator to find the approximate decimal value.</p>
</li>
<li id="li-2916">We use the general form of Simpson's rule (Equation <a class="xref" data-knowl="./knowl/eq_SIMPrule.html" title="Equation 6.11.9: Simpson's rule">6.11.9</a> in the text) with \(\Delta x = \frac{b-a}{n}=\frac{2\pi}{4} = \frac{\pi}{2}\text{.}\)<div class="displaymath">
\begin{align*}
A&amp; \approx \frac{\Delta x}{3}\left(f(x_0) + 4f(x_1)+2f(x_2)+4f(x_3)+f(x_4)\right)\\
&amp;=\frac{\pi/2}{3}\left(f(-\pi) + 4f(\tfrac{-\pi}{2})+2f(0)+4f(\tfrac{\pi}{2})+f(\pi)\right)\\
&amp;= \frac{\pi}{6}\left(-1 + 4(0)+2(1)+4(0)-1\right)=0
\end{align*}
</div>
</li>
<li id="li-2917">To find the actual error in our approximation, we compare the approximation from (b) to the exact value of \(A\text{.}\) In fact, \(A=0\text{:}\) this is a fact you've probably seen before by considering the symmetry of cosine, but it's easy enough to calculate:<div class="displaymath">
\begin{equation*}
A = \int_{-\pi}^{\pi} \cos x \dee{x}= \sin \pi - \sin (-\pi) = 0
\end{equation*}
</div>So, our approximation was exactly the same as our exact value. The absolute error is 0.</li>
</ol>
<p data-braille="continuation">Remark: the purpose of this question was to remind you that the error bounds we calculate are not (usually) the same as the actual error. Often our approximations are better than we give them credit for. In normal circumstances, we would be approximating an integral precisely to avoid evaluating it exactly, so we wouldn't find our exact error. The bound is a quick way of ensuring that our approximation is not <em class="emphasis">too</em> far off.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1000"><h6 class="heading"><span class="codenumber">6<span class="period">.</span></span></h6>
<p id="p-7716">Give a function \(f(x)\) such that:</p>
<ul class="disc">
<li id="li-2918">\(f''(x) \leq 3\) for every \(x\) in \([0,1]\text{,}\) and</li>
<li id="li-2919">the error using the trapezoidal rule approximating \(\displaystyle\int_0^1 f(x) \dee{x}\) with \(n=2\) intervals is exactly \(\dfrac{1}{16}\text{.}\)</li>
</ul>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-920" id="hint-920"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-920"><div class="hint solution-like"><p id="p-7717">Find a function with \(f''(x)=3\) for all \(x\) in \([0,1]\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1000" id="answer-1000"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1000"><div class="answer solution-like"><p id="p-7718">Possible answers: \(f(x) = \dfrac{3}{2}x^2+Cx+D\) for any constants \(C\text{,}\) \(D\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1000" id="solution-1000"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1000"><div class="solution solution-like">
<p id="p-7719">Using Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a> in the text, the error using the trapezoidal rule as described is <em class="emphasis">at most</em></p>
<div class="displaymath">
\begin{equation*}
\dfrac{M(b-a)^3}{12\cdot n^2} = \dfrac{M}{48} \leq \frac{3}{48}=\frac{1}{16}.
\end{equation*}
</div>
<p data-braille="continuation">So, we're really being asked to find a function with the maximum possible error using the trapezoidal rule, given its second derivative.</p>
<p id="p-7720">With that in mind, our function should have the largest second derivative possible: let's set \(f''(x)=3\) for every \(x\text{.}\) Then:</p>
<div class="displaymath">
\begin{align*}
&amp;&amp;f''(x)&amp;=3\\
&amp;&amp;f'(x)&amp;=3x+C\\
&amp;&amp;f(x)&amp;=\frac{3}{2}x^2+Cx+D\\
\end{align*}
<p class="intertext">for some constants \(C\) and \(D\text{.}\) Now we can find the exact and approximate values of \(\displaystyle\int_0^1 f(x) \dee{x}\text{.}\)</p>
\begin{align*}
&amp;\mbox{Exact:}&amp;\int_0^1 f(x) \dee{x}&amp;=\int_0^1 \left(\frac{3}{2}x^2+Cx+D\right) \dee{x}\\
&amp;&amp;&amp;=\left[\frac{1}{2}x^3+\frac{C}{2}x^2+Dx\right]_0^1\\
&amp;&amp;&amp;=\textcolor{blue}{\frac{1}{2}+\frac{C}{2}+D}\\
&amp;\mbox{Approximate:}&amp;\int_0^1 f(x) \dee{x}&amp;\approx \Delta x \left[\frac{1}{2}f(0)+f(\tfrac{1}{2})+\frac{1}{2}f(1)\right]\\
&amp;&amp;&amp;=\frac{1}{2}\bigg[\frac{1}{2}(D)+\left(\frac{3}{8}+\frac{C}{2}+D\right)\\
&amp;&amp;&amp;\hskip1.0in+\frac{1}{2}\left(\frac{3}{2}+C+D\right)\bigg]\\
&amp;&amp;&amp;=\frac{1}{2}\left[\frac{9}{8}+C+2D\right]\\
&amp;&amp;&amp;=\textcolor{red}{\frac{9}{16}+\frac{C}{2}+D}
\end{align*}
</div>
<p data-braille="continuation">So, the absolute error associated with the trapezoidal approximation is:</p>
<div class="displaymath">
\begin{equation*}
\left|\left(\textcolor{blue}{\frac{1}{2}+\frac{C}{2}+D}\right)  - \left(\textcolor{red}{\frac{9}{16}+\frac{C}{2}+D}\right) \right| = \frac{1}{16}
\end{equation*}
</div>
<p id="p-7721">So, for any constants \(C\) and \(D\text{,}\) \(f(x) = \frac{3}{2}x^2+Cx+D\) has the desired error.</p>
<p id="p-7722">Remark: contrast this question with Question <a class="xref" data-knowl="./knowl/prob_s1_11_approxerror1.html" title="Exercise 6.11.6.5">5</a>. In this problem, our absolute error was exactly as bad as the bound predicted, but sometimes it is much  better. The thing to remember is that, in general, we <em class="emphasis">don't know</em> our  absolute error. We only guarantee that it's not any worse than some worst-case-scenario bound.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="prob_s1_11_mom"><h6 class="heading"><span class="codenumber">7<span class="period">.</span></span></h6>
<p id="p-7723">Suppose my mother is under 100 years old, and I am under 200 years old. <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-264" id="fn-264"><sup> 15 </sup></a> Who is older?</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-264"><div class="fn">We're going somewhere with this.</div></div>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-921" id="hint-921"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-921"><div class="hint solution-like"><p id="p-7724">You're allowed to use common sense for this one.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1001" id="answer-1001"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1001"><div class="answer solution-like"><p id="p-7725">my mother</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1001" id="solution-1001"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1001"><div class="solution solution-like">
<p id="p-7726">Under any reasonable assumptions <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-265" id="fn-265"><sup> 16 </sup></a> , my mother is older than I am.</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-265"><div class="fn">Anyone caught trying to come up with a scenario in which I am older than my mother will be sent to maximum security grad school.</div></div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1002"><h6 class="heading"><span class="codenumber">8<span class="period">.</span></span></h6>
<ol id="p-7727" class="lower-alpha">
<li id="li-2920">True or False: for fixed positive constants \(M\text{,}\) \(n\text{,}\) \(a\text{,}\) and \(b\text{,}\) with \(b \gt a\text{,}\)<div class="displaymath">
\begin{equation*}
\dfrac{M}{24}\dfrac{(b-a)^3}{n^2}\leq \dfrac{M}{12}\dfrac{(b-a)^3}{n^2}
\end{equation*}
</div>
</li>
<li id="li-2921">True or False: for a function \(f(x)\) and fixed constants \(n\text{,}\) \(a\text{,}\) and \(b\text{,}\) with \(b \gt a\text{,}\) the \(n\)-interval midpoint approximation of \(\displaystyle\int_a^b f(x) \dee{x}\) is more accurate than the \(n\)-interval trapezoidal approximation.</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-922" id="hint-922"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-922"><div class="hint solution-like"><p id="p-7728">For part (b), consider Question <a class="xref" data-knowl="./knowl/prob_s1_11_mom.html" title="Exercise 6.11.6.7">7</a>.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1002" id="answer-1002"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1002"><div class="answer solution-like">
<p id="p-7729">(a) true</p>
<p id="p-7730">(b) false</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1002" id="solution-1002"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1002"><div class="solution solution-like">
<p id="p-7731">(a) Since both expressions are positive, and \(\frac{1}{24} \leq \frac{1}{12}\text{,}\) the inequality is true.</p>
<p id="p-7732">(b) False. The reasoning is the same as in Question <a class="xref" data-knowl="./knowl/prob_s1_11_mom.html" title="Exercise 6.11.6.7">7</a>. The <em class="emphasis">error bound</em> given by Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a> is always better for the trapezoid rule, but this doesn't necessarily mean the <em class="emphasis">error</em> is better.</p>
<p id="p-7733">To see how the trapezoid approximation could be better than the corresponding midpoint approximation in some cases, consider the function \(f(x)\) sketched below.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:30%;margin-right:30%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-802.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7734">The trapezoidal approximation of \(\displaystyle\int_a^b f(x) \dee{x}\) with \(n=1\) misses the thin spike, and gives a mild underapproximation. By contrast, the midpoint approximation with \(n=1\) takes the spike as the height of the entire region, giving a vast overapproximation.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;">
<div class="sbspanel" style="width:44.4444444444444%;justify-content:flex-start;"><img src="images/image-803.svg" role="img" style="width: 100%; height: auto;" alt=""></div>
<div class="sbspanel" style="width:44.4444444444444%;justify-content:flex-start;"><img src="images/image-804.svg" role="img" style="width: 100%; height: auto;" alt=""></div>
</div></div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1003"><h6 class="heading">
<span class="codenumber">9<span class="period">.</span></span><span class="space"> </span><span class="title">2015A.</span>
</h6>
<p id="p-7735">Decide whether the following statement is true or false. If false, provide a counterexample. If true, provide a brief justification.</p>
<blockquote class="blockquote" id="blockquote-53"><p id="p-7736">When \(f(x)\) is positive and concave up, any trapezoidal rule approximation for \(\displaystyle\int_{a}^{b} f(x) \,\dee{x}\) will be an upper estimate for \(\displaystyle\int_{a}^{b} f(x) \,\dee{x}\text{.}\)</p></blockquote>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-923" id="hint-923"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-923"><div class="hint solution-like"><p id="p-7737">Draw a sketch.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1003" id="answer-1003"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1003"><div class="answer solution-like">
<p id="p-7738">True. Because \(f(x)\) is positive and concave up, the graph of \(f(x)\) is always below the top edges of the trapezoids used in the trapezoidal rule.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:17%;margin-right:17%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-805.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1003" id="solution-1003"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1003"><div class="solution solution-like">
<p id="p-7739">True. Because \(f(x)\) is positive and concave up, the graph of \(f(x)\) is always below the top edges of the trapezoids used in the trapezoidal rule.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:17%;margin-right:17%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-806.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1004"><h6 class="heading"><span class="codenumber">10<span class="period">.</span></span></h6>
<p id="p-7740">Give a polynomial \(f(x)\) with the property that the Simpson's rule approximation of \(\displaystyle\int_a^b f(x) \dee{x}\) is exact for all \(a\text{,}\) \(b\text{,}\) and \(n\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-924" id="hint-924"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-924"><div class="hint solution-like"><p id="p-7741">The error bound for the approximation is given in Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a> in the text. You want this bound to be zero.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1004" id="answer-1004"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1004"><div class="answer solution-like"><p id="p-7742">Any polynomial of degree at most 3 will do. For example, \(f(x)=5x^3-27\text{,}\) or \(f(x)=x^2\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1004" id="solution-1004"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1004"><div class="solution solution-like">
<p id="p-7743">According to Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a>  in the text, the error associated with the Simpson's rule approximation is no more than \(\dfrac{L}{180}\dfrac{(b-a)^5}{n^4}\text{,}\) where \(L\) is a constant such that \(|f^{(4)}(x)| \leq L\) for all \(x\) in \([a,b]\text{.}\) If \(L=0\text{,}\) then the error is no more than 0 regardless of \(a\text{,}\) \(b\text{,}\) or \(n\)--that is, the approximation is exact.</p>
<p id="p-7744">Any polynomial \(f(x)\) of degree at most 3 has \(f^{(4)}(x)=0\) for all \(x\text{.}\) So, any polynomial of degree at most 3 is an acceptable answer. For example, \(f(x)=5x^3-27\text{,}\) or \(f(x)=x^2\text{.}\)</p>
</div></div>
</div></article>
</div>
</div>
<div class="exercisegroup" id="exercisegroup-147">
<h6 class="heading"><span class="title"></span></h6>
<div class="introduction" id="introduction-232"></div>
<div class="introduction" id="introduction-233"><p id="p-7745">Questions <a class="xref" data-knowl="./knowl/prob_s1_11_int1.html" title="Exercise 6.11.6.11">11</a> and <a class="xref" data-knowl="./knowl/prob_s1_11_int2.html" title="Exercise 6.11.6.12: M121 2012A">12</a> ask you to approximate a given integral  using the formulas in Equations <a class="xref" data-knowl="./knowl/eq_MPrule.html" title="Equation 6.11.2: The midpoint rule">6.11.2</a>, <a class="xref" data-knowl="./knowl/eq_TRPrule.html" title="Equation 6.11.6: The trapezoidal rule">6.11.6</a>, and <a class="xref" data-knowl="./knowl/eq_SIMPrule.html" title="Equation 6.11.9: Simpson's rule">6.11.9</a> in the text.</p></div>
<div class="introduction" id="introduction-234"><p id="p-7759">Questions <a class="xref" data-knowl="./knowl/prob_s1_11_tableproblem1.html" title="Exercise 6.11.6.13: 1997D">13</a> though <a class="xref" data-knowl="./knowl/prob_s1_11_tableproblem3.html" title="Exercise 6.11.6.17: 2013A">17</a>  ask you to approximate a quantity based on observed data.</p></div>
<div class="introduction" id="introduction-235"><p id="p-7794">In Questions <a class="xref" data-knowl="./knowl/prob_s_1_11_error1.html" title="Exercise 6.11.6.18: 2016Q4">18</a> through <a class="xref" data-knowl="./knowl/prob_s_1_11_error2.html" title="Exercise 6.11.6.24: M121 2000A">24</a>, we practice finding error bounds for our approximations.</p></div>
<div class="exercisegroup-exercises">
<article class="exercise exercise-like" id="prob_s1_11_int1"><h6 class="heading"><span class="codenumber">11<span class="period">.</span></span></h6>
<p id="p-7746">Write out all three approximations of \(\displaystyle\int_0^{30} \frac{1}{x^3+1} \dee{x}\) with \(n=6\text{.}\) (That is: midpoint, trapezoidal, and Simpson's.) You do not need to simplify your answers.</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-925" id="hint-925"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-925"><div class="hint solution-like"><p id="p-7747">Follow the formulas in Equations <a class="xref" data-knowl="./knowl/eq_MPrule.html" title="Equation 6.11.2: The midpoint rule">6.11.2</a>, <a class="xref" data-knowl="./knowl/eq_TRPrule.html" title="Equation 6.11.6: The trapezoidal rule">6.11.6</a>, and <a class="xref" data-knowl="./knowl/eq_SIMPrule.html" title="Equation 6.11.9: Simpson's rule">6.11.9</a> in the text.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1005" id="answer-1005"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1005"><div class="answer solution-like">
<p id="p-7748">Midpoint:</p>
<div class="displaymath">
\begin{align*}
\int_0^{30} \frac{1}{x^3+1}\,\dee{x}
&amp;\approx\bigg[\tfrac{1}{\left(2.5\right)^3+1}
+\frac{1}{\left(7.5\right)^3+1}
+\frac{1}{\left(12.5\right)^3+1}
+\frac{1}{\left(17.5\right)^3+1}\\
&amp;\hskip2in
+\frac{1}{\left(22.5\right)^3+1}
+\tfrac{1}{\left(27.5\right)^3+1}
\bigg]5
\end{align*}
</div>
<p id="p-7749">Trapezoidal:</p>
<div class="displaymath">
\begin{align*}
\int_0^{30} \frac{1}{x^3+1}\,\dee{x}
&amp;\approx\bigg[
\frac{1/2}{0^3+1}+
\frac{1}{5^3+1}+
\frac{1}{10^3+1}+
\frac{1}{15^3+1}+
\frac{1}{20^3+1}\\
&amp;\hskip2in
+\frac{1}{25^3+1}+
\frac{1/2}{30^3+1}
\bigg]5
\end{align*}
</div>
<p id="p-7750">Simpson's:</p>
<div class="displaymath">
\begin{align*}
\int_0^{30} \frac{1}{x^3+1}\,\dee{x}
&amp;\approx
\bigg[\frac{1}{{0}^3+1}\!+\frac{4}{{5}^3+1}\!+\frac{2}{{10}^3+1}\!+\frac{4}{{15}^3+1}\!+\frac{2}{{20}^3+1}\!\\
&amp;\hskip2in+\frac{4}{{25}^3+1}\!+ \frac{1}{{30}^3+1}\bigg]\frac{5}{3}
\end{align*}
</div>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1005" id="solution-1005"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1005"><div class="solution solution-like"><ul id="p-7751" class="disc">
<li id="li-2922">For all three approximations, \(\Delta x = \dfrac{b-a}{n}=\dfrac{30-0}{6}=5\text{.}\)</li>
<li id="li-2923">
<p id="p-7752">For the trapezoidal rule and Simpson's rule, the \(x\)-values where we evaluate \(\dfrac{1}{x^3+1}\) start at \(x=a=0\) and move up by \(\Delta x = 5\text{:}\)  \(x_0=0\text{,}\) \(x_1=5\text{,}\) \(x_2=10\text{,}\) \(x_3=15\text{,}\) \(x_4=20\text{,}\) \(x_5=25\text{,}\) and \(x_6=30\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-807.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
</li>
<li id="li-2924">
<p id="p-7753">For the midpoint rule, the \(x\)-values where we evaluate \(\dfrac{1}{x^3+1}\) start at \(x=2.5 = \frac{x_0+x_1}{2}\) and move up by \(\Delta x = 5\text{:}\)  \(\bar x_1=2.5\text{,}\) \(\bar x_2=7.5\text{,}\) \(\bar x_3=12.5\text{,}\) \(\bar x_4=17.5\text{,}\) \(\bar x_5=22.5\text{,}\) and \(\bar x_6=27.5\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-808.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
</li>
<li id="li-2925">Following Equation <a class="xref" data-knowl="./knowl/eq_MPrule.html" title="Equation 6.11.2: The midpoint rule">6.11.2</a>, the midpoint rule approximation is:<div class="displaymath">
\begin{align*}
&amp;\int_0^{30} \frac{1}{x^3+1}\,\dee{x}\approx\Big[f(\bar x_1)+f(\bar x_2)+\cdots
+f(\bar x_n)\Big]\De x\\
&amp;=\bigg[\tfrac{1}{\left(2.5\right)^3+1}
+\frac{1}{\left(7.5\right)^3+1}
+\frac{1}{\left(12.5\right)^3+1}
+\frac{1}{\left(17.5\right)^3+1}\\
&amp;\hskip2.25in
+\frac{1}{\left(22.5\right)^3+1}
+\frac{1}{\left(27.5\right)^3+1}
\bigg]5
\end{align*}
</div>
</li>
<li id="li-2926">Following Equation <a class="xref" data-knowl="./knowl/eq_TRPrule.html" title="Equation 6.11.6: The trapezoidal rule">6.11.6</a>, the trapezoidal rule approximation is:<div class="displaymath">
\begin{align*}
&amp;\int_0^{30} \frac{1}{x^3+1}\,\dee{x}\\
&amp;\approx\Big[\half f(x_0)+f(x_1)+f(x_2)+\cdots+ f(x_{n-1})+\half f(x_n)\Big]\De x\\
&amp;=\bigg[
\frac{1/2}{0^3+1}+
\frac{1}{5^3+1}+
\frac{1}{10^3+1}+
\frac{1}{15^3+1}+
\frac{1}{20^3+1}\\
&amp;\hskip2.5in
+\frac{1}{25^3+1}+
\frac{1/2}{30^3+1}
\bigg]5
\end{align*}
</div>
</li>
<li id="li-2927">Following Equation <a class="xref" data-knowl="./knowl/eq_SIMPrule.html" title="Equation 6.11.9: Simpson's rule">6.11.9</a>, the Simpson's rule approximation is:<div class="displaymath">
\begin{align*}
&amp;\int_0^{30} \frac{1}{x^3+1}\,\dee{x}\\
&amp;\approx\Big[f(x_0)\!+\!4f(x_1)\!+\!2f(x_2)\!+\!4f(x_3)\!+\!2f(x_4)\!+\!4f(x_{5})\!+\!f(x_6)\Big]\frac{\De x}{3}\\
&amp;=\bigg[\frac{1}{{0}^3+1}\!+\frac{4}{{5}^3+1}\!+\frac{2}{{10}^3+1}\!+\frac{4}{{15}^3+1}\!+\frac{2}{{20}^3+1}\\
&amp;\hskip2.5in+\frac{4}{{25}^3+1}\!+ \frac{1}{{30}^3+1}\bigg]\frac{5}{3}
\end{align*}
</div>
</li>
</ul></div></div>
</div></article><article class="exercise exercise-like" id="prob_s1_11_int2"><h6 class="heading">
<span class="codenumber">12<span class="period">.</span></span><span class="space"> </span><span class="title">M121 2012A.</span>
</h6>
<p id="p-7754">Find the midpoint rule approximation to \(\displaystyle\int_0^\pi \sin x\dee{x}\) with \(n = 3\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-926" id="hint-926"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-926"><div class="hint solution-like"><p id="p-7755">See Section <a href="sec_numeric_int.html#sec_midpointRule" class="internal" title="Subsection 6.11.1: The midpoint rule">6.11.1</a>. You should be able to simplify your answer to an exact value (in terms of \(\pi\)).</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1006" id="answer-1006"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1006"><div class="answer solution-like"><p id="p-7756">\(\dfrac{2\pi}{3}\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1006" id="solution-1006"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1006"><div class="solution solution-like">
<p id="p-7757">By Equation <a class="xref" data-knowl="./knowl/eq_MPrule.html" title="Equation 6.11.2: The midpoint rule">6.11.2</a>, the midpoint rule approximation to \(\int_a^b f(x)\dee{x}\) with \(n=3\) is</p>
<div class="displaymath">
\begin{gather*}
\int_a^b f(x)\,\dee{x}\approx\big[f(\bar x_1)+f(\bar x_2)+f(\bar x_3)\big]\De x
\end{gather*}
</div>
<p data-braille="continuation">where \(\De x = \tfrac{b-a}{3}\) and</p>
<div class="displaymath">
\begin{align*}
x_0&amp;=a&amp;\quad
x_1&amp;=a+\De x&amp;\quad
x_2&amp;=a+2\De x&amp;\quad
x_3&amp;=b\\
&amp; &amp;
\bar x_1&amp;=\tfrac{x_0+x_1}{2}&amp;
\bar x_2&amp;=\tfrac{x_1+x_2}{2}&amp;
\bar x_3&amp;=\tfrac{x_2+x_3}{2}
\end{align*}
</div>
<p data-braille="continuation">For this problem, \(a=0\text{,}\) \(b=\pi\) and \(f(x) = \sin x\text{,}\) so that \(\De x = \tfrac{\pi}{3}\)  and</p>
<div class="displaymath">
\begin{align*}
x_0&amp;=0&amp;\quad
x_1&amp;=\tfrac{\pi}{3}&amp;\quad
x_2&amp;=\tfrac{2\pi}{3}&amp;\quad
x_3&amp;=\pi\\
&amp; &amp;
\bar x_1&amp;=\tfrac{\pi}{6}&amp;
\bar x_2&amp;=\tfrac{\pi}{2}&amp;
\bar x_3&amp;=\tfrac{5\pi}{6}
\end{align*}
</div>
<div class="sidebyside"><div class="sbsrow" style="margin-left:12.5%;margin-right:12.5%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-809.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7758">Therefore,</p>
<div class="displaymath">
\begin{align*}
\int_0^\pi \sin x\dee{x}
&amp;\approx\left[\sin\frac{\pi}{6}
+\sin \frac{\pi}{2}
+\sin \frac{5\pi}{6}\right]\frac{\pi}{3}
=\left[\frac{1}{2}
+1
+\frac{1}{2}\right]\frac{\pi}{3}
=\frac{2\pi}{3}
\end{align*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="prob_s1_11_tableproblem1"><h6 class="heading">
<span class="codenumber">13<span class="period">.</span></span><span class="space"> </span><span class="title">1997D.</span>
</h6>
<p id="p-7760">The solid \(V\) is 40 cm high and the horizontal cross sections are circular disks. The table below gives the diameters of the cross sections in centimeters at 10 cm intervals. Use the trapezoidal rule to estimate the volume of \(V\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b1 r1 l1 t1 lines">height</td>
<td class="l m b1 r1 l0 t1 lines">0</td>
<td class="l m b1 r1 l0 t1 lines">10</td>
<td class="l m b1 r1 l0 t1 lines">20</td>
<td class="l m b1 r1 l0 t1 lines">30</td>
<td class="l m b1 r1 l0 t1 lines" data-braille="last-cell">40</td>
</tr>
<tr>
<td class="l m b1 r1 l1 t0 lines">diameter</td>
<td class="l m b1 r1 l0 t0 lines">24</td>
<td class="l m b1 r1 l0 t0 lines">16</td>
<td class="l m b1 r1 l0 t0 lines">10</td>
<td class="l m b1 r1 l0 t0 lines">6</td>
<td class="l m b1 r1 l0 t0 lines" data-braille="last-cell">4</td>
</tr>
</table></div></div></div>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-927" id="hint-927"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-927"><div class="hint solution-like"><p id="p-7761">See Section <a href="sec_numeric_int.html#sec_trapRule" class="internal" title="Subsection 6.11.2: The trapezoidal rule">6.11.2</a>. To set up the volume integral, see Example <a class="xref" data-knowl="./knowl/eg_VOLb.html" title="Example 6.6.6: Pyramid">6.6.6</a>. Note the dimensions given for the cross sections are diameters, not radii.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1007" id="answer-1007"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1007"><div class="answer solution-like"><p id="p-7762">\(1720\pi\approx 5403.5\ {\rm cm}^3\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1007" id="solution-1007"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1007"><div class="solution solution-like">
<p id="p-7763">Let \(f(x)\) denote the diameter at height \(x\text{.}\) As in Example <a class="xref" data-knowl="./knowl/eg_VOLb.html" title="Example 6.6.6: Pyramid">6.6.6</a>, we slice \(V\)  into thin horizontal “pancakes”, which in this case are circular.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:17%;margin-right:17%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-810.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<ul id="p-7764" class="disc">
<li id="li-2928">We are told that the pancake at height \(x\) is a circular disk of diameter \(f(x)\) and so</li>
<li id="li-2929">has cross-sectional area \(\pi\big(\frac{f(x)}{2}\big)^2\) and thickness \(\dee{x}\) and hence</li>
<li id="li-2930">has volume \(\pi\big(\frac{f(x)}{2}\big)^2\dee{x}\text{.}\)</li>
</ul>
<p id="p-7765">Hence the volume of \(V\) is</p>
<div class="displaymath">
\begin{align*}
&amp;\int_0^{40}\pi{\Big[\frac{f(x)}{2}\Big]}^2\,\dee{x}\\
&amp;\hskip0.5in\approx \frac{\pi}{4}10\Big[\half f(0)^2+f(10)^2+f(20)^2+f(30)^2+\half
f(40)^2\Big]\\
&amp;\hskip0.5in=\frac{\pi}{4}10\Big[\half 24^2+16^2+10^2+6^2+\half 4^2\Big]\\
&amp;\hskip0.5in=688\times 2.5\pi
=1720\pi\approx 5403.5
\end{align*}
</div>
<p data-braille="continuation">where we have approximated the integral using the trapezoidal rule with \(\De
x=10\text{,}\) and used a calculator to get a decimal approximation.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="prob_s1_11tableproblem2"><h6 class="heading">
<span class="codenumber">14<span class="period">.</span></span><span class="space"> </span><span class="title">1996D.</span>
</h6>
<p id="p-7766">A \(6\) metre long cedar log has cross sections that are approximately circular. The diameters of the log, measured at one metre intervals, are given below:</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b1 r1 l1 t1 lines">metres from left end of log</td>
<td class="l m b1 r1 l0 t1 lines">0</td>
<td class="l m b1 r1 l0 t1 lines">1</td>
<td class="l m b1 r1 l0 t1 lines">2</td>
<td class="l m b1 r1 l0 t1 lines">3</td>
<td class="l m b1 r1 l0 t1 lines">4</td>
<td class="l m b1 r1 l0 t1 lines">5</td>
<td class="l m b1 r1 l0 t1 lines" data-braille="last-cell">6</td>
</tr>
<tr>
<td class="l m b1 r1 l1 t0 lines">diameter in metres</td>
<td class="l m b1 r1 l0 t0 lines">1.2</td>
<td class="l m b1 r1 l0 t0 lines">1</td>
<td class="l m b1 r1 l0 t0 lines">0.8</td>
<td class="l m b1 r1 l0 t0 lines">0.8</td>
<td class="l m b1 r1 l0 t0 lines">1</td>
<td class="l m b1 r1 l0 t0 lines">1</td>
<td class="l m b1 r1 l0 t0 lines" data-braille="last-cell">1.2</td>
</tr>
</table></div></div></div>
<p id="p-7767">Use Simpson's Rule to estimate the volume of the log.</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-928" id="hint-928"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-928"><div class="hint solution-like"><p id="p-7768">See Section <a href="sec_numeric_int.html#sec_Simpson" class="internal" title="Subsection 6.11.3: Simpson's Rule">6.11.3</a> and compare to Question <a class="xref" data-knowl="./knowl/prob_s1_11_tableproblem1.html" title="Exercise 6.11.6.13: 1997D">6.11.6.13</a>. Note the table gives diameters, not radii.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1008" id="answer-1008"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1008"><div class="answer solution-like"><p id="p-7769">\(\displaystyle\frac{\pi}{12}(16.72)\approx4.377\ {\rm m}^3\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1008" id="solution-1008"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1008"><div class="solution solution-like">
<p id="p-7770">Let \(f(x)\) be the diameter a distance \(x\) from the left end of the log. If we slice our log into thin disks, the disks \(x\) metres from the left end of the log has</p>
<ul class="disc">
<li id="li-2931">radius \(\frac{f(x)}{2}\text{,}\)</li>
<li id="li-2932">width \(\dee{x}\text{,}\) and so</li>
<li id="li-2933">volume \(\pi\left(\frac{f(x)}{2}\right)^2 \dee{x}=\frac{\pi}{4}f(x)^2 \dee{x}\text{.}\)</li>
</ul>
<div class="sidebyside"><div class="sbsrow" style="margin-left:10%;margin-right:10%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-811.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7771">Using Simpson's Rule with \(\De
x=1\text{,}\) the volume of the log is:</p>
<div class="displaymath">
\begin{align*}
&amp;V=\int_0^6 \frac{\pi}{4}f(x)^2\,\dee{x}\\
&amp;\approx\frac{\pi}{4}\frac{1}{3}
\Big[f(0)^2+4f(1)^2+2f(2)^2+4f(3)^2+2f(4)^2+4f(5)^2+f(6)^2\Big]\\
&amp;=\frac{\pi}{12}
\Big[1.2^2+4(1)^2+2(0.8)^2+4(0.8)^2+2(1)^2+4(1)^2+1.2^2\Big]\\
&amp;=\frac{\pi}{12}(16.72)\\
&amp;\approx4.377\ {\rm m}^3
\end{align*}
</div>
<p data-braille="continuation">where we used a calculator to approximate the decimal value.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1009"><h6 class="heading">
<span class="codenumber">15<span class="period">.</span></span><span class="space"> </span><span class="title">1998A.</span>
</h6>
<p id="p-7772">The circumference of an 8 metre high tree at different heights above the ground is given in the table below. Assume that all horizontal cross--sections of the tree are circular disks.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b1 r1 l1 t1 lines">height (metres)</td>
<td class="l m b1 r1 l0 t1 lines">0</td>
<td class="l m b1 r1 l0 t1 lines">2</td>
<td class="l m b1 r1 l0 t1 lines">4</td>
<td class="l m b1 r1 l0 t1 lines">6</td>
<td class="l m b1 r1 l0 t1 lines" data-braille="last-cell">8</td>
</tr>
<tr>
<td class="l m b1 r1 l1 t0 lines">circumference (metres)</td>
<td class="l m b1 r1 l0 t0 lines">1.2</td>
<td class="l m b1 r1 l0 t0 lines">1.1</td>
<td class="l m b1 r1 l0 t0 lines">1.3</td>
<td class="l m b1 r1 l0 t0 lines">0.9</td>
<td class="l m b1 r1 l0 t0 lines" data-braille="last-cell">0.2</td>
</tr>
</table></div></div></div>
<p id="p-7773">Use Simpson's rule to approximate the volume of the tree.</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-929" id="hint-929"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-929"><div class="hint solution-like">
<p id="p-7774">See §<a href="sec_numeric_int.html#sec_Simpson" class="internal" title="Subsection 6.11.3: Simpson's Rule">6.11.3</a>. To set up the volume integral, see Example <a class="xref" data-knowl="./knowl/eg_VOLb.html" title="Example 6.6.6: Pyramid">6.6.6</a>, or Question <a class="xref" data-knowl="./knowl/prob_s1_11tableproblem2.html" title="Exercise 6.11.6.14: 1996D">14</a>.</p>
<p id="p-7775">Note that the table gives the circumference, not radius, of the tree at a given height.</p>
</div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1009" id="answer-1009"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1009"><div class="answer solution-like"><p id="p-7776">\(\dfrac{12.94}{6\pi}
\approx0.6865\ {\rm m}^3\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1009" id="solution-1009"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1009"><div class="solution solution-like">
<p id="p-7777">At height \(x\) metres, let the circumference of the tree be \(c(x)\text{.}\) The corresponding radius is \(\dfrac{c(x)}{2\pi}\text{,}\) so the corresponding cross--sectional area is \(\pi\left(\dfrac{c(x)}{2\pi}\right)^2=\dfrac{c(x)^2}{4\pi}\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:20%;margin-right:20%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-812.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7778">The height of a very thin cross--sectional  disk is \(\dee{x}\text{,}\) so the volume of a cross-sectional disk is \(\dfrac{c(x)^2}{4\pi} \dee{x}\text{.}\) Therefore, total volume of the tree is:</p>
<div class="displaymath">
\begin{align*}
\int_0^8 \frac{c(x)^2}{4\pi}\,\dee{x}
&amp;\approx \frac{1}{4\pi}\frac{2}{3}\Big[c(0)^2+4c(2)^2+2c(4)^2+4c(6)^2+c(8)^2\Big]\cr
&amp;=\frac{1}{6\pi}\Big[1.2^2+4(1.1)^2+2(1.3)^2+4(0.9)^2+0.2^2\Big]\\
&amp;=\frac{12.94}{6\pi}
\approx0.6865
\end{align*}
</div>
<p data-braille="continuation">where we used Simpson's rule with \(\De x = 2\) and \(n=4\) to approximate the value of the integral based on the values of \(c(x)\) given in  the table.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1010"><h6 class="heading">
<span class="codenumber">16<span class="period">.</span></span><span class="space"> </span><span class="title">2001A.</span>
</h6>
<p id="p-7779">By measuring the areas enclosed by contours on a topographic map, a geologist determines the cross sectional areas \(A\) in \(\mathrm{m}^2\) of a \(60\) m high hill. The table below gives the cross sectional area \(A(h)\) at various heights \(h\text{.}\) The volume of the hill is \(V=\int_0^{60} A(h)\,\dee{h}\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b1 r1 l1 t1 lines">\(h\)</td>
<td class="l m b1 r1 l0 t1 lines">0</td>
<td class="l m b1 r1 l0 t1 lines">10</td>
<td class="l m b1 r1 l0 t1 lines">20</td>
<td class="l m b1 r1 l0 t1 lines">30</td>
<td class="l m b1 r1 l0 t1 lines">40</td>
<td class="l m b1 r1 l0 t1 lines">50</td>
<td class="l m b1 r1 l0 t1 lines" data-braille="last-cell">60</td>
</tr>
<tr>
<td class="l m b1 r1 l1 t0 lines">\(A\)</td>
<td class="l m b1 r1 l0 t0 lines">10,200</td>
<td class="l m b1 r1 l0 t0 lines">9,200</td>
<td class="l m b1 r1 l0 t0 lines">8,000</td>
<td class="l m b1 r1 l0 t0 lines">7,100</td>
<td class="l m b1 r1 l0 t0 lines">4,500</td>
<td class="l m b1 r1 l0 t0 lines">2,400</td>
<td class="l m b1 r1 l0 t0 lines" data-braille="last-cell">100</td>
</tr>
</table></div></div></div>
<ol id="p-7780" class="lower-alpha">
<li id="li-2934">If the geologist uses the Trapezoidal Rule to estimate the volume of the hill, what will be their estimate, to the nearest 1,000\(\mathrm{m}^3\text{?}\)</li>
<li id="li-2935">What will be the geologist's estimate of the volume of the hill if they use Simpson's Rule instead of the Trapezoidal Rule?</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1010" id="answer-1010"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1010"><div class="answer solution-like">
<p id="p-7781">(a) 363,500</p>
<p id="p-7782">(b) 367,000</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1010" id="solution-1010"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1010"><div class="solution solution-like">
<p id="p-7783">For both approximations, \(\De x = 10\) and \(n=6\text{.}\)</p>
<p id="p-7784">(a) The Trapezoidal Rule gives</p>
<div class="displaymath">
\begin{align*}
&amp;V=\int_0^{60} A(h)\,\dee{h}\\
&amp;\approx 10\Big[\half A(0)+A(10)+A(20)+A(30)+A(40)+A(50)+\half A(60)\Big]\\
&amp;=\text{363,500}
\end{align*}
</div>
<p id="p-7785">(b) Simpson's Rule gives</p>
<div class="displaymath">
\begin{align*}
&amp;V=\int_0^{60} A(h)\,\dee{h}\\
&amp;\approx \frac{10}{3}\Big[A(0)\!+\!4A(10)\!+\!2A(20)\!+\!4A(30)\!+\!2A(40)\!+\!4A(50)\!+\!A(60)\Big]\\
&amp;=\text{367,000}
\end{align*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="prob_s1_11_tableproblem3"><h6 class="heading">
<span class="codenumber">17<span class="period">.</span></span><span class="space"> </span><span class="title">2013A.</span>
</h6>
<p id="p-7786">The graph below applies to both parts (a) and (b).</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:12.5%;margin-right:12.5%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="problems/figs/OE13A_1.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<ol id="p-7787" class="lower-alpha">
<li id="li-2936">Use the Trapezoidal Rule, with \(n = 4\text{,}\) to estimate the area under the graph between \(x = 2\) and \(x = 6\text{.}\) Simplify your answer completely.</li>
<li id="li-2937">Use Simpson's Rule, with \(n = 4\text{,}\) to estimate the area under the graph between \(x = 2\) and \(x = 6\text{.}\)</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1011" id="answer-1011"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1011"><div class="answer solution-like">
<p id="p-7788">(a) \(\dfrac{49}{2}\)</p>
<p id="p-7789">(b) \(\dfrac{77}{3}\)</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1011" id="solution-1011"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1011"><div class="solution solution-like">
<p id="p-7790">Call the curve in the graph \(y=f(x)\text{.}\) It looks like</p>
<div class="displaymath">
\begin{gather*}
f(2)=3 \qquad
f(3)=8 \qquad
f(4)=7 \qquad
f(5)=6 \qquad
f(6)=4
\end{gather*}
</div>
<p id="p-7791">We're estimating \(\int_2^6 f(x) \dee{x}\) with \(n=4\text{,}\) so \(\De x = \frac{6-2}{4}=1\text{.}\)</p>
<p id="p-7792">(a) The trapezoidal rule gives</p>
<div class="displaymath">
\begin{gather*}
T_4=\left[\frac{3}{2}+ 8+7+ 6+\frac{4}{2}\right]\times 1=\frac{49}{2}
\end{gather*}
</div>
<p id="p-7793">(b) Simpson's rule gives</p>
<div class="displaymath">
\begin{gather*}
S_4=\frac{1}{3}\big[3+4\times 8+2\times 7+4\times 6+4\big]\times 1
=\frac{77}{3}
\end{gather*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="prob_s_1_11_error1"><h6 class="heading">
<span class="codenumber">18<span class="period">.</span></span><span class="space"> </span><span class="title">2016Q4.</span>
</h6>
<p id="p-7795">The integral \(\displaystyle\int_{-1}^{1} \sin(x^2) \, \dee{x}\) is estimated using the Midpoint Rule with \(1000\) intervals.  Show that the absolute error in this approximation is at most \(2\cdot 10^{-6}\text{.}\)</p>
<p id="p-7796">You may use the fact that when approximating \(\int_a^b f(x) \, \dee{x}\) with the Midpoint Rule using \(n\) points, the absolute value of the error is at most \(M(b-a)^3/24n^2\) when \(\left|f''(x)\right|\leq M\) for all \(x\in[a,b]\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-930" id="hint-930"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-930"><div class="hint solution-like"><p id="p-7797">The main step is to find an appropriate value of \(M\text{.}\) It is <em class="emphasis">not necessary</em> to find the smallest possible \(M\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1012" id="answer-1012"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1012"><div class="answer solution-like">
<p id="p-7798">Let \(f(x) = \sin(x^2)\text{.}\)  Then \(f'(x) = 2x \cos(x^2)\) and</p>
<div class="displaymath">
\begin{equation*}
f''(x) = 2\cos(x^2) - 4x^2\sin(x^2).
\end{equation*}
</div>
<p data-braille="continuation">Since \(|x^2|\le1\) when \(|x|\leq 1\text{,}\) and \(\left|\sin\theta\right|\le1\) and \(\left|\cos\theta\right|\leq 1\) for all \(\theta\text{,}\) we have</p>
<div class="displaymath">
\begin{align*}
\left|2\cos(x^2) - 4x^2\sin(x^2)\right|
&amp;\le 2|\cos(x^2)| +  4x^2|\sin(x^2)|\\
&amp;\le 2\times 1 +4\times 1\times 1
= 2+4 = 6
\end{align*}
</div>
<p data-braille="continuation">We can therefore choose \(M=6\text{,}\) and it follows that the error is at most</p>
<div class="displaymath">
\begin{gather*}
\frac{M[b-a]^3}{24n^2}
\le \frac{6\cdot [1-(-1)]^3}{24 \cdot 1000^2}
= \frac{2}{10^6}  = 2\cdot 10^{-6}
\end{gather*}
</div>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1012" id="solution-1012"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1012"><div class="solution solution-like">
<p id="p-7799">Let \(f(x) = \sin(x^2)\text{.}\)  Then \(f'(x) = 2x \cos(x^2)\) and</p>
<div class="displaymath">
\begin{equation*}
f''(x) = 2\cos(x^2) - 4x^2\sin(x^2).
\end{equation*}
</div>
<p data-braille="continuation">Since \(|x^2|\le1\) when \(|x|\leq 1\text{,}\) and \(\left|\sin\theta\right|\le1\) and \(\left|\cos\theta\right|\leq 1\) for all \(\theta\text{,}\) we have</p>
<div class="displaymath">
\begin{align*}
\left|2\cos(x^2) - 4x^2\sin(x^2)\right|
&amp;\le 2|\cos(x^2)| +  4x^2|\sin(x^2)|\\
&amp;\le 2\times 1 +4\times 1\times 1
= 2+4 = 6
\end{align*}
</div>
<p data-braille="continuation">We can therefore choose \(M=6\text{,}\) and it follows that the error is at most</p>
<div class="displaymath">
\begin{gather*}
\frac{M[b-a]^3}{24n^2}
\le \frac{6\cdot [1-(-1)]^3}{24 \cdot 1000^2}
= \frac{2}{10^6}  = 2\cdot 10^{-6}
\end{gather*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1013"><h6 class="heading">
<span class="codenumber">19<span class="period">.</span></span><span class="space"> </span><span class="title">2016Q4.</span>
</h6>
<p id="p-7800">The total error using the midpoint rule with \(n\) subintervals to approximate the integral of \(f(x)\) over \([a,b]\) is bounded by \(\dfrac{M (b-a)^3}{(24n^2)}\text{,}\) if \(|f''(x)| \le M\) for all  \(a \le x \le b\text{.}\)</p>
<p id="p-7801">Using this bound, if the integral \(\displaystyle\int_{-2}^{1} 2x^4 \,\dee{x}\) is approximated using the midpoint rule with \(60\) subintervals, what is the largest possible error between the approximation \(M_{60}\) and the true value of the integral?</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-931" id="hint-931"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-931"><div class="hint solution-like"><p id="p-7802">The main step is to find \(M\text{.}\) This question is unusual in that its wording requires you to find the smallest possible allowed \(M\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1013" id="answer-1013"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1013"><div class="answer solution-like"><p id="p-7803">\(\dfrac{3}{100}\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1013" id="solution-1013"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1013"><div class="solution solution-like">
<p id="p-7804">Setting \(f(x) = 2 x^4\) and \(b-a = 1-(-2)=3\text{,}\) we compute \(f''(x) = 24x^2\text{.}\) The largest value of \(24x^2\) on the interval \([-2,1]\) occurs at \(x=-2\text{,}\) so we can take \(M = 24\cdot(-2)^2=96\text{.}\) Thus the total error for the midpoint rule with \(n=60\) points is bounded by</p>
<div class="displaymath">
\begin{gather*}
\frac{M (b-a)^3}{24n^2}  = \frac{96 \times 3^3}{24 \times 60 \times 60} = \frac{3}{100}
\end{gather*}
</div>
<p id="p-7805">That is: we are guaranteed our absolute error is certainly no more <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-266" id="fn-266"><sup> 17 </sup></a> than \(\frac{3}{100}\text{,}\) and using the bound stated in the problem we cannot give a better guarantee. (The second part of the previous sentence comes from the fact that we used the smallest possible \(M\text{:}\) if we had used a larger value of \(M\text{,}\) we would still have some true statement about the error, for example “the error is no more than \(\frac{5}{100}\text{,}\)” but it would not be the <em class="emphasis">best</em> true statement we could make.)</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-266"><div class="fn">This is what the error bound always tells us.</div></div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1014"><h6 class="heading">
<span class="codenumber">20<span class="period">.</span></span><span class="space"> </span><span class="title">2016A.</span>
</h6>
<p id="p-7806">Both parts of this question concern the integral \(I = \displaystyle\int_{0}^{2} (x-3)^5\,\dee{x}\text{.}\)</p>
<ol class="lower-alpha">
<li id="li-2938">Write down the Simpson's Rule approximation to \(I\) with \(n=6\text{.}\) Leave your answer in calculator-ready form.</li>
<li id="li-2939">Which method of approximating \(I\) results in a smaller error bound: the Midpoint Rule with \(n=100\) intervals, or Simpson's Rule with \(n=10\) intervals?  You may use the formulas<div class="displaymath">
\begin{gather*}
|E_M| \le \frac{M(b-a)^3}{24n^2} \qquad\text{and}\qquad |E_S| \le \frac{L(b-a)^5}{180n^4},
\end{gather*}
</div>where \(M\) is an upper bound for \(|f''(x)|\) and \(L\) is an upper bound for \(|f^{(4)}(x)|\text{,}\) and \(E_M\) and \(E_S\) are the absolute errors arising from the midpoint rule and Simpson's rule, respectively.</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-932" id="hint-932"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-932"><div class="hint solution-like"><p id="p-7807">The main steps in part (b) are to find the smallest possible values of \(M\) and \(L\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1014" id="answer-1014"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1014"><div class="answer solution-like">
<p id="p-7808">(a)</p>
<div class="displaymath">
\begin{align*}
&amp;\dfrac{1/3}3 \Big( (-3)^5 + 4\Big( \frac13-3 \Big)^5 + 2\Big( \frac23-3 \Big)^5 + 4(-2)^5 + 2\Big( \frac43-3 \Big)^5\\
&amp;\hskip2in + 4\Big( \frac53-3 \Big)^5 + (-1)^5 \Big)
\end{align*}
</div>
<p id="p-7809">(b) Simpson's Rule results in a smaller error bound.</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1014" id="solution-1014"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1014"><div class="solution solution-like">
<p id="p-7810">(a) Since \(a=0\text{,}\) \(b=2\) and \(n=6\text{,}\) we have \(\Delta x=\frac{b-a}{n}=\frac{2-0}6 = \frac{1}{3}\text{,}\) and so \(x_0=0\text{,}\) \(x_1=\frac{1}{3}\text{,}\) \(x_2=\frac{2}{3}\text{,}\) \(x_3=1\text{,}\) \(x_4=\frac{4}{3}\text{,}\) \(x_5=\frac{5}{3}\text{,}\) and \(x_6=2\text{.}\) Since Simpson's Rule with \(n=6\) in general is</p>
<div class="displaymath">
\begin{gather*}
\frac{\Delta x}3 \big[ f(x_0) + 4f(x_1) + 2f(x_2) + 4f(x_3) + 2f(x_4) + 4f(x_5) + f(x_6) \big],
\end{gather*}
</div>
<p data-braille="continuation">the desired approximation is</p>
<div class="displaymath">
\begin{align*}
&amp;\frac{1/3}3 \bigg( (-3)^5 + 4\Big( \frac13-3 \Big)^5 + 2\Big( \frac23-3 \Big)^5 + 4(-2)^5 + 2\Big( \frac43-3 \Big)^5 \\
&amp;\hskip2in+ 4\Big( \frac53-3 \Big)^5 + (-1)^5 \bigg)
\end{align*}
</div>
<p id="p-7811">(b) Here \(f(x) = (x-3)^5\text{,}\) which has derivatives</p>
<div class="displaymath">
\begin{align*}
f'(x) &amp;= 5(x-3)^4 &amp; f''(x) &amp;= 20(x-3)^3\\
f^{(3)}(x) &amp;= 60(x-3)^2 &amp; f^{(4)}(x) &amp;= 120(x-3).
\end{align*}
</div>
<p data-braille="continuation">For \(0\le x\le 2\text{,}\) \((x-3)\) runs from \(-3\) to \(-1\text{,}\) so the maximum absolute values are found at \(x=0\text{,}\) giving \(M= 20\cdot|0-3|^3=540\) and \(L=120\cdot|0-3|=360\text{.}\) Consequently, for the Midpoint Rule with \(n=100\text{,}\)</p>
<div class="displaymath">
\begin{gather*}
|E_M| \le \frac{M(b-a)^3}{24n^2} = \frac{540 \times 2^3}{24 \times 10^4} = \frac{180}{10^4};
\end{gather*}
</div>
<p data-braille="continuation">whereas for Simpson's Rule with \(n=10\text{,}\)</p>
<div class="displaymath">
\begin{gather*}
|E_S| \le \frac{360 \times 2^5 }{180 \times 10^4}  = \frac{64}{10^4}.
\end{gather*}
</div>
<p data-braille="continuation">Since \(64 \lt 180\text{,}\) Simpson's Rule results in a smaller error bound.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1015"><h6 class="heading">
<span class="codenumber">21<span class="period">.</span></span><span class="space"> </span><span class="title">M105 2013A.</span>
</h6>
<p id="p-7812">Find a bound for the error in approximating \(\displaystyle\int_1^5 \frac{1}{x}\,\dee{x}\) using Simpson's rule with \(n = 4\text{.}\) Do not write down the Simpson's rule approximation \(S_4\text{.}\)</p>
<p id="p-7813">In general the error in approximating \(\int_a^b f(x)\dee{x}\) using Simpson's rule with \(n\) steps is bounded by \(\dfrac{L(b-a)}{180}(\De x)^4\) where \(\De x=\dfrac{b-a}{n}\) and \(L\ge |f^{(4)}(x)|\) for all \(a\le x\le b\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-933" id="hint-933"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-933"><div class="hint solution-like"><p id="p-7814">As usual, the biggest part of this problem is finding \(L\text{.}\) Don't be thrown off by the error bound being given slightly differently from Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a> in the text: these expressions are equivalent, since \(\De x = \frac{b-a}{n}\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1015" id="answer-1015"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1015"><div class="answer solution-like"><p id="p-7815">\(\dfrac{8}{15}\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1015" id="solution-1015"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1015"><div class="solution solution-like">
<p id="p-7816">In general the error in approximating \(\int_a^b f(x)\dee{x}\) using Simpson's rule with \(n\) steps is bounded by \(\frac{L(b-a)}{180}(\De x)^4\) where \(\De x=\frac{b-a}{n}\) and \(L\ge |f^{(4)}(x)|\) for all \(a\le x\le b\text{.}\) In this case, \(a=1\text{,}\) \(b=5\text{,}\) \(n=4\) and \(f(x)=\frac{1}{x}\text{.}\) We need to find \(L\text{,}\) so we differentiate.</p>
<div class="displaymath" id="p-7817">
\begin{gather*}
f'(x)=-\frac{1}{x^2}\qquad
f''(x)=\frac{2}{x^3}\qquad
f^{(3)}(x)=-\frac{6}{x^4}\qquad
f^{(4)}(x)=\frac{24}{x^5}
\end{gather*}
</div>
<p data-braille="continuation">and</p>
<div class="displaymath">
\begin{gather*}
\big|f^{(4)}(x)\big|\le 24\text{ for all }x\ge 1
\end{gather*}
</div>
<p data-braille="continuation">So we may take \(L=24\) and \(\De x=\frac{5-1}{4}=1\text{,}\) which leads to</p>
<div class="displaymath">
\begin{gather*}
|\text{Error }|\le \frac{24(5-1)}{180}(1)^4=\frac{24}{45}=\frac{8}{15}
\end{gather*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1016"><h6 class="heading">
<span class="codenumber">22<span class="period">.</span></span><span class="space"> </span><span class="title">M105 2012A.</span>
</h6>
<p id="p-7818">Find a bound for the error in approximating</p>
<div class="displaymath">
\begin{equation*}
\int_0^1 \big(e^{-2x}+3x^3\big)\,\dee{x}
\end{equation*}
</div>
<p data-braille="continuation">using Simpson's rule with \(n = 6\text{.}\) Do not write down the Simpson's rule approximation \(S_n\text{.}\)</p>
<p id="p-7819">In general, the error in approximating \(\int_a^b f(x)\dee{x}\) using Simpson's rule with \(n\) steps is bounded by \(\dfrac{ L(b-a)}{180}(\De x)^4\) where \(\De x=\dfrac{b-a}{n}\) and \(L\ge |f^{(4)}(x)|\) for all \(a\le x\le b\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-934" id="hint-934"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-934"><div class="hint solution-like"><p id="p-7820">The function \(e^{-2x} = \dfrac{1}{e^{2x}}\) is positive and decreasing, so its maximum occurs when \(x\) is as small as possible.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1016" id="answer-1016"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1016"><div class="answer solution-like"><p id="p-7821">\(\displaystyle\frac{1}{180\times 3^4}
=\frac{1}{14580}\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1016" id="solution-1016"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1016"><div class="solution solution-like">
<p id="p-7822">In general, the error in approximating \(\int_a^b f(x)\dee{x}\) using Simpson's rule with \(n\) steps is bounded by \(\displaystyle\frac{L(b-a)}{180}(\De x)^4\) where \(\De x=\dfrac{b-a}{n}\) and \(L\ge |f^{(4)}(x)|\) for all \(a\le x\le b\text{.}\) In this case, \(a=0\text{,}\) \(b=1\text{,}\) \(n=6\) and \(f(x)=e^{-2x}+3x^3\text{.}\) We need to find \(L\text{,}\) so we differentiate.</p>
<div class="displaymath">
\begin{align*}
f'(x)&amp;=-2e^{-2x}+9x^2 &amp;
f''(x)&amp;=4e^{-2x}+18x\\
f^{(3)}(x)&amp;=-8e^{-2x}+18 &amp;
f^{(4)}(x)&amp;= 16 e^{-2x}
\end{align*}
</div>
<p data-braille="continuation">Since \(e^{-2x} = \dfrac{1}{e^{2x}}\text{,}\) we see \(f^{(4)}(x)\) is a positive, decreasing function. So, its maximum occurs when \(x\) is as small as possible. In the interval \([0,1]\text{,}\) that means \(x=0\text{.}\)</p>
<div class="displaymath">
\begin{gather*}
\big|f^{(4)}(x)\big|\le f(0)=16\text{ for all }x\ge 0
\end{gather*}
</div>
<p data-braille="continuation">So, we  take \(L=16\) and \(\De x=\frac{1-0}{6}=\frac{1}{6}\text{.}\)</p>
<div class="displaymath">
\begin{align*}
|\text{Error}|&amp;\le \frac{L(b-a)}{180}(\De x)^4=\frac{16(1-0)}{180}(1/6)^4
=\frac{16}{180\times 6^4}\\
&amp;=\frac{1}{180\times 3^4}
=\frac{1}{14580}
\end{align*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1017"><h6 class="heading">
<span class="codenumber">23<span class="period">.</span></span><span class="space"> </span><span class="title">2012A.</span>
</h6>
<p id="p-7823">Let \(I=\displaystyle\int_1^2 (1/x)\,\dee{x}\text{.}\)</p>
<ol id="p-7824" class="lower-alpha">
<li id="li-2940">Write down the trapezoidal approximation \(T_4\) for \(I\text{.}\) <em class="emphasis">You do not need to simplify your answer.</em>
</li>
<li id="li-2941">Write down the Simpson's approximation \(S_4\) for \(I\text{.}\) <em class="emphasis">You do not need to simplify your answer.</em>
</li>
<li id="li-2942">Without computing \(I\text{,}\) find an upper bound for \(|I - S_4|\text{.}\) You may use the fact that if \(\big|f^{(4)}(x)\big|\le L\) on the interval \([a, b]\text{,}\) then the error in using \(S_n\) to approximate \(\int_a^b f(x)\,\dee{x}\) has absolute value less than or equal to \(L(b-a)^5/180n^4\text{.}\)</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-935" id="hint-935"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-935"><div class="hint solution-like"><p id="p-7825">Since \(\dfrac{1}{x^5}\) is a decreasing function when \(x \gt 0\text{,}\) look for its maximum value when \(x\) is as small as possible.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1017" id="answer-1017"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1017"><div class="answer solution-like">
<p id="p-7826">(a)  \(\displaystyle T_4
=\frac{1}{4}\left[\left(\frac{1}{2}\times 1\right)+\frac{4}{5}+\frac{2}{3}+ \frac{4}{7}+\left(\frac{1}{2}\times\frac{1}{2}\right)\right]\text{,}\)</p>
<p id="p-7827">(b) \(\displaystyle S_4
=\frac{1}{12}\left[1+\left(4\times\frac{4}{5}\right)+\left(2\times \frac{2}{3}\right)+\left(4\times \frac{4}{7}\right)+\frac{1}{2}\right]\)</p>
<p id="p-7828">(c) \(\displaystyle\Big|I -S_4\Big|
\le \frac{24}{180\times 4^4}=\frac{3}{5760}\)</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1017" id="solution-1017"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1017"><div class="solution solution-like">
<p id="p-7829">For both approximations, \(a=1\text{,}\) \(b=2\text{,}\) \(n=4\text{,}\) \(f(x)=\frac{1}{x}\) and \(\De x=\frac{b-a}{n}=\frac{1}{4}\text{.}\)</p>
<p id="p-7830">Then \(x_0 = 1\text{,}\) \(x_1=\frac{5}{4}\text{,}\) \(x_2 = \frac{3}{2}\text{,}\) \(x_3=\frac{7}{4}\text{,}\) and \(x_4=2\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:12.5%;margin-right:12.5%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-814.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<p id="p-7831">(a)</p>
<div class="displaymath">
\begin{align*}
T_4&amp;=&amp;\De x&amp;\left[\frac{1}{2}f(x_0)+f(x_1)+f(x_2)+f(x_3)+\frac{1}{2}f(x_4)\right]\\
&amp;=&amp;\De x&amp;\left[\frac{1}{2}f(1)+f(5/4)+f(3/2)+f(7/4)+\frac{1}{2}f(2)\right]\\
&amp;=&amp;\frac{1}{4}&amp;\left[\left(\frac{1}{2}\times 1\right)+\frac{4}{5}+\frac{2}{3}+ \frac{4}{7}+\left(\frac{1}{2}\times\frac{1}{2}\right)\right]
\end{align*}
</div>
<p id="p-7832">(b)</p>
<div class="displaymath">
\begin{align*}
S_4&amp;=\frac{\De x}{3}\big[f(x_0)+4f(x_1)+2f(x_2)+4f(x_3)+f(x_4)\big]\\
&amp;=\frac{\De x}{3}\big[f(1)+4f(5/4)+2f(3/2)+4f(7/4)+f(2)\big]\\
&amp;=\frac{1}{12}\left[1+\left(4\times\frac{4}{5}\right)+\left(2\times \frac{2}{3}\right)+\left(4\times \frac{4}{7}\right)+\frac{1}{2}\right]
\end{align*}
</div>
<p id="p-7833">(c) In this case, \(a=1\text{,}\) \(b=2\text{,}\) \(n=4\) and \(f(x)=\frac{1}{x}\text{.}\) We need to find \(L\text{,}\) so we differentiate.</p>
<div class="displaymath">
\begin{gather*}
f'(x)=-\frac{1}{x^2}\qquad
f''(x)=\frac{2}{x^3}\qquad
f^{(3)}(x)=-\frac{6}{x^4}\qquad
f^{(4)}(x)=\frac{24}{x^5}
\end{gather*}
</div>
<p data-braille="continuation">So,</p>
<div class="displaymath">
\begin{gather*}
\big|f^{(4)}(x)\big|\le 24\text{ for all }x\text{ in the interval } [1,2]
\end{gather*}
</div>
<p data-braille="continuation">We take \(L=24\text{.}\)</p>
<div class="displaymath">
\begin{gather*}
|\text{Error }|\le \frac{L(b-a)^5}{180\times n^4}
\le \frac{24(2-1)^5}{180\times 4^4}=\frac{24}{180\times 4^4}=\frac{3}{5760}
\end{gather*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="prob_s_1_11_error2"><h6 class="heading">
<span class="codenumber">24<span class="period">.</span></span><span class="space"> </span><span class="title">M121 2000A.</span>
</h6>
<p id="p-7834">A function \(s(x)\) satisfies \(s(0)=1.00664\text{,}\) \(s(2)=1.00543\text{,}\) \(s(4)=1.00435\text{,}\) \(s(6)=1.00331\text{,}\) \(s(8)=1.00233\text{.}\) Also, it is known to satisfy \(\big|s^{(k)}(x)\big|\le \dfrac{k}{1000}\) for \(0\le x\le 8\) and all positive integers \(k\text{.}\)</p>
<ol id="p-7835" class="lower-alpha">
<li id="li-2943">Find the best Trapezoidal Rule and Simpson's Rule approximations that you can for \(\displaystyle I=\int_0^8 s(x)\dee{x}\text{.}\)</li>
<li id="li-2944">Determine the maximum possible sizes of errors in the approximations you gave in part (a). Recall that if a function \(f(x)\) satisfies \(\big|f^{(k)}(x)\big|\le K_k\) on \([a,b]\text{,}\) then<div class="displaymath">
\begin{equation*}
\bigg|\int_a^b f(x)\dee{x} -T_n\bigg|\le \frac{K_2(b-a)^3}{12n^2}
\quad\hbox{and}\quad
\bigg|\int_a^b f(x)\dee{x} -S_n\bigg|\le \frac{K_4(b-a)^5}{180n^4}
\end{equation*}
</div>
</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-936" id="hint-936"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-936"><div class="hint solution-like">
<p id="p-7836">The “best ... approximations that you can” means using the maximum number of intervals, given the information available.</p>
<p id="p-7837">The final sentence in part (b) is just a re-statement of the error bounds we're familiar with from Theorem <a class="xref" data-knowl="./knowl/thm_num_int_err.html" title="Theorem 6.11.13: Numerical integration errors">6.11.13</a> in the text. The information \(\big|s^{(k)}(x)\big|\le \dfrac{k}{1000}\) gives you values of \(M\) and \(L\) when you set \(k=2\) and \(k=4\text{,}\) respectively.</p>
</div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1018" id="answer-1018"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1018"><div class="answer solution-like">
<p id="p-7838">(a)  \(T_4=8.03515\text{,}\) \(S_4\approx 8.03509\)</p>
<p id="p-7839">(b)</p>
<div class="displaymath">
\begin{equation*}
\displaystyle\Big|\int_a^b f(x)\ dx -T_n\Big|
\le \frac{2}{1000}\frac{8^3}{12(4)^2} \le0.00533
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\displaystyle\Big|\int_a^b f(x)\ dx -S_n\Big|
\le   \frac{4}{1000}\frac{8^5}{180(4)^4}\le0.00284
\end{equation*}
</div>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1018" id="solution-1018"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1018"><div class="solution solution-like">
<p id="p-7840">Set \(a=0\) and \(b=8\text{.}\) Since we have information about \(s(x)\) when \(x\) is 0, 2, 4, 6, and 8, we set  \(\De x=\frac{b-a}{n}=2\text{,}\) so \(n=4\text{.}\) (Recall with the trapezoid rule and Simpson's rule, \(n=4\) intervals actually uses the value of the function at 5 points.)</p>
<p id="p-7841">We could perform the trapezoidal approximations with fewer intervals, for example \(n=2\text{,}\) but this would involve ignoring some of the points we're given. Since the question asks for the best estimation we can give, we use \(n=4\) intervals and no fewer.</p>
<ol class="lower-alpha">
<li id="li-2945"><div class="displaymath" id="p-7842">
\begin{align*}
T_4&amp;={\De x}\left[\frac{1}{2}s(0)+s(2)+s(4)+s(6)+\frac{1}{2}s(8)\right]\\
&amp;=2\left[\frac{1.00664}{2}+1.00543+ 1.00435+1.00331+ \frac{1.00233}{2}\right]\\
&amp;=8.03515\\
S_4&amp;=\frac{\De x}{3}\big[s(0)+4s(2)+2s(4)+4s(6)+s(8)\big]\\
&amp;=\frac{2}{3}\big[1.00664+4\times 1.00543+2\times 1.00435+4\times1.00331\\
&amp;\hskip3in + 1.00233\big]\\
&amp;\approx 8.03509
\end{align*}
</div></li>
<li id="li-2946">
<p id="p-7843">The information \(\big|s^{(k)}(x)\big|\le \dfrac{k}{1000}\text{,}\) with \(k=2\text{,}\) tells us \(|s''(x)|\leq \frac{2}{1000}\) for all \(x\) in the interval \([0,8]\text{.}\) So, we take \(K_2\) (also called \(M\) in your text) to be \(\frac{2}{1000}\text{.}\)</p>
<p id="p-7844">Then the absolute error associated with our trapezoid rule approximation is at most</p>
<div class="displaymath">
\begin{align*}
\bigg|\int_a^b f(x)\ dx -T_n\bigg|&amp;\le \frac{K_2(b-a)^3}{12n^2}
\le \frac{2}{1000}\cdot\frac{8^3}{12(4)^2}
\le 0.00533
\end{align*}
</div>
<p id="p-7845">For \(k=4\text{,}\) we see \(|s^{(4)}(x)|\leq \frac{4}{1000}\) for all \(x\) in the interval \([0,8]\text{.}\) So, we take \(K_4\) (also called \(L\) in your text) to be \(\frac{4}{1000}\text{.}\)</p>
<p id="p-7846">Then the absolute error associated with our Simpson's rule approximation is at most</p>
<div class="displaymath">
\begin{align*}
\bigg|\int_a^b f(x)\ dx -S_n\bigg|&amp;\le \frac{K_4(b-a)^5}{180n^4}
\le \frac{4}{1000}\cdot\frac{8^5}{180(4)^4}
\le0.00284
\end{align*}
</div>
</li>
</ol>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1019"><h6 class="heading">
<span class="codenumber">25<span class="period">.</span></span><span class="space"> </span><span class="title">2014A.</span>
</h6>
<p id="p-7847">Consider the trapezoidal rule for making numerical approximations to \(\displaystyle\int_a^b f(x)\dee{x}\text{.}\) The error for the trapezoidal rule satisfies \(|E_T| \le \dfrac{ M(b - a)^3}{12n^2}\) , where \(|f''(x)| \le M\) for \(a \le x \le b\text{.}\) If \(-2  \lt  f''(x)  \lt  0\) for \(1 \le x \le 4\text{,}\) find a value of \(n\) to guarantee the trapezoidal rule will give an approximation for \(\displaystyle\int_1^4 f(x)\dee{x}\) with absolute error, \(|E_T|\text{,}\) less than \(0.001\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-937" id="hint-937"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-937"><div class="hint solution-like"><p id="p-7848">Set the error bound to be less than \(0.001\text{,}\) then solve for \(n\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1019" id="answer-1019"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1019"><div class="answer solution-like"><p id="p-7849">Any  \(n\ge 68\) works.</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1019" id="solution-1019"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1019"><div class="solution solution-like">
<p id="p-7850">In this case, \(a=1\text{,}\) \(b=4\text{.}\) Since \(-2 \leq f''(x) \leq 0\)  over the relevant interval,  we take \(M=2\text{.}\) (Remember \(M\) is an upper bound on \(|f''(x)|\text{,}\) not \(f''(x)\text{.}\)) So we need \(n\) to obey</p>
<div class="displaymath">
\begin{gather*}
\frac{ 2(4 - 1)^3}{12n^2} \le 0.001
\iff n^2\ge \frac{2(3)^3}{12} 1000 =\frac{27000}{6}=\frac{9000}{2}=4500
\end{gather*}
</div>
<p data-braille="continuation">One obvious allowed \(n\) is \(100\text{.}\) Since \(\sqrt{4500} \approx 67.01\text{,}\) and \(n\) has to be a whole number, any  \(n\ge 68\) works.</p>
</div></div>
</div></article>
</div>
</div>
<div class="exercisegroup" id="exercisegroup-148">
<h6 class="heading"><span class="title"></span></h6>
<div class="introduction" id="introduction-236"></div>
<div class="exercisegroup-exercises">
<article class="exercise exercise-like" id="exercise-1020"><h6 class="heading">
<span class="codenumber">26<span class="period">.</span></span><span class="space"> </span><span class="title">1996A.</span>
</h6>
<p id="p-7851">A swimming pool has the shape shown in the figure below. The vertical cross--sections of the pool are semi--circular disks. The distances in feet across the pool are given in the figure at 2--foot intervals along the sixteen--foot length of the pool. Use Simpson's Rule to estimate the volume of the pool.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:17%;margin-right:17%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="problems/figs/pool.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-938" id="hint-938"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-938"><div class="hint solution-like">
<p id="p-7852">See Section <a href="sec_numeric_int.html#sec_Simpson" class="internal" title="Subsection 6.11.3: Simpson's Rule">6.11.3</a>. To set up the volume integral, see Example <a class="xref" data-knowl="./knowl/eg_VOLs.html" title="Example 6.6.2: Sphere">6.6.2</a>.</p>
<p id="p-7853">Since the cross-sections of the pool are semi-circular disks, a section that is \(d\) metres across will have area \(\frac{1}{2}\pi\left(\frac{d}{2}\right)^2\) square feet.  Based on the drawing, you may assume the very ends of the pool have distance 0 feet across.</p>
</div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1020" id="answer-1020"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1020"><div class="answer solution-like"><p id="p-7854">\(\dfrac{472}{3}\approx 494 \ {\rm ft}^3\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1020" id="solution-1020"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1020"><div class="solution solution-like">
<p id="p-7855">Denote by \(f(x)\) the width of the pool  \(x\) feet from the left-hand end. From the sketch, \(f(0)=0\text{,}\) \(f(2)=10\text{,}\) \(f(4)=12\text{,}\) \(f(6)=10\text{,}\) \(f(8)=8\text{,}\) \(f(10)=6\text{,}\) \(f(12)=8\text{,}\) \(f(14)=10\) and \(f(16)=0\text{.}\)</p>
<p id="p-7856">A cross-section of the pool \(x\) feet from the left end is half of a circular disk with diameter \(f(x)\) (so, radius \(\frac{f(x)}{2}\)) and thickness \(\dee{x}\text{.}\) So, the volume of the part of the pool with \(x\)--coordinate running from \(x\) to \(x+\dee{x}\) is \(\half\pi\Big(\frac{f(x)}{2}\Big)^2\,\dee{x} = \frac{\pi}{8}[f(x)]^2\,\dee{x}\text{.}\)</p>
<p id="p-7857">The total volume is given by the following integral.</p>
<div class="displaymath">
\begin{align*}
V&amp;=\frac{\pi}{8}\int_0^{16}f(x)^2\,\dee{x}\\
&amp;\approx\frac{\pi}{8}\cdot\frac{\De x}{3}
\Big[f(0)^2+4f(2)^2+2f(4)^2+4f(6)^2+2f(8)^2
+4f(10)^2\\
&amp;\hskip2.5in+2f(12)^2+4f(14)^2\!+f(16)^2\Big]\\
&amp;=\frac{\pi}{8}\cdot\frac{2}{3}
\Big[0+4(10)^2+2(12)^2+4(10)^2+2(8)^2
+4(6)^2+2(8)^2\\
&amp;\hskip2.5in+4(10)^2+0\Big]\\
&amp;=\frac{472}{3}\pi\approx 494 \ {\rm ft}^3
\end{align*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1021"><h6 class="heading">
<span class="codenumber">27<span class="period">.</span></span><span class="space"> </span><span class="title">2002A,M121 2002A.</span>
</h6>
<p id="p-7858">A piece of wire 1m long with radius 1mm is made in such a way that the density varies in its cross--section, but is radially symmetric (that is, the local density \(g(r)\) in \({\rm kg/m^3}\) depends only on the distance \(r\) in mm from the centre of the wire). Take as given that the total mass \(W\) of the wire in kg is given by</p>
<div class="displaymath">
\begin{gather*}
W=2\pi 10^{-6}\int_0^1 rg(r)\,\dee{r}
\end{gather*}
</div>
<p data-braille="continuation">Data from the manufacturer is given below:</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b1 r1 l1 t1 lines">\(r\)</td>
<td class="l m b1 r1 l0 t1 lines">0</td>
<td class="l m b1 r1 l0 t1 lines">1/4</td>
<td class="l m b1 r1 l0 t1 lines">1/2</td>
<td class="l m b1 r1 l0 t1 lines">3/4</td>
<td class="l m b1 r1 l0 t1 lines" data-braille="last-cell">1</td>
</tr>
<tr>
<td class="l m b1 r1 l1 t0 lines">\(g(r)\)</td>
<td class="l m b1 r1 l0 t0 lines">8051</td>
<td class="l m b1 r1 l0 t0 lines">8100</td>
<td class="l m b1 r1 l0 t0 lines">8144</td>
<td class="l m b1 r1 l0 t0 lines">8170</td>
<td class="l m b1 r1 l0 t0 lines" data-braille="last-cell">8190</td>
</tr>
</table></div></div></div>
<ol id="p-7859" class="lower-alpha">
<li id="li-2947">Find the best Trapezoidal Rule approximation that you can for \(W\) based on the data in the table.</li>
<li id="li-2948">Suppose that it is known that \(|g'(r)| \lt 200\) and \(|g''(r)| \lt 150\) for all values of \(r\text{.}\) Determine the maximum possible size of the error in the approximation you gave in part (a). Recall that if a function \(f(x)\) satisfies \(|f''(x)|\le M\) on \([a,b]\text{,}\) then<div class="displaymath">
\begin{gather*}
|I-T_n|\le\frac{M(b-a)^3}{12n^2}
\end{gather*}
</div>where \(I=\int_a^b f(x)\,\dee{x}\) and \(T_n\) is the Trapezoidal Rule approximation to \(I\) using \(n\) subintervals.</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-939" id="hint-939"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-939"><div class="hint solution-like">
<p id="p-7860">See Example <a class="xref" data-knowl="./knowl/eg_MidpointErr2.html" title="Example 6.11.15: How many steps  for a given accuracy?">6.11.15</a>.</p>
<p id="p-7861">Don't get caught up in the interpretation of the integral. It's nice to see how integrals can be used, but for this problem, you're still just approximating the integral given, and bounding the error.</p>
<p id="p-7862">When you find the second derivative to bound your error, pay attention to the difference between the integrand and \(g(r)\text{.}\)</p>
</div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1021" id="answer-1021"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1021"><div class="answer solution-like">
<p id="p-7863">(a) \(0.025635\)</p>
<p id="p-7864">(b) \(1.8\times 10^{-5}\)</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1021" id="solution-1021"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1021"><div class="solution solution-like">
<p id="p-7865">(a) The Trapezoidal Rule with \(n=4\text{,}\) \(a=0\text{,}\) \(b=1\text{,}\) and \(\De x = \frac{1}{4}\) gives:</p>
<div class="displaymath">
\begin{align*}
&amp;W=2\pi 10^{-6}\int_0^1 rg(r)\,\dee{r}\\
&amp;\approx 2\pi 10^{-6}\De x\left[\frac{1}{2}x_0g(x_0)+x_1g(x_1)+x_2g(x_2)+x_3g(x_3)+ \frac{1}{2}x_4g(x_4)\right]\\
&amp;=2\pi 10^{-6}\ \frac{1}{4}
\Big[\frac{1}{2} 0g(0)+\frac{1}{4}g\Big(\frac{1}{4}\Big)
+\frac{1}{2}g\Big(\frac{1}{2}\Big)+\frac{3}{4}g\Big(\frac{3}{4}\Big)
+\frac{1}{2} g(1)\Big]\\
&amp;=\pi 10^{-6}\ \frac{1}{2}
\Big[\frac{8100}{4}
+\frac{8144}{2}+\frac{3\cdot 8170}{4}
+\frac{8190}{2} \Big]\\
&amp; = \frac{32639\pi}{4\cdot 10^6}\approx 0.025635
\end{align*}
</div>
<p id="p-7866">(b) Using the product rule, the integrand \(f(r)=2\pi 10^{-6} rg(r)\) obeys</p>
<div class="displaymath">
\begin{gather*}
f''(r)=2\pi 10^{-6} \diff{}{r}\big[g(r)+ rg'(r)\big]
=2\pi 10^{-6} \big[2g'(r)+ rg''(r)\big]
\end{gather*}
</div>
<p data-braille="continuation">and hence, for \(0\le r\le 1\text{,}\)</p>
<div class="displaymath">
\begin{gather*}
\big|f''(r)\big|\le 2\pi 10^{-6} \big[2\times200 + 1\times 150\big]
=1.1\pi 10^{-3}
\end{gather*}
</div>
<p data-braille="continuation">So,</p>
<div class="displaymath">
\begin{gather*}
|\text{Error}|\le \frac{1.1\pi 10^{-3}(1-0)^3}{12(4)^2}
\le1.8\times 10^{-5}
\end{gather*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1022"><h6 class="heading">
<span class="codenumber">28<span class="period">.</span></span><span class="space"> </span><span class="title">1997A.</span>
</h6>
<p id="p-7867">Simpson's rule can be used to approximate \(\log 2\text{,}\) since \(\displaystyle\log 2=\int_1^2\frac{1}{x}\,\dee{x}\text{.}\)</p>
<ol class="lower-alpha">
<li id="li-2949">Use Simpson's rule with 6 subintervals to approximate \(\log 2\text{.}\)</li>
<li id="li-2950">
<p id="p-7868">How many subintervals are required in order to guarantee that the absolute error is less than \(0.00001\text{?}\)</p>
<p id="p-7869">Note that if \(E_n\) is the error using \(n\) subintervals, then \(|E_n|\le\dfrac{L(b-a)^5}{180n^4}\) where \(L\) is the maximum absolute value of the fourth derivative of the function being integrated and \(a\) and \(b\) are the end points of the interval.</p>
</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-940" id="hint-940"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-940"><div class="hint solution-like"><p id="p-7870">See Example <a class="xref" data-knowl="./knowl/eg_SimpsonErr.html" title="Example 6.11.16: How many steps using Simpson's rule?">6.11.16</a>. You'll want to use a calculator for the approximation in (a), and for finding the appropriate number of intervals in (b). Remember that Simpson's rule requires an even number of intervals.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1022" id="answer-1022"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1022"><div class="answer solution-like">
<p id="p-7871">(a) \(\approx 0.6931698\)</p>
<p id="p-7872">(b) \(n\ge 12\) with \(n\) even</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1022" id="solution-1022"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1022"><div class="solution solution-like">
<p id="p-7873">(a) Let \(f(x)=\frac{1}{x}\text{,}\) \(a=1\text{,}\) \(b=2\) and \(\De x=\frac{b-a}{6}=\frac{1}{6}\text{.}\) Using Simpson's rule:</p>
<div class="displaymath">
\begin{align*}
\int_1^2\frac{1}{x}\dee{x}
&amp;\approx \frac{\De x}{3}\Big[
f(1)+4f\Big(\frac{7}{6}\Big)+2f\Big(\frac{8}{6}\Big)
+4f\Big(\frac{9}{6}\Big)+2f\Big(\frac{10}{6}\Big)\\
&amp;\hskip2.5in+4f\Big(\frac{11}{6}\Big)+f(2)\Big]\\
&amp;= \frac{1}{18}\Big[
1+\frac{24}{7}+\frac{12}{8}+\frac{24}{9}+\frac{12}{10}+\frac{24}{11}
+\frac{1}{2}\Big]\approx 0.6931698
\end{align*}
</div>
<p id="p-7874">(b) The integrand is \(f(x)=\frac{1}{x}\text{.}\) The first four derivatives of \(f(x)\) are:</p>
<div class="displaymath">
\begin{equation*}
f'(x)=-\frac{1}{x^2}, \qquad f''(x)=\frac{2}{x^3}, \qquad
f^{(3)}(x)=-\frac{6}{x^4}, \qquad f^{(4)}(x)=\frac{24}{x^5}
\end{equation*}
</div>
<p data-braille="continuation">On the interval \(1\le x\le 2\text{,}\) the fourth derivative is never bigger in magnitude than \(L=24\text{.}\)</p>
<div class="displaymath">
\begin{align*}
|E_n|&amp;\le\frac{L(b-a)^5}{180n^4}
=\frac{24(2-1)^5}{180n^4}
=\frac{4}{30n^4}\\
\end{align*}
<p class="intertext">So, we want an even number \(n\) such that</p>
\begin{align*}
\frac{4}{30n^4} &amp;\leq 0.00001 = \frac{1}{10^5}\\
n^4 &amp; \geq \frac{40000}{3}\\
n&amp;\geq \sqrt[4]{\frac{40000}{3}}\approx 10.7
\end{align*}
</div>
<p data-braille="continuation">So, any even number greater than or equal to 12 will do.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1023"><h6 class="heading">
<span class="codenumber">29<span class="period">.</span></span><span class="space"> </span><span class="title">1997D.</span>
</h6>
<p id="p-7875">Let \(I={\displaystyle\int_0^2}\cos(x^2)\dee{x}\) and let \(S_n\) be the Simpson's rule approximation to \(I\) using \(n\) subintervals.</p>
<ol class="lower-alpha">
<li id="li-2951">Estimate the maximum absolute error in using \(S_8\) to approximate \(I\text{.}\)</li>
<li id="li-2952">How large should \(n\) be in order to ensure that \(|I-S_n|\le 0.0001\text{?}\)</li>
</ol>
<p data-braille="continuation">Note: The graph of \(f''''(x)\text{,}\) where \(f(x)=\cos(x^2)\text{,}\) is shown below. The absolute error in the Simpson's rule approximation is bounded by \(\dfrac{L(b-a)^5}{180n^4}\) when \(|f''''(x)|\le L\) on the interval \([a,b]\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:25%;margin-right:25%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="problems/figs/graphE97D_11.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-941" id="hint-941"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-941"><div class="hint solution-like">
<p id="p-7876">See Example <a class="xref" data-knowl="./knowl/eg_SimpsonErr.html" title="Example 6.11.16: How many steps using Simpson's rule?">6.11.16</a>.</p>
<p id="p-7877">Rather than calculating the fourth derivative of the integrand, use the graph to find the largest absolute value it attains over our interval.</p>
</div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1023" id="answer-1023"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1023"><div class="answer solution-like">
<p id="p-7878">(a) \(0.01345\)</p>
<p id="p-7879">(b) \(n\ge 28\) with \(n\) even</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1023" id="solution-1023"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1023"><div class="solution solution-like">
<p id="p-7880">(a) From the figure, we see that the magnitude of \(|f''''(x)|\) never exceeds 310 for \(0\le x\le 2\text{.}\) So, the absolute error is bounded by</p>
<div class="displaymath">
\begin{gather*}
\frac{310(2-0)^5}{180\times 8^4}\le 0.01345
\end{gather*}
</div>
<p id="p-7881">(b) We want to choose \(n\) such that:</p>
<div class="displaymath">
\begin{align*}
\frac{310(2-0)^5}{180\times n^4}&amp;\le 10^{-4}\\
n^4&amp;\ge \frac{310\times 2^5}{180}10^4\\
n&amp;\ge 10\root 4 \of {\frac{310\times 32}{180}}\approx27.2
\end{align*}
</div>
<p data-braille="continuation">For Simpson's rule, \(n\) must be even, so any even integer obeying \(n\ge28\) will guarantee us the requisite accuracy.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1024"><h6 class="heading">
<span class="codenumber">30<span class="period">.</span></span><span class="space"> </span><span class="title">2000D.</span>
</h6>
<p id="p-7882">Define a function \(f(x)\) and an integral \(I\) by</p>
<div class="displaymath">
\begin{gather*}
f(x)=\int_0^{x^2}\sin(\sqrt{t})\,\dee{t},\qquad I=\int_0^1 f(t)\,\dee{t}
\end{gather*}
</div>
<p data-braille="continuation">Estimate how many subdivisions are needed to calculate \(I\) to five decimal places of accuracy using the trapezoidal rule.</p>
<p id="p-7883">Note that if \(E_n\) is the error using \(n\) subintervals, then \(|E_n|\le\dfrac{M(b-a)^3}{12n^2\vphantom{\frac{1}{2}}}\text{,}\) where \(M\) is the maximum absolute value of the second derivative of the function being integrated and \(a\) and \(b\) are the limits of integration.</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-942" id="hint-942"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-942"><div class="hint solution-like">
<p id="p-7884">See Example <a class="xref" data-knowl="./knowl/eg_MidpointErr2.html" title="Example 6.11.15: How many steps  for a given accuracy?">6.11.15</a>.</p>
<p id="p-7885">You'll have to differentiate \(f(x)\text{.}\) To that end, you may also want to review the fundamental theorem of calculus and, in particular, Example <a class="xref" data-knowl="./knowl/eg_INTftocB.html" title="Example 6.3.5: \(\diff{}{x}\int_0^{x^2} e^{-t^2}\dee{t}\)">6.3.5</a>.</p>
<p id="p-7886">You don't have to find the best possible value for \(M\text{.}\) A reasonable upper bound on \(|f''(x)|\) will do.</p>
<p id="p-7887">To have five decimal places of accuracy, your error must be less than 0.000005. This ensures that, if you round your approximation to five decimal places, they will all be correct.</p>
</div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1024" id="answer-1024"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1024"><div class="answer solution-like"><p id="p-7888">\(n\ge 259\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1024" id="solution-1024"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1024"><div class="solution solution-like">
<p id="p-7889">Let \(g(x)=\displaystyle\int_0^x\sin(\sqrt{t})\,\dee{t}\text{.}\) By the Fundamental Theorem of Calculus Part 1, \(g'(x)= \sin(\sqrt{x})\text{.}\) By its definition, \(f(x)=g(x^2)\text{,}\) so we use the chain rule to differentiate \(f(x)\text{.}\)</p>
<div class="displaymath">
\begin{gather*}
f'(x)=2xg'(x^2)=2x\sin x\qquad\qquad
f''(x)=2\sin x+2x\cos x
\end{gather*}
</div>
<p data-braille="continuation">Since \(|\sin x|,|\cos x|\le 1\text{,}\) we have \(|f''(x)|\le 2+2|x|\) and, for \(0\le t\le 1\text{,}\) \(|f''(t)|\le 4\text{.}\) When the trapezoidal rule with \(n\) subintervals is applied, the resulting error \(E_n\) obeys</p>
<div class="displaymath">
\begin{align*}
E_n&amp;\le\frac{4(1-0)^3}{12n^2}=\frac{1}{3n^2}\\
\end{align*}
<p class="intertext">We want an integer \(n\) such that</p>
\begin{align*}
\frac{1}{3n^2}&amp;\le 0.000005\\
n^2&amp;\ge \frac{4}{12\times 0.000005}\\
n&amp;\ge\sqrt{ \frac{1}{3\times 0.000005}} \approx258.2
\end{align*}
</div>
<p data-braille="continuation">Any integer \(n \geq 259\) will do.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="prob_s1_11_exactM"><h6 class="heading"><span class="codenumber">31<span class="period">.</span></span></h6>
<p id="p-7890">Let \(f(x)\) be a function <a data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-267" id="fn-267"><sup> 18 </sup></a> with \(f''(x) = \dfrac{x^2}{x+1}\text{.}\)</p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-267"><div class="fn">For example, \(f(x)=\frac{1}{6}x^3-\frac{1}{2}x^2+(1+x)\log|x+1|\) will do, but you don't need to know what \(f(x)\) is for this problem.</div></div>
<ol id="p-7891" class="lower-alpha">
<li id="li-2953">Show that \(|f''(x)| \leq 1\) whenever \(x\) is in the interval \([0,1]\text{.}\)</li>
<li id="li-2954">Find the maximum value of \(|f''(x)|\) over the interval \([0,1]\text{.}\)</li>
<li id="li-2955">Assuming \(M=1\text{,}\) how many intervals should you use to approximate \(\displaystyle\int_{0}^{1}f(x) \dee{x}\) to within \(10^{-5}\text{?}\)</li>
<li id="li-2956">Using the value of  \(M\) you found in (b), how many intervals should you use to approximate \(\displaystyle\int_0^1 f(x) \dee{x}\) to within \(10^{-5}\text{?}\)</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-943" id="hint-943"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-943"><div class="hint solution-like"><p id="p-7892">To find the maximum value of \(|f''(x)|\text{,}\) check its critical points and endpoints.</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1025" id="answer-1025"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1025"><div class="answer solution-like">
<p id="p-7893">(a) When \(0 \leq x \leq1\text{,}\) then \(x^2 \leq 1\) and \(x+1 \geq 1\text{,}\) so</p>
<div class="displaymath">
\begin{equation*}
|f''(x)| = \dfrac{x^2}{|x+1|}\leq \dfrac{1}{1}=1
\end{equation*}
</div>
<p id="p-7894">(b) \(\dfrac{1}{2}\)</p>
<p id="p-7895">(c) \(n \geq 65\)</p>
<p id="p-7896">(d) \(n \geq 46\)</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1025" id="solution-1025"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1025"><div class="solution solution-like">
<ol id="p-7897" class="lower-alpha">
<li id="li-2957">When \(0 \leq x \leq1\text{,}\) then \(x^2 \leq 1\) and \(x+1 \geq 1\text{,}\) so \(|f''(x)| = \dfrac{x^2}{|x+1|}\leq \dfrac{1}{1}=1\text{.}\)</li>
<li id="li-2958">
<p id="p-7898">To find the maximum value of a function over a closed interval, we test the function's values at the endpoints of the interval and at its critical points inside the interval. The critical points are where the function's derivative is zero or does not exist.</p>
<p id="p-7899">The function we're trying to maximize is \(|f''(x)| = \frac{x^2}{|x+1|} = \frac{x^2}{x+1}=f''(x)\) (since our interval only contains nonnegative numbers). So, the critical points occur when \(f'''(x) = 0\) or does not exist. We find \(f'''(x)\) Using the quotient rule.</p>
<div class="displaymath">
\begin{align*}
f'''(x)&amp;=\frac{(x+1)(2x)-x^2}{(x+1)^2}=\frac{x^2+2x}{(x+1)^2}\\
0&amp;=\frac{x(x+2)}{x+1}\\
0&amp;=x \quad\mbox{or}\quad x=-1\quad\mbox{or}\quad x=-2
\end{align*}
</div>
<p data-braille="continuation">The only critical point in \([0,1]\) is \(x=0\text{.}\) So, the extrema of \(f''(x)\) over \([0,1]\) will occur at its endpoints. Indeed, since \(f'''(x) \geq 0\) for all \(x\) in \([0,1]\text{,}\) \(f''(x)\) is increasing over this interval, so its maximum occurs at \(x=1\text{.}\) That is,</p>
<div class="displaymath">
\begin{equation*}
|f''(x)|\leq f''(1)=\frac{1}{2}
\end{equation*}
</div>
</li>
<li id="li-2959">The absolute  error using the midpoint rule is at most \(\dfrac{M(b-a)^3}{24n^2}\text{.}\) Using \(M=1\text{,}\) if we want this to be no more than \(10^{-5}\text{,}\) we find an acceptable value of \(n\) with the following calculation:<div class="displaymath">
\begin{align*}
\dfrac{M(b-a)^3}{24n^2}&amp;\leq 10^{-5}\\
\dfrac{1}{24n^2}&amp;\leq 10^{-5}&amp;(b-a=1,\,M=1)\\
\frac{10^5}{24} &amp; \leq n^2\\
n &amp; \geq 65
\end{align*}
</div>
</li>
<li id="li-2960">The absolute  error using the midpoint rule is at most \(\dfrac{M(b-a)^3}{24n^2}\text{.}\) Using \(M=\frac{1}{2}\text{,}\) if we want this to be no more than \(10^{-5}\text{,}\) we find an acceptable value of \(n\) with the following calculation:<div class="displaymath">
\begin{align*}
\dfrac{M(b-a)^3}{24n^2}&amp;\leq 10^{-5}\\
\dfrac{1}{48n^2}&amp;\leq 10^{-5}&amp;(b-a=1,\,M=\frac{1}{2})\\
\frac{10^5}{48} &amp; \leq n^2\\
n &amp; \geq 46
\end{align*}
</div>
</li>
</ol>
<p data-braille="continuation">Remark: how accurate you want to be in these calculations depends a lot on your circumstances. Imagine, for instance, that you were finding \(M\) by hand, using this to find \(n\) by hand, then programming a computer to evaluate the approximation. For a simple integral like this, the difference between computing time for 65 intervals versus 46 is likely to be miniscule. So, there's not much to be gained by the extra work in (b). However, if your original sloppy \(M\) gave you something like \(n=1000000\text{,}\) you might want to put some time into improving it, to shorten computation time. Moreover, if you were finding the approximation by hand, the difference between adding 46 terms and adding 65 terms would be considerable, and you would probably want to put in the effort up front to find the most accurate \(M\) possible.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1026"><h6 class="heading"><span class="codenumber">32<span class="period">.</span></span></h6>
<p id="p-7900">Approximate the function \(\log x\) with a rational function by approximating the integral \(\displaystyle\int_1^{x\vphantom{\frac{1}{2}}} \frac{1}{t} \dee{t}\) using Simpson's rule. Your rational function \(f(x)\)  should approximate \(\log x\) with an error of not more than 0.1 for any \(x\) in the interval \([1,3]\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-944" id="hint-944"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-944"><div class="hint solution-like"><p id="p-7901">In using Simpson's rule to approximate \(\displaystyle\int_1^{x\vphantom{\frac{1}{2}}} \frac{1}{t} \dee{t}\) with \(n\) intervals, \(a=1\text{,}\) \(b=x\text{,}\) and \(\De x = \dfrac{x-1}{n}\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1026" id="answer-1026"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1026"><div class="answer solution-like"><p id="p-7902">\(\displaystyle\frac{x-1}{12}\left[1+\frac{16}{x+3}+\frac{4}{x+1}+\frac{16}{3x+1}+\frac{1}{x}\right]\)</p></div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1026" id="solution-1026"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1026"><div class="solution solution-like">
<p id="p-7903">Before we can take our Simpson's rule approximation of \(\displaystyle\int_1^x \dfrac{1}{t} \dee{t}\text{,}\) we need to know how many intervals to use. That means we need to bound our error, which means we need to bound \(\ddiff{4}{}{t}\left\{\frac{1}{t}\right\}\text{.}\)</p>
<div class="displaymath">
\begin{align*}
\diff{}{t}\left\{\frac{1}{t}\right\}&amp;=-\frac{1}{t^2}&amp;
\ddiff{2}{}{t}\left\{\frac{1}{t}\right\}&amp;=\frac{2}{t^3}\\
\ddiff{3}{}{t}\left\{\frac{1}{t}\right\}&amp;=-\frac{6}{t^4}&amp;
\ddiff{4}{}{t}\left\{\frac{1}{t}\right\}&amp;=\frac{24}{t^5}
\end{align*}
</div>
<p data-braille="continuation">So, over the interval \([1,3]\text{,}\) \(\displaystyle\left|\ddiff{4}{}{t}\left\{\frac{1}{t}\right\}\right| \leq 24\text{.}\)</p>
<p id="p-7904">Now, we can find an appropriate \(n\) to ensure our error will be be less than 0.1 for any \(x\) in \([1,3]\text{:}\)</p>
<div class="displaymath">
\begin{align*}
\frac{L(b-a)^5}{180 n^4}&amp; \lt 0 .1\\
\frac{24(x-1)^5}{180 n^4}&amp; \lt  \frac{1}{10}\\
n^4 &amp; \gt  \frac{24\cdot (x-1)^5}{18}\\
\end{align*}
<p class="intertext">Because \(x-1 \leq 2\) for every \(x\) in \([1,3]\text{,}\) if \(n^4  \gt  \dfrac{24\cdot 2^5}{18}\text{,}\) then \(n^4  \gt  \dfrac{24\cdot (x-1)^5}{18}\) for every allowed \(x\text{.}\)</p>
\begin{align*}
n^4&amp; \gt   \frac{24\cdot 2^5}{18}= \frac{128}{3}\\
n&amp; \gt \sqrt[4]{\frac{128}{3}}\approx  2.6
\end{align*}
</div>
<p data-braille="continuation">Since \(n\) must be even, \(n=4\) is enough intervals to guarantee our error is not too high for any \(x\) in \([1,3]\text{.}\) Now we find our Simpson's rule approximation with \(n=4\text{,}\) \(a=1\text{,}\) \(b=x\text{,}\)  and \(\Delta x = \dfrac{x-1}{4}\text{.}\) The points where we evaluate \(\frac{1}{t}\) are:</p>
<div class="displaymath">
\begin{align*}
x_0 =&amp; 1 &amp; 
x_1&amp;=1+ \frac{x-1}{4}&amp; x_2&amp;=1+2\cdot\frac{x-1}{4}&amp;\\
&amp;  &amp; &amp;=\frac{x+3}{4}&amp;       &amp;=\frac{x+1}{2}&amp;\\
&amp;  &amp;x_3&amp;=1+3\cdot\frac{x-1}{4}&amp; x_4&amp;=1+4\cdot\frac{x-1}{4}\\
&amp;  &amp;   &amp;=\frac{3x+1}{4}&amp;           &amp;=x
\end{align*}
</div>
<div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-817.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
<div class="displaymath" id="p-7905">
\begin{align*}
\log x=\int_1^x \frac{1}{t} \dee{t}&amp;\approx \frac{\De x}{3}\left[\frac{1}{x_0}+\frac{4}{x_1}+\frac{2}{x_2}+\frac{4}{x_3}+\frac{1}{x_4}\right]\\
&amp;=\frac{x-1}{12}\left[1+\frac{16}{x+3}+\frac{4}{x+1}+\frac{16}{3x+1}+\frac{1}{x}\right]\\
&amp;=f(x)
\end{align*}
</div>
<p id="p-7906">Below is a graph of our approximation \(f(x)\) and natural logarithm on the same axes. The natural logarithm function is shown red and dashed, while our approximating function is solid blue. Our approximation appears to be quite accurate for small, positive values of \(x\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;"><div class="sbspanel" style="width:100%;justify-content:flex-start;"><img src="images/image-818.svg" role="img" style="width: 100%; height: auto;" alt=""></div></div></div>
</div></div>
</div></article><article class="exercise exercise-like" id="exercise-1027"><h6 class="heading"><span class="codenumber">33<span class="period">.</span></span></h6>
<p id="p-7907">Using an approximation of the area under the curve \(\dfrac{1}{x^2+1}\text{,}\) show that the constant \(\arctan2\) is in the interval \(\left[\dfrac{\pi}{4}+0.321,\, \dfrac{\pi}{4}+0.323\right]\text{.}\)</p>
<p id="p-7908">You may assume use without proof that \(\displaystyle\ddiff{4}{}{x}\left\{\frac{1}{1+x^2}\right\} = \dfrac{24(5x^4-10x^2+1)}{(x^2+1)^5}\text{.}\) You may use a calculator, but only to add, subtract, multiply, and divide.</p>
<div class="solutions">
<a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-945" id="hint-945"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-945"><div class="hint solution-like"><ul id="p-7909" class="disc">
<li id="li-2961">\(\int_1^2 \frac{1}{1+x^2} \dee{x} = \arctan(2) - \frac{\pi}{4}\text{,}\) so \(\arctan(2) = \frac{\pi}{4}+\int_1^2 \frac{1}{1+x^2} \dee{x}\)</li>
<li id="li-2962">If an approximation \(A\) of the integral \(\int_1^2 \frac{1}{1+x^2} \dee{x}\) has error at most \(\varepsilon\text{,}\) then \(A-\varepsilon \leq \int_1^2 \frac{1}{1+x^2} \dee{x} \leq A+\varepsilon\text{.}\)</li>
<li id="li-2963">Looking at our target interval will tell you how small \(\varepsilon\) needs to be, which in turn will tell you how many intervals you need to use.</li>
<li id="li-2964">You can show, by considering the numerator and denominator separately, that \(|f^{(4)}(x)| \leq 30.75\) for every \(x\) in \([1,2]\text{.}\)</li>
<li id="li-2965">If you use Simpson's rule to approximate \(\int_1^2 \frac{1}{1+x^2} \dee{x}\text{,}\) you won't need very many intervals to get the requisite accuracy.</li>
</ul></div></div>
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-1027" id="answer-1027"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-1027"><div class="answer solution-like">
<p id="p-7910">Note: for more detail, see the solutions.</p>
<p id="p-7911">First, we use Simpson's rule with \(n=4\)  to approximate \(\int_1^2 \frac{1}{1+x^2}\,\dee{x}\text{.}\) The choice of this method (what we're approximating, why \(n=4\text{,}\) etc.) is explained in the solutions--here, we only show that it works.</p>
<div class="displaymath">
\begin{equation*}
\int_1^2 \frac{1}{1+x^2}\,\dee{x} \approx\frac{1}{12}\left[
\frac{1}{2} + \frac{64}{41}+\frac{8}{13}+\frac{64}{65}+\frac{1}{5}
\right]\approx 0.321748 
\end{equation*}
</div>
<p id="p-7912">For ease of notation, define \(A=0.321748\text{.}\)</p>
<p id="p-7913">Now, we bound the error associated with this approximation. Define \(N(x) = 24(5x^4-10x^2+1)\) and \(D(x) = (x^2+1)^5\text{,}\) so \(N(x)/D(x)\) gives the fourth derivative of \(\frac{1}{1+x^2}\text{.}\) When \(1 \le x \le 2\text{,}\) \(|N(x)| \le N(2)=984\) (because \(N(x)\) is increasing over that interval) and \(|D(x)| \geq D(1) = 2^5\) (because \(D(x)\) is also increasing over that interval), so \(\left| \ddiff{4}{}{x}\left\{\frac{1}{1+x^2}\right\}\right| = \left| \frac{N(x)}{D(x)}\right| \leq \frac{984}{2^5}=30.75\text{.}\) Now we find the error bound for Simpson's rule with \(L=30.75\text{,}\) \(b=2\text{,}\) \(a=1\text{,}\) and \(n=4\text{.}\)</p>
<div class="displaymath">
\begin{equation*}
\left| \int_1^2 \frac{1}{1+x^2}\,\dee{x} - A\right| =|\text{error}| \leq \frac{L(b-a)^5}{180\cdot n^4}\
=\frac{30.75}{180\cdot 4^4} \lt 0.00067
\end{equation*}
</div>
<p id="p-7914">So,</p>
<div class="displaymath">
\begin{align*}
-0.00067 &amp; \lt  \int_1^2 \frac{1}{1+x^2}\,\dee{x} - A  \lt  0.00067\\
A-0.0067 &amp; \lt  \int_1^2 \frac{1}{1+x^2}\,\dee{x}   \lt  A+0.00067\\
A-0.00067 &amp; \lt  \arctan(2)-\arctan(1)  \lt  A+0.00067\\
A-0.00067 &amp; \lt \arctan(2)-\frac{\pi}{4}  \lt  A+0.00067\\
\frac{\pi}{4}+A-0.00067 &amp; \lt \arctan(2) \lt \frac{\pi}{4}+ A+0.00067\\
\frac{\pi}{4}+0.321748-0.00067 &amp; \lt  \arctan(2)  \lt \frac{\pi}{4}+0.321748+0.00067\\
\frac{\pi}{4}+0.321078 &amp; \lt \arctan(2) \lt \frac{\pi}{4}+0.322418\\
\frac{\pi}{4}+0.321 &amp; \lt \arctan(2) \lt \frac{\pi}{4}+0.323
\end{align*}
</div>
<p data-braille="continuation">This was the desired bound.</p>
</div></div>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-1027" id="solution-1027"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-1027"><div class="solution solution-like">
<p id="p-7915">First, we want a strategy for approximating \(\arctan 2\text{.}\) Our hints are that involves integrating \(\dfrac{1}{1+x^2}\text{,}\) which is the antiderivative of arctangent, and the number \(\dfrac{\pi}{4}\text{,}\) which is the same as \(\arctan(1)\text{.}\) With that in mind:</p>
<div class="displaymath">
\begin{align*}
\int_1^2 \frac{1}{1+x^2} \dee{x}&amp; = \arctan(2) - \arctan(1) = \arctan(2) - \frac{\pi}{4}\\
\text{So, }\qquad \arctan(2) &amp;= \frac{\pi}{4} + \int_1^2 \frac{1}{1+x^2} \dee{x}\tag{$*$}\\
\end{align*}
<p class="intertext">We won't know the value of the integral exactly, but we'll have an approximation \(A\) bounded by some positive error bound \(\varepsilon\text{.}\) Then,</p>
\begin{align*}
- \varepsilon &amp;\leq \left(\int_1^2 \frac{1}{1+x^2} \dee{x} - A\right) \leq \varepsilon\\
A - \varepsilon &amp;\leq \left(\int_1^2 \frac{1}{1+x^2} \dee{x}\right) \leq A + \varepsilon\\
\text{So, from ($*$), }\qquad \frac{\pi}{4}+A-\varepsilon&amp; \leq \arctan(2) \leq \frac{\pi}{4}+A+\varepsilon
\end{align*}
</div>
<p id="p-7916">Which approximation should we use? We're given the fourth derivative of \(\dfrac{1}{1+x^2}\text{,}\) which is the derivative we need for Simpson's rule.  Simpson's rule  is also usually quite efficient, and we're very interested in not adding up dozens of terms, so we  choose Simpson's rule.</p>
<p id="p-7917">Now that we've chosen Simpson's rule, we should decide how many intervals to use. In order to bound our error, we need to find a bound for the fourth derivative. To that end, define \(N(x) = 24(5x^4-10x^2+1)\text{.}\) Then \(N'(x) = 24(20x^3-20x)= 480x(x^2-1)\text{,}\) which is positive over the interval \([1,2]\text{.}\) So, \(N(x) \leq N(2)=24(5\cdot 2^4 - 10\cdot 2^2+1)=984\) when \(1 \leq x \leq 2\text{.}\) Furthermore, let \(D(x)=(x^2+1)^5\text{.}\) If  \(1 \leq x \leq 2\text{,}\) then \(D(x) \geq 2^5\text{.}\) Now we can find   a reasonable value of \(L\text{:}\)</p>
<div class="displaymath">
\begin{align*}
|f^{(4)}(x)|&amp;=\left|\frac{25(5x^4-10x^2+1)}{(x^2+1)^5}\right| =
\left|\frac{N(x)}{D(x)}\right| \leq \frac{984}{2^5} = \frac{123}{4} = 30.75
\end{align*}
</div>
<p data-braille="continuation">So, we take \(L=30.75\text{.}\)</p>
<p id="p-7918">We want \(\left[\dfrac{\pi}{4}+A-\varepsilon ,\, \dfrac{\pi}{4}+A+\varepsilon \right]\) to look something like \(\left[\dfrac{\pi}{4}+0.321,\, \dfrac{\pi}{4}+0.323\right]\text{.}\) Note \(\varepsilon\) is half the length of the first interval. Half the length of the second interval is \(0.001 = \frac{1}{1000}\text{.}\) So, we want a value of \(\varepsilon\) that is no larger than this. Now we can find our \(n\text{:}\)</p>
<div class="displaymath">
\begin{align*}
\dfrac{L(b-a)^5}{180\cdot n^4} &amp;\leq \frac{1}{1000}\\
\dfrac{30.75}{180\cdot n^4} &amp;\leq \frac{1}{1000}\\
n^4 &amp; \geq \frac{30.75\times 1000}{180}\\
n &amp; \geq \sqrt[4]{\frac{30750}{180}}\approx 3.62
\end{align*}
</div>
<p id="p-7919">So, we choose \(n=4\)), and are guaranteed that the absolute error in our approximation will be no more than \(\dfrac{30.75}{180\cdot 4^4}  \lt  0.00067\text{.}\)</p>
<p id="p-7920">Since \(n=4\text{,}\) then \(\De x = \dfrac{b-a}{n}=\dfrac{1}{4}\text{,}\) so:</p>
<div class="displaymath">
\begin{equation*}
x_0 = 1 \qquad x_1=\frac{5}{4} \qquad x_2 = \frac{3}{2} \qquad x_3 = \frac{7}{4} \qquad x_4=2
\end{equation*}
</div>
<p id="p-7921">Now we can find our Simpson's rule approximation \(A\text{:}\)</p>
<div class="displaymath">
\begin{align*}
&amp;\int_0^1 \frac{1}{1+x^2} \dee{x}\approx \frac{\De x}{3}\big[
f(x_0) + 4f(x_1)+2f(x_2)+4f(x_3)+f(x_4)
\big]\\
&amp;\hskip0.25in=\frac{1/4}{3}\big[
f(1) + 4f(5/4)+2f(3/2)+4f(7/4)+f(2)
\big]\\
&amp;\hskip0.25in=\frac{1}{12}\left[
\frac{1}{1+1} + \frac{4}{25/16+1}+\frac{2}{9/4+1}+\frac{4}{49/16+1}+\frac{1}{4+1}
\right]\\
&amp;\hskip0.25in=\frac{1}{12}\left[
\frac{1}{2} + \frac{4\cdot 16}{25+16}+\frac{2\cdot 4}{9+4}+\frac{4\cdot 16}{49+16}+\frac{1}{5}
\right]\\
&amp;\hskip0.25in=\frac{1}{12}\left[
\frac{1}{2} + \frac{64}{41}+\frac{8}{13}+\frac{64}{65}+\frac{1}{5}
\right]\\
&amp;\hskip0.25in\approx 0.321748=A
\end{align*}
</div>
<p id="p-7922">As we saw before, the error associated with this approximation is at most \(\dfrac{30.75}{180\cdot 4^4}  \lt  0.00067=\varepsilon\text{.}\) So,</p>
<div class="displaymath">
\begin{align*}
&amp;&amp;A-\varepsilon &amp;\leq \int_1^2\frac{1}{1+x^2} \dee{x} \leq A+\varepsilon\\
&amp;\Rightarrow&amp;0.321748 - 0.00067 &amp;\leq \int_1^2\frac{1}{1+x^2} \dee{x}\leq 0.321748 + 0.00067\\
&amp;\Rightarrow&amp;0.321078 &amp;\leq \int_1^2\frac{1}{1+x^2} \dee{x}\leq 0.322418\\
&amp;\Rightarrow&amp;0.321 &amp;\leq\int_1^2\frac{1}{1+x^2} \dee{x}\leq 0.323\\
&amp;\Rightarrow&amp;\frac{\pi}{4}+0.321 &amp; \leq\int_1^2\frac{1}{1+x^2} \dee{x}+\frac{\pi}{4}\leq \frac{\pi}{4}+0.323\\
&amp;\Rightarrow&amp;\frac{\pi}{4}+0.321 &amp; \leq \arctan(2) \leq \frac{\pi}{4}+0.323;
\end{align*}
</div>
<p id="p-7923">This is precisely what we wanted to show.</p>
</div></div>
</div></article>
</div>
</div></section></section></div></main>
</div>
</body>
</html>
