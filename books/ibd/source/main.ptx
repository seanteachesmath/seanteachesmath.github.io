<?xml version="1.0" encoding="UTF-8" ?>
<!-- Generated by Pandoc using pretext.lua -->
<pretext>
<article>



	<paragraphs xml:id="disclaimer.">
		<title>Disclaimer.</title>

		<p>
			These notes were originally written for MATH 056 at Swarthmore College and subsequently quite heavily modifited for courses taught at the University of Central Oklahoma. This course was developed and taught as MATH 056 in Fall 2011, and subsequently as MATH 4910/5910 in the Spring of 2013, 2015, and 2017. These notes were inspired by a course that I took as a first year graduate student at the University of Utah which was taught by Fred Adler.
		</p>

		<p>
			Additional references used in the development of these notes (unfortunately at this point in time uncited within the text) are listed on the last page.
		</p>

		<p>
			The structure of these notes might be jarring, but the goal is to facilitate rapid entry to inspired, independent investigations of interesting questions. Often books begin with discrete-time mathematical models (which are conceptually and mathematically interesting, but not of interest to most students), then spend a bit of time in one- and two-dimensional, continuous-time models (which are familiar and interesting, but time consuming and of limited applicability in many ’real-world’ situations). The goal here is introduce a few broad ideas of mathematical modeling and to take an early look at stochastic processes and to introduce modeling that scales to higher dimensional problems. Both of these approaches rely quite heavily on numerical tools.
		</p>

		<p>
			Please write <url href="mailto:slaverty@uco.edu?subject=MATH_4910_Notes">slaverty@uco.edu</url> with questions, comments, concerns, or suggestions.
		</p>

	</paragraphs>

	<section xml:id="introduction">
		<title>Introduction</title>


		<subsection xml:id="modeling-fundamentals">
			<title>Modeling fundamentals</title>

		</subsection>

		<subsection xml:id="one-dimensional-continuous-time-models">
			<title>One-dimensional, continuous-time models</title>

			<figure>
	<image source="coin_flips.pdf"/>
				<caption>Coin-flipping simulations of a death process.</caption>
</figure>


			<subsubsection xml:id="review">
				<title>Review</title>

				<p>
					Following the introduction of birth-immigration-death-emigration (BIDE)<fn>				<p>
					We sometimes call this BIDE because it is slightly more pronounceable than BDIE, and because it emphasizes and groups the <sq>gain</sq> terms and the <sq>loss</sq> terms.
				</p></fn> models <me>\dfrac{dN}{dt} = rn, \text{where }r = b-m</me> and <me>\dfrac{dN}{dt} = rn - g, \text{where additionally \(g\) is the emigration rate}</me> we were challenged to consider models of immigration. Let <m>a</m> denote the <sq>arrival</sq> or immigration rate. The model becomes <me>\dfrac{dN}{dt} = rn + a</me>
				</p>

				<p>
					The equilibrium is found from <m>\dfrac{dN}{dt} = 0</m> or setting and solving <m>0 = rN^* + a</m>. Hence, the equilibrium is <m>n^* = -\dfrac{a}{r}</m>. Now, this only makes sense when <m>r&lt;0</m>, otherwise <m>N^*</m> itself is negative. If <m>r&gt;0</m> the population grows naturally, aided more so by immigration.
				</p>

			</subsubsection>

			<subsubsection xml:id="model-classification">
				<title>Model classification</title>

				<p>
					Given very limited exposure to mathematical models, it is worth pausing to see how this model fits into a broader context. We will pause from work developing and analyzing specific models to look at the features of our model(s) so far, and what other alternatives are available to us: dimension, linearity versus nonlinearity, qualitative versus quantitative analysis, and determinism versus stochasticity.
				</p>


				<paragraphs xml:id="dimension">
					<title>Dimension</title>

					<p>
						The dimension of a mathematical model refers to the number of variables being tracked. For example, <me>\dfrac{dN}{dt} = rN</me> is a one-dimensional (1D) ordinary differential equations model for <m>N(t)</m>. Tracking additional populations (e.g., other species) or subpopulations (e.g., groups or strata within a species) requires models of higher dimensions, soon enough we will arrive at these.
					</p>

				</paragraphs>

				<paragraphs xml:id="linearity">
					<title>Linearity</title>

					<p>
						Mathematical models that ignore <em>interactions</em> between individuals are linear models (for example, on the right hand side of the differential equation). Explicitly modeling interactions between individuals introduces nonlinearities into the model. This happens regardless of the model dimension. We can study 1D nonlinear models (that include interactions between individuals) or higher-dimensional nonlinear models.
					</p>

				</paragraphs>

				<paragraphs xml:id="quantitative-and-qualitative-analyses">
					<title>Quantitative and qualitative analyses</title>

					<p>
						Trained as mathematicians, we are much more likely to be familiar with exact or <sq>quantitative</sq> approaches, methods, or solutions. In particular, when we imagine the solution to a particular problem we are likely to expect
					</p>

					<p><ul>
						<li>
											<p>
						a specific formula, or
					</p>
						</li>

						<li>
											<p>
						a specific numerical value
					</p>
						</li>

					</ul></p>

					<p>
						Despite this, there is much room for <sq>qualitative</sq> or more descriptive approaches, methods, or solutions. In particular, through development and analysis of mathematical models we want to gain an appreciation for qualitative (graphical) solutions. To compare the two, we will outline potential pros and cons, or strengths and drawbacks. But, as one develops experience, what once may have seemed like a drawback might begin to look more and more like a strength of a particular approach.
					</p>


					<paragraphs xml:id="drawbacks-of-qualitative-analysis">
						<title>Drawbacks of qualitative analysis</title>

						<p>
							Perhaps the biggest drawback of qualitative methods is that we are really limited to applying these approaches to models of lower dimension. These methods work well for models of 1 or 2 dimensions (i.e., variables). Occasionally we are lucky enough to have opportunities to view higher dimensional systems in lower dimension by clever analysis techniques, so we can stretch the territory of qualitative methods a bit in some cases. We are able to get <em>only</em> broad information about our solutions or the behaviors of our model<fn>						<p>
							if you omit the word only, however, this potential drawback looks suspiciously like a strength.
						</p></fn>. We could distinguish between
						</p>

						<p><ul>
							<li>
													<p>
							oscillations or not, or
						</p>
							</li>

							<li>
													<p>
							growth or decay
						</p>
							</li>

						</ul></p>

						<p>
							and identify conditions under which these behaviors occur.
						</p>

					</paragraphs>

					<paragraphs xml:id="strengths-of-qualitative-analysis">
						<title>Strengths of qualitative analysis</title>

						<p>
							Qualitative analysis requires minimal assumptions about the numerical values for rates (parameters), which in many cases are hard to find, especially at the beginning of a project. This analysis can also help give information about interesting relationships between parameters. In particular, based on the discussion above, understanding under which parameters oscillations occur or not, or under which parameters solutions grow or decay, is powerful information.
						</p>

					</paragraphs>

					<paragraphs xml:id="drawbacks-of-quantitative-analysis">
						<title>Drawbacks of quantitative analysis</title>

						<p>
							Counter to our intuition, <sq>closed form</sq> solutions to interesting models are often impossible to find or are uselessly complex when found. If we seek numerical solutions or graphs of analytical solutions, we need precise numerical values for initial conditions and parameters. For example, when applying our qualitative methods to our emigration model, we found that <m>N^* = \dfrac{g}{r}</m>. This analysis require little, if any, assumptions on <m>g</m> and <m>r</m> other than that they were <sq>some positive values.</sq>
						</p>

					</paragraphs>

					<paragraphs xml:id="strengths-of-quantitative-analysis">
						<title>Strengths of quantitative analysis</title>

						<p>
							Sometimes we get lucky and models are solvable and solutions provide intuition. In other cases, even <sq>good guesses</sq> of parameter values can help generate <q>intuition building</q>’ numerical results about the model and its dynamics.
						</p>

					</paragraphs>
				</paragraphs>

				<paragraphs xml:id="deterministic-or-stochastic-models">
					<title>Deterministic or stochastic models</title>

					<p>
						Models presented so far have been deterministic, meaning that the structure of the model, combine with its initial conditions and parameter values completely determine the behavior of the solutions. In contrast, to this are stochastic models in which each application or investigation of the model gives a unique realization of the dynamics. In other words, the same model and conditions can give rise to <term>very</term> different dynamics. These are connected in that we understand the deterministic analog of a stochastic model to capture the mean behavior (see Fig <xref ref="fig::det_stoch" />).
					</p>

					<figure>
	<image source="coin_flips_1000.pdf"/>
						<caption>Results of 1000 stochastic simulations (colored) and exponential solution to the deterministic model <m>\dfrac{dN}{dt} = rN</m> with white dots indicating the mean of simulations at each generation.</caption>
</figure>

					<p>
						Keep in mind that both deterministic models and stochastic models have their place in mathematical modeling, but that more importantly each allows us to apply different methods and to ask different questions.
					</p>


					<paragraphs xml:id="deterministic-models">
						<title>Deterministic models</title>

						<p>
							In general we are unable to investigate certain questions about extinction with models like <me>\dfrac{dN}{dt} = rN</me> because the solution <me>N(t) = N_0e^{rt}</me> only approaches zero in the limit as <m>t\to\infty</m> (given <m>r&lt;0</m>), but never <em>reaches</em> 0. In contrast to this, stochastic models, whose realizations are illustrated in Figs. <xref ref="fig::coin_flips" /> and <xref ref="fig::coin_flips_100" /> certainly demonstrate extinction. Moreover, the stochastic results allow a variety of new questions about phenomenon related to extinction. We could investigate things such as the variability (i.e., variance) in population size as time goes on or the average time to extinction for small populations where stochasticity might be important.
						</p>

					</paragraphs>
				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="harvesting-and-logistic-growth">
				<title>Harvesting and logistic growth</title>


				<paragraphs xml:id="key-concepts-in-continuous-time-models">
					<title>Key concepts in continuous-time models</title>

					<p>
						In dynamical systems and mathematical modeling we are often interested in the <sq>long-term</sq> behavior of solutions to our models. To lay out a few definitions and concepts we will consider a generic dynamical system, <me>\frac{d^{} {x}}{d {t}^{}}=f(x),</me> where <m>f(x)</m> is some nice function and <m>x(0)=x_0</m> is a known initial value.
					</p>


					<paragraphs xml:id="definition-equilibrium-point.">
						<title>(Definition) Equilibrium point.</title>

						<p>
							An <em>equilibrium point</em> is a value of the solution that is unchanging in time.<!-- linebreak -->For a differential equation <me>\frac{d^{} {x}}{d {t}^{}}=f(x),</me> <m>x^*</m> is an <em>equilibrium point</em> if <m>f(x^*)=0</m>. Stability of equilibria helps us characterize the long term behavior of a model using information from equilibria. While there are mathematical varieties of <em>stability</em> we will consider <em>local asymptotic</em> stability.
						</p>


						<paragraphs xml:id="definition-stable-equilibrium-point.">
							<title>(Definition) Stable equilibrium point.</title>

							<p>
								A <em>stable equilibrium point</em> attracts solutions that start nearby, alternatively, it is stable if small perturbations from the equilibrium decay to zero.<!-- linebreak -->An equilibrium <m>x^*</m> of a dynamical system is a <em>stable equilibrium point</em> if solutions starting ‘near‘ <m>x^*</m> approach <m>x^*</m> in time.
							</p>

						</paragraphs>

						<paragraphs xml:id="definition-unstable-equilibrium-point.">
							<title>(Definition) Unstable equilibrium point.</title>

							<p>
								An <em>unstable equilibrium point</em> repels solutions that start nearby, alternatively, it is unstable if small perturbations from the equilibrium grow.<!-- linebreak -->An equilibrium <m>x^*</m> of a dynamical system is an <em>unstable equilibrium point</em> if solutions starting ‘near‘ <m>x^*</m> diverge from <m>x^*</m> in time.
							</p>

							<p>
								For the remainder of this section, we will study the logistic growth equation, its relationship to the discrete logistic model, its relationship to disease transmission in a closed population, and a few extensions. The logistic growth equation is given by,<me>\frac{d^{} {N}}{d {t}^{}}=rN\Big(1-\frac{N}{K}\Big).</me> Let <m>N^*</m> be an equilibrium point, so that we can write <m>N(t)=N^*+n(t).</m> We will derive a stability condition for an arbitrary equilibrium point, starting by identifying the dynamics of <m>n(t)</m>, <me>\begin{aligned}
\frac{d^{} {N}}{d {t}^{}}&amp;=\frac{d^{} {}}{d {t}^{}}\Big(N^*+n(t)\Big)\\
&amp;=0+\frac{d^{} {n}}{d {t}^{}}.\end{aligned}</me> Now, substituting the formula for <m>N(t)</m> and expanding, <me>\begin{aligned}
\frac{d^{} {n}}{d {t}^{}}&amp;= \frac{d^{} {N}}{d {t}^{}}\\
&amp;=r(N^*+n)\Big(1-\frac{N^*+n}{K}\Big)\\
&amp;=rN^*\Big(1-\frac{N^*+n}{K}\Big)+rn\Big(1-\frac{N^*+n}{K}\Big)\\
&amp;=\cancel{rN^*\Big(1-\frac{N^*}{K}\Big)}-\frac{rN^*n}{K}+rn\Big(1-\frac{N^*}{K}\Big)-\cancel{\frac{rn^2}{K}}\\
&amp;=r\Big(1-\frac{2N^*}{K}\Big)n\\
\frac{d^{} {n}}{d {t}^{}}&amp;= f'(N^*)n\end{aligned}</me> In the last step we can see that the terms that remain are equivalent to the derivative of <m>f(N)</m>, with respect to <m>N</m> evaluated at <m>N^*</m>. Here we linearize by substituting our formula for the solution and dropping al higher order terms in <m>n(t)</m>. You could do this, more formally or generally, by Taylor series.
							</p>

							<p>
								Solutions to <me>\frac{d^{} {n}}{d {t}^{}}= f'(N^*)n</me> decay to zero if <m>f'(N^*)&lt;0</m> and grow if <m>f'(N^*)&gt;0</m>. Hence, an equilibrium point <m>N^*</m> (trivial or not) is stable if <m>f'(N^*)&lt;0</m> and unstable if <m>f'(N^*)&gt;0</m>.
							</p>

							<p>
								Evaluating derivatives should work in general, but it is not our only tool. Today we will use graphical methods to develop a qualitative understanding of the dynamics of a harvested population. If we think about what our model means, we can make progress without tackling sometimes frustrating, other times uninspiring, algebra.
							</p>

						</paragraphs>
					</paragraphs>
				</paragraphs>

				<paragraphs xml:id="a-disease-model">
					<title>A disease model</title>

					<p>
						Consider a herd of Ebola-carrying zombies, where the <sq>healthy</sq> zombies are susceptible to Ebola (<m>S</m>) and the <sq>infectious</sq> zombies are capable of transmitting Ebola (<m>I</m>).
					</p>

					<p>
						=[draw, fill=blue!20, minimum size=2em, circle] =[draw, fill=red!20, minimum size=2em, circle]
					</p>

					<p>
						Much like in class we will build a word model as we go. <me>\begin{aligned}
\text{change in }S &amp; = \text{gain from recovery} - \text{loss to infection}\\
\text{change in }I &amp; = \text{loss to recovery} + \text{gain from infection},\end{aligned}</me> and replace the terms with symbols. Our <sq>first</sq> term is <sq>loss to recovery</sq> in the <m>I</m> equation. We can think of <m>\gamma</m> as the leaving rate from the <m>I</m> compartment, much like <m>m</m> was the <sq>leaving rate from the living</sq> (i.e., dying) compartment of a population model. Everything, in this model, that leaves one compartment enters another (i.e., there are no <sq>leaks</sq>). We can also argue for the infection rate as follows, since infection is only transmitted directly and by infectious hosts, we might expect that the rate that <m>S</m> individuals gain infection is proportional to the density (zombies per hectare) of infectious zombies, <m>I</m>. In fact here, we assume that the infection rate is a linearly increasing function of <m>I</m>. There are plenty of other models of transmission, some we will study in the homework, others later in the semester, still more in our projects.
					</p>

					<p>
						<me>\begin{aligned}
{2}
\text{change in }S &amp; = \text{gain from recovery} &amp;&amp;-\text{loss to infection}\\
\frac{d^{} {S}}{d {t}^{}}&amp;=\gamma I &amp;&amp; - {\beta I} S\\
\text{change in }I &amp; = \text{loss to recovery} &amp;&amp; +\text{gain from infection}\\
\frac{d^{} {I}}{d {t}^{}}&amp;=-{\gamma} I &amp;&amp; + \beta I S\\\end{aligned}</me>
					</p>

					<p>
						Since the total number of zombies <m>N</m> is preserved, we can replace the equation for <m>S</m> by an algebraic constraint <m>S=N-I</m>. We can substitute this into the equation for <m>I</m> and derive a 1-dimensional, nonlinear model,<me>\frac{d^{} {I}}{d {t}^{}}=\beta I (N-I)-\gamma I.</me> If we define our model <m>h(I)=\beta I (N-I)-\gamma I,</m> we can plot the more interesting version of our phase line as in Fig. <xref ref="fig::phase" />. Ignoring graphs for the moment, we can also compute equilibria of continuous time models, <term>defined as</term> solutions to <m>h(I^*)=0</m>. This gives <m>I^*=0</m> and <m>I^*=N-\frac{\gamma}{\beta}.</m> It might prove useful to notice that our nontrivial solution exists when <m>\gamma&lt;\beta N</m> this suggests a limitation on the recovery rate that depends on the contact parameter <m>\beta</m> and the total zombie population size <m>N</m>.
					</p>

				</paragraphs>

				<paragraphs xml:id="analysis">
					<title>Analysis</title>


					<paragraphs xml:id="equilibrium">
						<title>Equilibrium</title>

					</paragraphs>

					<paragraphs xml:id="phase-line-and-stability">
						<title>Phase line and stability</title>

					</paragraphs>

					<paragraphs xml:id="solutions-and-observations">
						<title>Solutions and observations</title>

					</paragraphs>

					<paragraphs xml:id="bifurcation-diagram">
						<title>Bifurcation diagram</title>

					</paragraphs>
				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="introduction-to-stochastic-models">
				<title>Introduction to stochastic models</title>


				<paragraphs xml:id="motivation">
					<title>Motivation</title>

					<p>
						So far we have worked with deterministic models, most recently in continuous time. An example of a deterministic model is <me>\frac{d^{} {N}}{d {t}^{}}=rN,</me> where <m>r</m> is the growth rate of species <m>N</m>. The solution to such a model is <me>N(t)=N_0e^{rt},</me> where <m>N_0</m> is the initial population size. As <m>t\rightarrow\infty</m>, we have either <m>N\rightarrow 0</m> if <m>b&lt;m</m> <m>r&lt;0</m>), or <m>N\rightarrow \infty</m> if <m>b&gt;m</m> <m>r&gt;0</m>). In decaying populations <m>r&lt;0</m>), solutions decay exponentially towards zero, rather than actually reaching zero. Thus, we reach extinction asymptotically, rather than in finite time.
					</p>

					<p>
						But, at low numbers chance events become important. A single cell could divide or die. If it dies, we have extinction. If <m>r&lt;0</m> we <em>expect</em> extinction, but what about when <m>r&gt;0</m>? If <m>r&gt;0</m>, a single cell could die rather than divide, by chance, even if it <em>should</em> divide and grow in number.
					</p>

					<p>
						Since we are focusing on the fates of individual cells, it is perhaps important to think in terms of integer-valued states. Let <m>N_0=n</m> be the initial number of cells present, perhaps in come cell culture of a fascinating biological experiment. We should note that, while the process is discrete (in the number of cells), time is continuous. The number of animals changes by a single individual through births (to the right) and deaths (to the left) as illustrated in Fig. <xref ref="fig::bdp" />.
					</p>

					<p>
						=[draw, fill=white, minimum size=3em, circle] =[ fill=white, minimum size=3em, circle]
					</p>

					<p>
						To make use of the diagram in Fig. <xref ref="fig::bdp" /> we should let <me>P_n(t)=\text{Prob}(\text{counting \(n\) animals at time \(t\)}),</me> and consider how these probabilities evolve in time for all <m>n</m>. One important fact is that <me>P_i(0)=\begin{cases}1, \,\text{if \(i=n\)}\\0, \,\text{otherwise}\end{cases},</me> since we know that we start from <m>N_0=n</m> animals with absolute certainty. We can derive the differential equation by conservation, <me>\begin{aligned}
{2}
P_n(t+\Delta t) &amp; =\text{Prob(a birth)}\times\text{Prob}(\text{\(n-1\) animals at time \(t\)}) &amp;&amp;\\
&amp; +\text{Prob(a death)}\times\text{Prob}(\text{\(n+1\) animals at time \(t\)}) &amp;&amp;\\
&amp; +\text{Prob(no change)}\times\text{Prob}(\text{\(n\) animals at time \(t\)}) &amp;&amp;\end{aligned}</me> First we will apply the definition of <m>P_n(t)</m> and the others (i.e., <m>P_{n-1}(t)</m>). Notice that the equation is presented in two columns, on the left is the format <sq>in words</sq> and on the right introduces the corresponding notation, <me>\begin{aligned}
{2}
P_n(t+\Delta t) &amp; =\text{Prob(a birth)}\times\text{Prob}(\text{\(n-1\) animals at time \(t\)}) &amp;&amp;\qquad=\text{Prob(a birth)}\times P_{n-1}(t) \\
&amp; +\text{Prob(a death)}\times\text{Prob}(\text{\(n+1\) animals at time \(t\)}) &amp;&amp;\qquad+\text{Prob(a death)}\times P_{n+1}(t)\\
&amp; +\text{Prob(no change)}\times\text{Prob}(\text{\(n\) animals at time \(t\)}) &amp;&amp;\qquad+\text{Prob(no change)}\times P_{n}(t) \end{aligned}</me> Below we could also consider <m>\text{Prob(no change)}</m> as <m>(1-\text{Prob(change)})</m>, where <m>\text{Prob(change)}</m> is given by the probability of events resulting in exit <em>from</em> size <m>n</m>. The event probabilities are, <me>\begin{aligned}
{2}
P_n(t+\Delta t) &amp; =\text{Prob(a birth)}\times\text{Prob}(\text{\(n-1\) animals at time \(t\)}) &amp;&amp;\qquad=(n-1)r\Delta t P_{n-1}(t) \\
&amp; +\text{Prob(a death)}\times\text{Prob}(\text{\(n+1\) animals at time \(t\)}) &amp;&amp;\qquad+(n+1)\mu\Delta t P_{n+1}(t)\\
&amp; +\text{Prob(no change)}\times\text{Prob}(\text{\(n\) animals at time \(t\)}) &amp;&amp;\qquad+(1-nr\Delta t-n\mu\Delta t) P_{n}(t) \end{aligned}</me> Finally, we can begin rearranging to derive the differential equation for <m>P_n(t)</m>, <me>\begin{aligned}
P_n(t+\Delta t) &amp;=(n-1)r\Delta t P_{n-1}(t) +(n+1)\mu\Delta t P_{n+1}(t)+(1-nr\Delta t-n\mu\Delta t) P_{n}(t) \\
P_n(t+\Delta t) -P_n(t)&amp;=(n-1)r\Delta t P_{n-1}(t) +(n+1)\mu\Delta t P_{n+1}(t)-(nr\Delta t-n\mu\Delta t) P_{n}(t) \\
\frac{P_n(t+\Delta t) -P_n(t)}{\Delta t}&amp;=(n-1)r P_{n-1}(t) +(n+1)\mu P_{n+1}(t)-n(r -\mu) P_{n}(t) \end{aligned}</me> Now, taking the limit <m>\Delta t\rightarrow0</m>,<me>\frac{d^{} {P_n(t)}}{d {t}^{}}=(n-1)r P_{n-1}(t) +(n+1)\mu P_{n+1}(t)-(nr-n\mu) P_{n}(t) 
.</me> We have to assume that <m>P_i(t)=0</m> for any <m>i&lt;0</m>, and accept a system of coupled equations for <m>n=0, 1, 2, \dots</m>. We will study this particular model with a suite of techniques, including naive calculation, inspection, and somewhat elegant probability theory.
					</p>


					<paragraphs xml:id="naive-calculation">
						<title>Naive calculation</title>

						<p>
							Looking at the first equation for <m>n=0</m>, <me>\frac{d^{} {P_0(t)}}{d {t}^{}}=(-1)r P_{-1}(t) +(1)\mu P_{1}(t)-0\cdot (r -\mu) P_{0}(t),</me> we simplify to <me>\frac{d^{} {P_0(t)}}{d {t}^{}}= \mu P_{1}(t).</me> If we were to look at the equilibrium of <m>P_0</m>, assuming <m>\mu\neq0</m>, we would need <m>P_1(t)\rightarrow0</m>. Since <m>P_1</m> appears in the next equation, we require all <m>P_i(t)\rightarrow0</m> for <m>i&gt;0</m>. Since <m>P_i(t)</m> are probabilities, we require <m>\displaystyle\sum_0^\infty P_i(t)=1</m>, which means that <m>P_0(t)\rightarrow1</m>. This suggests that extinction is unavoidable, but a bit more work provides additional insight. Specifically populations with <m>b&gt;m</m> can escape extinction, with the probability of extinction of <me>\left(\dfrac{m}{b}\right)^{N_0}</me> which for <m>b&gt;m</m> decays geometrically as a function of the initial population size. With quite a bit of effort, this result is very nicely illustrated in classic texts.
						</p>

					</paragraphs>
				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="birth-death-processes-and-the-gillespie-algorithm">
				<title>Birth-death processes and the Gillespie algorithm</title>


				<paragraphs xml:id="a-coin-flipping-exercise">
					<title>A coin-flipping exercise</title>

					<p>
						We will simulate a pure-death process with events chosen by random <sq>coin</sq> flips.
					</p>

					<p><ol>
						<li>
											<p>
						Start with a room full of participants.
					</p>
						</li>

						<li>
											<p>
						At the start of each discrete round, everyone should flip a coin:
					</p>

					<p><ol>
						<li>
											<p>
						a <sq>head</sq> means death, so sit down and remain seated.
					</p>
						</li>

						<li>
											<p>
						a <sq>tail</sq> means survival, so keep standing.
					</p>
						</li>

					</ol></p>
						</li>

						<li>
											<p>
						Repeat until all participants have vanished, recording the number alive at the start of each round.
					</p>
						</li>

					</ol></p>

					<p>
						A sample result for two populations is plotted in Fig. <xref ref="fig::death_sim" />.
					</p>

					<figure>
	<image source="inclass_sim.pdf"/>
						<caption>Numbers of survivors in independent simulations with probability of death equal to one half. Red curve illustrates the expected number of survivors.</caption>
</figure>

				</paragraphs>

				<paragraphs xml:id="bold-claim-revisited">
					<title>Bold claim revisited</title>

					<p>
						Previously, we claimed that all populations go to extinction (in the absence of immigration). If we wish to simulate the process described in Fig. <xref ref="fig::bdp2" />, we need to track a few pieces of information: the event that occurs (a birth or a death), and the time that the event occurs. =[draw, fill=white, minimum size=3em, circle] =[ fill=white, minimum size=3em, circle]
					</p>

					<p>
						Using Fig. <xref ref="fig::bdp2" />, the <em>probability</em> that a birth occurs as the <sq>next event</sq> is <me>\operatorname{Prob}({\text{a birth}})=\frac{rn}{rn+\mu n}= \frac{r}{r+\mu},</me> and similarly for a death, <me>\operatorname{Prob}({\text{a death}})=1-\operatorname{Prob}({\text{a birth}})=1-\frac{r}{r+\mu}=\frac{\mu}{r+\mu}.</me> To determine what happens we consider the interval <m>[0,1],</m> which we divide, here, into two subintervals whose widths reflect the event probabilities above. For example, if <m>r=0</m> (<m>\mu&gt;0</m>), the probability of a birth is zero and probability of a death is one. In contrast, if <m>\mu=0</m> (<m>r&gt;0</m>), then the probability of a death is zero and the probability of a birth is one.
					</p>

					<p>
						More interesting cases occur if, for example, <m>r=8</m> and <m>\mu=2</m>, then the probability of a birth is <m>\frac{4}{5}</m> and the probability of a death is <m>\frac{1}{5}</m>. To illustrate this last case, we divide the unit interval into subintervals <m>(0, \frac{4}{5}]</m>, representing the probabilities of birth, and <m>(\frac{4}{5}, 1)</m>, representing the probabilities of death. Then we choose a uniform random number (a dart) and throw it at the divided number line (a target). The interval in which it lands identifies our next event. In this example, since <m>r&gt;&gt;\mu</m>, the probability that a birth occurs is much larger than the probability that a death occurs. Thus, the birth interval in the target is much larger than the death interval, and we are more likely to have a birth.
					</p>

					<figure>
	<image source="event_prob.pdf"/>
						<caption>A uniform random random number has an 80% chance of landing in the <sq>blue</sq> (birth) interval, making this event the more likely outcome. That said, here we have the less likely outcome of a death.</caption>
</figure>

					<p>
						Given that we can identify the event that occurs, our next task is to identify the time until the event occurs. Here we assume that he events occur at a constant rate <me>\lambda=(r+\mu)n,</me> and that the time until the next event, <m>T</m>, is exponentially distributed with parameter <m>\lambda</m>. Thus, <me>T\sim\exp(\lambda).</me> We can easily sample numbers from certain distributions. To sample exponentially distributed random numbers, we take advantage of its cumulative distribution function, <m>F(t)=1-\exp(-\lambda t)</m>. We pick a uniform random number <m>r_2</m> and solve for <m>t</m> using <m>r_2=F(t)</m> to find our even time. <me>\begin{aligned}
r_2 &amp; = F(t)\\
&amp;= 1-\exp(-\lambda t)\\
\exp(-\lambda t) &amp; = 1-r_2\\
-\lambda t &amp; =\ln(1-r_2)\\
t &amp; =-\frac{\ln(1-r_2)}{\lambda}\end{aligned}</me> Importantly, since <m>r_2</m> is a random number so is <m>1-r_2</m>. In slight abuse of notation, we relabel the argument of <m>\ln(\cdot)</m>, which is <m>1-r_2</m>, by <m>r_2</m>,<me>t =-\frac{\ln(r_2)}{\lambda}.</me> Since <m>r_2\in(0,1)</m>, the logarithm is negative, so the negative in front ensures a positive event time <m>t</m>.
					</p>

					<p>
						Now that we have identified both our event and the event eating time, <m>t</m>, we simply update our state and repeat the process for until we reach either a fixed number of events, a fixed final time, or a population that becomes extinct (or reaches some other pre-specified condition). An example solution to the birth-death process is plotted in Fig. <xref ref="fig::bdp_result" />, where unlike in Fig. <xref ref="fig::death_sim" /> the rate of birth is non-zero.
					</p>

					<figure>
	<image source="sample.pdf"/>
						<caption>Sample solutions to the stochastic process with the deterministic result (or expectation) in red. One population (black) rather quickly goes extinct, while the other (blue) does better than expected. Only the first 500 events are shown.</caption>
</figure>

					<p>
						While the details of evaluating our claim are beyond our needs, we can and should temper our <sq>everything vanishes</sq> statement. In the absence of immigration, populations that remain finite are bound to reach extinction. They tend to do so rather quickly, after a string of bad luck. Otherwise populations can grow to infinity, avoiding and escaping the threat of extinction.
					</p>

					<p>
						More sophisticated approaches, using generating functions (special power series) let us calculate the mean extinction time for a given problem.
					</p>

				</paragraphs>
			</subsubsection>
		</subsection>
	</section>

	<section xml:id="continuous-time">
		<title>Continuous-time</title>


		<subsubsection xml:id="models-with-continuous-time">
			<title>Models with continuous time</title>


			<paragraphs xml:id="review-1">
				<title>Review</title>

				<p>
					We spent some time on the Nicholson-Bailey model for a few important reasons: largely because it is a great example of the modeling process. The results it generates may be bothersome. But the idea that we told a rough story, then iteratively refined it is the art of mathematical modeling.
				</p>


				<paragraphs xml:id="the-future">
					<title>The future</title>

					<p>
						As we transition towards new topics, it is worth mentioning our goals.
					</p>

					<p><ul>
						<li>
											<p>
						Read and interpret models<!-- linebreak -->A term by term understanding of the assumptions of a model.
					</p>
						</li>

						<li>
											<p>
						Analyze, <sq>solve,</sq> or simulate (compute) solutions.<!-- linebreak -->Equilibria and stability, or transient dynamics.
					</p>
						</li>

						<li>
											<p>
						Write models.
					</p>
						</li>

						<li>
											<p>
						Evaluate results and draw biological or mathematical conclusions.<!-- linebreak -->Dynamics (of NB) were unstable, might be missing biological ingredients.
					</p>
						</li>

					</ul></p>

				</paragraphs>

				<paragraphs xml:id="continuous-time-models">
					<title>Continuous-time models</title>

					<p>
						The fundamental difference between what we will do and what we have done so far is our treatment of time. We will now consider continuous processes, as the difference between <m>t</m> and <m>t+1</m> becomes small. We will use derivatives and talk about <sq>change</sq> in population sizes. We will write models using derivatives because we tell our story about <sq>how things change.</sq> We cannot tell a story about population size at time <m>t</m>, we can tell a story about how population size at time <m>t</m> changes.
					</p>

					<p>
						Let <m>N(t)</m> be the concentration of brain-eating amebae (<url href="http://www.cdc.gov/parasites/naegleria/">http://www.cdc.gov/parasites/naegleria/</url>) at time <m>t</m> living in a warm lake. Naegleria reproduce at rate <m>b</m> and die at rate <m>m</m> per time. We take two closely spaced water samples to determine whether naegleria is on the rise or it is otherwise <sq>safe</sq> to swim. The future concentration <m>N(t+\Delta t)</m> is equal to the following:<me>\begin{aligned}
N(t+\Delta t)&amp;=\overbrace{(1+b\Delta t)}^{\text{\begin{tabular}{c}reproduction\\[-6pt] by survivors\end{tabular}}}\underbrace{(1-m\Delta t)N(t)}_{\text{survivors}}\\
&amp;=(1+b\Delta t- m \Delta t-mb(\Delta t)^2)N(t)\\
&amp;=N(t)+ (b-m)\Delta t N(t) - mb(\Delta t)^2 N(t).\end{aligned}</me> Today we really started with the <em>last</em> line in the derivation which assumed that only one event was possible (i.e., we can think that we immediately ignored that individuals that died in a short interval gave birth at the same time.). We can think of <m>m</m> as the per time probability of mortality, so that <m>m\Delta t</m> is the fraction of naegleria that die in an interval of length <m>\Delta t</m>. Finally, <m>1-m\Delta t</m> is the fraction of survivors from a previous time step. Those that survive, <m>(1-m\Delta t)N(t)</m>, are <sq>allowed</sq> to reproduce, and contribute themselves (the <sq>1</sq>) plus their offspring (the <sq><m>b\Delta t</m></sq>) to the future generation.
					</p>

					<p>
						Previously (when thinking in discrete-time) we worked with fractions of survivors and now we are suddenly transitioning to working with rates. When we took <m>\Delta t=1</m> unit of time it may have been easy enough to convince ourselves that the fraction of individuals that survive an interval of length <m>\Delta t=1</m> unit was some number <me>q=1-m.</me> where <m>m</m> is the fraction that die per unit time step. If we put the <m>\Delta t</m> back into the equation we see the intermediate, <me>q\Delta t=1-m\Delta t.</me> We need this per unit time survival probability, <m>0\leq q\Delta t\leq1,</m> which hopefully suggests that we need, <me>0\leq 1-m\Delta t\leq1.</me> A bit of entertaining algebra shows that we need, <me>0\leq m \leq \frac{1}{\Delta t}.</me> So, when <m>\Delta t=1</m>, as with our discrete-time models, we needed <m>0\leq m\leq 1</m>. What we really need is the product <m>m\Delta t\leq 1</m>, so that as <m>\Delta t\rightarrow0</m>, <m>m</m> itself can become large and still preserve this inequality. In fact, as <m>\Delta t\rightarrow0</m> we allow <m>m\rightarrow\infty</m>!
					</p>

					<p>
						We often label <m>r=b-m</m> as the intrinsic growth rate, with units <m>\frac{1}{time}</m>, so that, <me>N(t+\Delta t)=N(t)+r\Delta t N(t)-mb(\Delta t)^2N(t).</me> Rearranging, <me>N(t+\Delta t)-N(t)=r\Delta t N(t)-mb(\Delta t)^2N(t),</me> and dividing by <m>\Delta t</m>, <me>\frac{N(t+\Delta t)-N(t)}{\Delta t}=r N(t)-mb\Delta t N(t).</me> Now, taking the limit as <m>\Delta t\rightarrow0</m>, <me>\frac{d^{} {N}}{d {t}^{}}=r N(t),</me> since the last term still contains a factor of <m>\Delta t</m>.
					</p>

					<p>
						We can read this differential equation as<me>\text{the change in }N(t)\text{ is proportional to }N(t).</me> Unlike before this change can just as easily be positive or negative. When the change (derivative of a function) is positive, we know from calculus that the function is increasing. When the change is negative, we know that the function is decreasing.
					</p>

					<p>
						Looking at our definition of <m>r=b-m</m>, if the mortality rate outweighs the birth rate the net, or intrinsic, growth rate is negative (in these cases it is sometimes useful to explicitly write a negative sign in the differential equation). Otherwise, if births outweigh mortality, it is positive. Like before, we will plot the right hand side of our model as a function of the population size. Rather than calling it a ’cobwebbing diagram’ we will call this a <sq>phase-line diagram.</sq> Unlike before this is a graph of <q>change vs. size</q> not <q>next vs. now.</q>
					</p>

					<p>
						If we plot the <q>change</q> in <m>N(t)</m> as a function of <m>N(t)</m>, we can determine whether or not <m>N(t)</m> will increase or decrease in size from a given initial condition, <m>N(0)</m>, by reading the derivative.
					</p>

					<figure>
	<image source="phase.pdf"/>
						<caption>Phase-line diagram. The dotted line, <m>\frac{d^{} {N}}{d {t}^{}}=0</m> for all <m>N</m> requires <m>r=0</m>. The change in the ’blue’ population is non-negative at all population size (and only zero at <m>N=0</m>), thus if it starts at <m>N(0)\neq0</m> it will always grow. The change in the ’red’ population is non-positive at all population size (and only zero at <m>N=0</m>), thus if it starts at <m>N(0)\neq0</m> it will always shrink. </caption>
</figure>

					<p>
						Looking at Fig. <xref ref="fig::phase" />, the <sq>blue</sq> population starts at <m>N(0)=N_0</m> and grows. It grows at a faster and faster rate as it grows. In contrast the <sq>red</sq> population shrinks rapidly at first, but when it reaches smaller population sizes the rate it which it shrinks decreases.
					</p>

					<p>
						Before developing our <sq>method</sq> for solving all future problems, we will actually solve this one analytically. This is one of the few times we can solve our model analytically. As we do this, we will not pay much attention to whether or not <m>r</m> is positive or negative. In general, we expect parameters to be non-negative, but here <m>r=b-m</m> is a sort of <sq>compound</sq> parameter and can be negative when <m>m</m> (a positive parameter) is larger than <m>b</m> (a positive parameter). To allow for growth or decay, without having to worry about negative parameters, we will specify <m>r=b-m</m>.
					</p>

					<p>
						Recall, <me>\frac{d^{} {N}}{d {t}^{}}=(b-m)N.</me> <me>\begin{aligned}
\frac{dN}{N}&amp;=r\,dt\\
\int_0^s\frac{dN}{N}&amp;=\int_0^s (b-m)\,dt\\
\ln(N)\Big|_0^s&amp;=(b-m)t\Big|_0^s\\
\ln(N(s))-\ln(N_0)&amp;=(b-m) s\\
\ln(N(s))&amp;=\ln(N_0)+(b-m) s\\
N(s)&amp;=\exp(\ln(N_0)+(b-m) s)\\
&amp;=\exp(\ln(N_0))\exp((b-m) s)\\
N(s)&amp;=N_0\exp((b-m) s)\\\end{aligned}</me> Replacing <m>s</m> by <m>t</m>,<me>N(t)=N_0\exp((b-m) t),</me> and we can see that when <m>b&lt;m</m>, <m>N(t)\rightarrow0</m>. Otherwise, when <m>b&gt;m</m>, <m>N(t)\rightarrow\infty</m>. If <m>b=m</m>, then <m>r=0</m> and <m>N(t)</m> never changes from <m>N_0</m>. We might be interested in using the formula for <m>N(t)</m> to compute the half-life (commonly <m>\tau_{1/2}</m>) or doubling time (commonly <m>\tau_2</m>).
					</p>

					<p>
						Before moving on to nonlinear models, guided by our prior modeling experiences we should recognize that we could write models of the form <me>\frac{d^{} {N}}{d {t}^{}}=(b-m)N-h,</me> or <me>\frac{d^{} {N}}{d {t}^{}}=(b-m)N+s.</me> Biologically, what do these models say? Mathematically, how might you solve them?
					</p>

				</paragraphs>

				<paragraphs xml:id="a-disease-model-1">
					<title>A disease model</title>

					<p>
						Consider a herd of Ebola-carrying zombies, where the <sq>healthy</sq> zombies are susceptible to Ebola (<m>S</m>) and the <sq>infectious</sq> zombies are capable of transmitting Ebola (<m>I</m>).
					</p>

					<p>
						=[draw, fill=blue!20, minimum size=2em, circle] =[draw, fill=red!20, minimum size=2em, circle]
					</p>

					<p>
						Much like in class we will build a word model as we go. <me>\begin{aligned}
\text{change in }S &amp; = \text{gain from recovery} - \text{loss to infection}\\
\text{change in }I &amp; = \text{loss to recovery} + \text{gain from infection},\end{aligned}</me> and replace the terms with symbols. Our <sq>first</sq> term is <sq>loss to recovery</sq> in the <m>I</m> equation. We can think of <m>\gamma</m> as the leaving rate from the <m>I</m> compartment, much like <m>m</m> was the <sq>leaving rate from the living</sq> (i.e., dying) compartment of a population model. Everything, in this model, that leaves one compartment enters another (i.e., there are no <sq>leaks</sq>). We can also argue for the infection rate as follows, since infection is only transmitted directly and by infectious hosts, we might expect that the rate that <m>S</m> individuals gain infection is proportional to the density (zombies per hectare) of infectious zombies, <m>I</m>. In fact here, we assume that the infection rate is a linearly increasing function of <m>I</m>. There are plenty of other models of transmission, some we will study in the homework, others later in the semester, still more in our projects.
					</p>

					<p>
						<me>\begin{aligned}
{2}
\text{change in }S &amp; = \text{gain from recovery} &amp;&amp;-\text{loss to infection}\\
\frac{d^{} {S}}{d {t}^{}}&amp;=\gamma I &amp;&amp; - {\beta I} S\\
\text{change in }I &amp; = \text{loss to recovery} &amp;&amp; +\text{gain from infection}\\
\frac{d^{} {I}}{d {t}^{}}&amp;=-{\gamma} I &amp;&amp; + \beta I S\\\end{aligned}</me>
					</p>

					<p>
						Since the total number of zombies <m>Z</m> is preserved, we can replace the equation for <m>S</m> by an algebraic constraint <m>S=Z-I</m>. We can substitute this into the equation for <m>I</m> and derive a 1-dimensional, nonlinear model,<me>\frac{d^{} {I}}{d {t}^{}}=\beta I (Z-I)-\gamma I.</me> If we define our model <m>h(I)=\beta I (Z-I)-\gamma I,</m> we can plot the more interesting version of our phase line as in Fig. <xref ref="fig::phase" />. Ignoring graphs for the moment, we can also compute equilibria of continuous time models, <term>defined as</term> solutions to <m>h(I^*)=0</m>. This gives <m>I^*=0</m> and <m>I^*=Z-\frac{\gamma}{\beta}.</m> It might prove useful to notice that our nontrivial solution exists when <m>\gamma&lt;\beta Z</m> this suggests a limitation on the recovery rate that depends on the contact parameter <m>\beta</m> and the total zombie population size <m>Z</m>.
					</p>

				</paragraphs>
			</paragraphs>
		</subsubsection>

		<subsection xml:id="two-dimensional-continuous-time-models">
			<title>Two-dimensional, continuous-time models</title>


			<subsubsection xml:id="harvesting-and-predator-prey">
				<title>Harvesting and predator-prey</title>


				<paragraphs xml:id="key-concepts-in-continuous-time-models-1">
					<title>Key concepts in continuous-time models</title>

					<p>
						Consider the model <me>\begin{aligned}
\frac{d^{} {N}}{d {t}^{}}&amp;=\left(r\left(1-\frac{N}{K}\right)-\frac{hF}{1+sN}\right)N\\
&amp;= (f(N)-g(N))N,\end{aligned}</me> that describes the dynamics of a logistically-growing population subjected to harvesting. Equilibria of this model are <m>N^*</m> and <m>f(N^*)=g(N^*)</m>. The removal rate due to harvesting is <me>\frac{hF}{1+sN},</me> per <m>N</m>. One short derivation of this functional form is given here, we will see another derivation in a few lectures.
					</p>


					<paragraphs xml:id="derivation-of-a-functional-response">
						<title>Derivation of a functional response</title>

						<p>
							A harvester spends its time, of which it has <m>T</m>, searching (<m>T_S</m>) or handling (<m>T_H</m>), thus, <me>T=T_S+T_H.</me> The handling time depends on the number of prey captured (<m>N_C</m>) and the handling time per prey (<m>\hat s</m>), so that, <me>T_H=\hat s N_C.</me> In turn, the number captured depends on the searching or finding rate (<m>\hat h</m>), the number of prey available (<m>N</m>), and the time spend searching by predators or harvesters (<m>T_S</m>), <me>N_C=\hat h N T_S.</me> Solving for the search time, <me>T_S=\frac{N_C}{\hat h N},</me> so that <me>T=T_S+T_H=\hat s N_C+\frac{N_C}{\hat h N}= N_C\left(\hat s + \frac{1}{\hat h N}\right).</me> Solving for <m>N_C</m>, <me>N_C=T\left(\frac{\hat h N}{1+\hat s \hat h N}\right).</me>
						</p>

						<p>
							The per predator feeding rate is, <me>\frac{N_C}{T}=\left(\frac{\hat h N}{1+\hat s \hat h N}\right),</me> since the definition of <m>T</m> was <sq>per predator</sq>. Redefining constants <m>h=\hat h</m> and <m>s=\hat s \hat h</m>, we can finally write the per predator harvesting rate as <me>\frac{N_C}{T}=h_{II}(N)=\left(\frac{h N}{1+ s N}\right),</me> so that the harvesting term is <m>h_{II}(N)F.</m> If predators instantaneously consume their prey, <m>s=0</m> which returns the Type I response, because saturation vanishes.
						</p>

						<p>
							Consider now, a two dimensional extension where <m>F</m> is no longer a parameter, but instead a dynamic variable. Whose growth is proportional to the consumption of prey, up to a scaling factor <m>\epsilon</m>. Such a model is, <me>\begin{aligned}
\frac{d^{} {N}}{d {t}^{}}&amp;=\left(r\left(1-\frac{N}{K}\right)-\frac{hF}{1+sN}\right)N\\
\frac{d^{} {F}}{d {t}^{}}&amp;=\frac{\epsilon hFN}{1+sN}-mF.\end{aligned}</me> We can give ourselves a slightly simpler situation if we assume that the predator is a <sq>Type I</sq> predator, <me>\begin{aligned}
\frac{d^{} {N}}{d {t}^{}}&amp;=\left(r\left(1-\frac{N}{K}\right)-hF\right)N\\
\frac{d^{} {F}}{d {t}^{}}&amp;=\epsilon hFN-mF.\end{aligned}</me> A common approach to studying such a model is to first <sq>nondimensionalize</sq> the variables by scaling by some relevant value. Here we have a carrying capacity for <m>N</m>, so if we scale <m>N</m> by <m>K</m> we can define <m>x=\frac{N}{K},</m> and study the dynamics of <m>x</m> which describes the proportion of carrying capacity that is filled. The goal of this is to combine parameters and reduce the dimension of parameter space. We also rescale time by setting <m>T=rt</m> and replacing the derivative <m>\displaystyle\frac{d^{} {}}{d {t}^{}}</m> by <m>\displaystyle r\frac{d^{} {}}{d {T}^{}}</m>. The definition involving <m>F</m> is less clear from the start, but as we step through the process we find that using <m>\displaystyle y=\frac{h}{r}F</m> works pretty well. Ultimately, after some failed attempts, we find something like, <me>\begin{aligned}
\frac{d^{} {x}}{d {t}^{}}&amp;=\left(\left(1-x\right)-y\right)x\\
\frac{d^{} {y}}{d {t}^{}}&amp;=\beta(x-\alpha)y.\end{aligned}</me>
						</p>

						<p>
							Just as we used phase lines in one dimension, we will use phase planes in two dimensions. To introduce this process we will use an even simpler model describing the densities of prey (<m>X</m>) and predator (<m>Y</m>), <me>\begin{aligned}
\frac{d^{} {X}}{d {t}^{}}&amp;=rX-mXY\\
\frac{d^{} {Y}}{d {t}^{}}&amp;=nXY-sY.\end{aligned}</me>
						</p>

						<p>
							First, we hope to compute equilibria. We can start by solving when each of the equations is equal to zero (i.e., when individual quantities are unchanging). Setting <me>\frac{d^{} {X}}{d {t}^{}}=0\Rightarrow (r-mY)X=0.</me> This equation implies that <m>X</m> is unchanging along the lines <m>X=0</m> and <m>Y=\frac{r}{m}</m> in the <m>(X, Y)</m>-plane. Additionally, setting <me>\frac{d^{} {Y}}{d {t}^{}}=0\Rightarrow (nX-s)Y=0.</me> This equation implies that <m>Y</m> is unchanging along the lines <m>Y=0</m> and <m>X=\frac{s}{n}</m> in the <m>(X, Y)</m>-plane. Equilibria require both equations be satisfied simultaneously, thus opposite nullclines must intersect so that <em>both</em> of <m>X</m> and <m>Y</m> are unchanging. We will jump ahead and plot <em>everything</em> in Fig. <xref ref="fig::pred_prey_pp" />, this includes trajectories in the phase plane and <sq>direction arrows.</sq>
						</p>

						<figure>
	<image source="pred_X.pdf"/>
							<caption>On lines <m>\frac{d^{} {X}}{d {t}^{}}=0</m>, motion is in the vertical direction. On lines <m>\frac{d^{} {Y}}{d {t}^{}}=0</m>, motion is in the horizontal direction. </caption>
</figure>

						<p>
							Direction arrows in Fig.. <xref ref="fig::pred_prey_pp" />, are obtained by treating the individual differential equations as inequalities. The motivation is that we know that <me>\frac{d^{} {X}}{d {t}^{}}&gt;0</me> when <me>(r-mY)X&gt;0.</me> Since <m>X&gt;0</m> is of interest, the to ensure the derivative is positive, we need <me>\frac{r}{m}&gt;Y.</me> Thus, <m>X</m> is increasing below the (nonzero) <m>X</m>-nullcline. Similarly, <m>X</m> is decreasing above this nullcline. Lastly, we can show that <m>Y</m> is decreasing <sq>to the left</sq> of the (again, nonzero) vertical <m>Y</m>-nullcline, and decreasing to the right. This shows that motion is counterclockwise. Numerical solutions show that we have closed orbits around the equilibrium point <m>(X^*, Y^*)</m>. We call this point <em>neutrally stable</em>.
						</p>

						<p>
							If we hadn’t computed solutions, we wouldn’t necessarily know from the phase portrait that these solutions do not spiral in towards or out from the equilibrium. To know for certain, we would need to study the <sq>linearized</sq> dynamics near each equilibrium point, including the point <m>(0, 0)</m>, as well. Since we have solutions, we might as well plot them in time (see Fig. <xref ref="fig::pred_prey" />).
						</p>

						<figure>
	<image source="pred_XY_t.pdf"/>
							<caption>Numbers (or <m>\text{densities}=\frac{\text{number}}{area}</m>) of prey (<m>X</m>) and predators (<m>Y</m>). </caption>
</figure>

					</paragraphs>
				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="the-trace-determinant-method">
				<title>The <sq>Trace-Determinant Method</sq></title>


				<paragraphs xml:id="diagnostics-for-eigenvalues-and-stability">
					<title>Diagnostics for eigenvalues and stability</title>

					<p>
						In many cases, the calculation of eigenvalues from the Jacobian matrix at equilibria is unnecessary. Instead, we prefer a simpler approach that we refer to as the <sq>trace-determinant method.</sq> Combined with a cautious sketch of the phase plane, the inspection of <m>\tau=\operatorname{Tr}{J^*}</m> and <m>\Delta=\operatorname{det}{J^*}.</m>
					</p>

					<p>
						In some situations, the phase plan suggests that trajectories might oscillate about a fixed point. Yet, without the aid of computers we are often unable to distinguish between equilibria that attract, repel, or do neither. We call these attracting (repelling) equilibria stable (unstable) foci, the plural of focus, or neutrally stable centers, in the third case. Since we expect solutions to oscillate given the phase plane, all that remains is to determine whether or not the real part of the eigenvalue is positive, negative, or zero. This is <em>obvious</em> from the sign of <m>\tau</m>. The eigenvalues corresponding to the characteristic polynomial <me>C(\lambda)=\lambda^2-\tau \lambda +\Delta,</me> are given by <me>\lambda_\pm=\frac{\tau}{2}\pm\frac{\sqrt{\tau^2-4\Delta}}{2}.</me> We can see that <m>\tau&gt;0</m> implies <m>\operatorname{Re}(\lambda)&gt;0</m>, which means perturbations from equilibria decay and a particular equilibrium is a stable focus. We can repeat the argument for <m>\tau&lt;0</m>, which suggests an unstable focus, characterized by growing oscillations. Eigenvalues are purely imaginary, giving rise to neutrally stable centers, if <m>\tau=0</m>. Thus, if we expect oscillations, <m>\tau</m> tells us whether oscillations grow (<m>\tau&gt;0</m>), decay (<m>\tau&lt;0</m>), or are sustained (<m>\tau=0</m>), all without ever calculating the actual eigenvalue.
					</p>

					<p>
						Another interesting case, that gives us yet another <em>obvious</em> conclusion, is <m>\Delta&lt;0</m>. If we consider a matrix, <m>J^*</m>, then <m>\tau</m> is the sum of its eigenvalues while <m>\Delta</m> is the product. Thus, for a <m>2\times2</m> matrix <m>J^*</m>, <m>\Delta=\lambda_1\lambda_2.</m> If <m>\Delta&lt;0</m>, then eigenvalues must be of opposite sign. This gives rise the the dynamics of a saddle point, stable in one direction, unstable in the other.
					</p>

					<p>
						The only other nondegenerate cases occur when we have distinct, real eigenvalues of the same sign. The corresponding equilibria are termed nodes, with stability governed by the sign of <m>\tau</m>, since <m>\Delta&gt;0</m>.
					</p>

					<p>
						We have our degenerate cases on the <m>\Delta=0</m> axis and along the curve <m>\Delta=\frac{\tau^2}{4}</m>. The case <m>\Delta=0</m> gives us a line of fixed points, where one quantity remains fixed (since one eigenvalue is zero) while the other grows from (<m>\tau&gt;0</m>) or decays towards (<m>\tau&lt;0</m>) zero. Along the curve <m>\Delta=\frac{\tau^2}{4}</m> equilibria are called <sq>degenerate nodes,</sq> characterized by a repeated eigenvalue.
					</p>

					<p>
						Stable points, which attract trajectories, are often called <sq>sinks.</sq> Unstable points, which repel trajectories, are often called <sq>sources,</sq> since solutions emanate from such a source.
					</p>

				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="ecological-competition">
				<title>Ecological competition</title>


				<paragraphs xml:id="method">
					<title>Method</title>

					<p>
						To review, we apply the following method to study 2D nonlinear dynamical systems.
					</p>

					<p><ol>
						<li>
											<p>
						Write a model.
					</p>
						</li>

						<li>
											<p>
						Read and interpret the model (dimensional analysis of parameters.
					</p>
						</li>

						<li>
											<p>
						Compute nullclines and equilibria.
					</p>
						</li>

						<li>
											<p>
						Plot phase portraits with direction arrows and trajectories.
					</p>
						</li>

						<li>
											<p>
						Refine knowledge of stability with linearization via Jacobian.
					</p>
						</li>

					</ol></p>

					<p>
						Consider two species <m>A(t)</m> and <m>B(t)</m> for ants and beetles, respectively. Assume that each grows (in the absence of the other) according to logistic growth, <me>\begin{aligned}
\begin{cases}
\displaystyle\frac{d^{} {A}}{d {t}^{}}&amp;=r_A A\Big(1-\frac{A}{K_A}\Big)\\[10pt]
\displaystyle\frac{d^{} {B}}{d {t}^{}}&amp;=r_B B\Big(1-\frac{B}{K_B}\Big).
\end{cases}\end{aligned}</me> Here, each species grows independently of the other. Beetles have no effect on ants; ants have no effect on beetles. Our mechanism for interaction will be <em>interference</em> competition, which leads in increased mortality. <me>\begin{aligned}
\begin{cases}
\displaystyle\frac{d^{} {A}}{d {t}^{}}&amp;=r_A A\Big(1-\frac{A}{K_A}-\frac{\alpha B}{K_A}\Big)\\[10pt]
\displaystyle\frac{d^{} {B}}{d {t}^{}}&amp;=r_B B\Big(1-\frac{B}{K_B}-\frac{\gamma A}{K_B}\Big).
\end{cases}\end{aligned}</me>
					</p>

					<p>
						To understand interspecific competition, we need to understand the units and magnitude of <m>\alpha</m> and <m>\gamma</m>. Roughly, <m>\alpha</m> translates from units of beetle density to an <q>effective ant density.</q> According to the ratio <m>\frac{B}{K_A}</m>, beetles <sq>fill</sq> some of the carrying capacity allotted to ants. Just how much of the capacity that they fill is given by the parameter <m>\alpha</m>, which when multiplied by <m>B</m> gives the <sq>ant equivalency</sq> of <m>B</m> beetles. We will look more closely at the equation for <m>B</m>, but note that we could make similar observations about the equation for <m>A</m>.
					</p>

					<p>
						The dynamics of <m>B</m> are given by, <me>\frac{d^{} {B}}{d {t}^{}}=r_B B\Big(1-\frac{B+\gamma A}{K_B}\Big),</me> which slightly more directly illustrates that both <m>A</m> and <m>B</m> fill the carrying capacity allotted to <m>B</m>. In one dimension, equilibria depend on the zeros of the right hand side of an equation like this. In two dimensions, equilibria depend on the values of both quantities <m>A</m> and <m>B</m>. The first step, as before, is to compute the nullclines for <m>B</m>. Setting <m>\frac{d^{} {B}}{d {t}^{}}=0</m> implies that either <m>B=0</m> or <me>1-\frac{B+\gamma A}{K_B}=0.</me> With a single species, this equation looks like <me>1-\frac{\text{animals}}{K_B}=0.</me> We can solve this equation for the density of animals at equilibrium to find, <me>\text{animals}=K_B.</me> But we know that we have a particular composition of animals, such that <me>\text{animals}=B+\gamma A.</me> Combining these equations, <me>K_B=B+\gamma A,</me> gives <m>B</m> as a function of <m>A</m>, the abundance of <m>A</m> and <m>B</m> that guarantee that <m>B</m> is unchanging,<me>B=K_B -\gamma A.</me>
					</p>

					<p>
						Finally, we have that, if either or . By their definition, on , the motion in the <m>B</m> direction is zero, and dynamics are strictly increasing (or decreasing) in <m>A</m>.
					</p>

					<p>
						Similarly, we can compute that, if either or . By their definition, on , the motion in the <m>A</m> direction is zero, and dynamics are strictly increasing (or decreasing) in <m>B</m>. We have to consider a variety of parameter combinations and relative magnitudes. This lets us plot four distinct phase portraits, shown in Fig. <xref ref="fig::Aonly" /> - Fig. <xref ref="fig::Saddle" />
					</p>

					<figure>
	<image source="compet_A.pdf"/>
						<caption>When <m>\frac{K_A}{\alpha}&gt;K_B</m> and <m>\frac{K_B}{\gamma}&lt;K_A</m>, only <m>A</m> exists at equilibrium. This is equivalent to <m>\frac{K_A}{K_B}&gt;\alpha</m> and <m>\frac{K_B}{K_A}&lt;\gamma</m>, which suggests that <m>B</m> has a weak effect on <m>A</m>, but <m>A</m> has a strong effect on <m>B</m>.</caption>
</figure>

					<figure>
	<image source="compet_B.pdf"/>
						<caption>When <m>\frac{K_A}{\alpha}&lt;K_B</m> and <m>\frac{K_B}{\gamma}&gt;K_A</m>, only <m>B</m> exists at equilibrium. This is equivalent to <m>\frac{K_A}{K_B}&lt;\alpha</m> and <m>\frac{K_B}{K_A}&gt;\gamma</m>, which suggests that <m>B</m> has a strong effect on <m>A</m>, but <m>A</m> has a weak effect on <m>B</m>.</caption>
</figure>

					<figure>
	<image source="compet_AB.pdf"/>
						<caption>When <m>\frac{K_A}{\alpha}&gt;K_B</m> and <m>\frac{K_B}{\gamma}&gt;K_A</m>, nullclines intersect, and the coexistence equilibrium is stable. This is equivalent to <m>\frac{K_A}{K_B}&gt;\alpha</m> and <m>\frac{K_B}{K_A}&gt;\gamma</m>, which suggests that <m>B</m> has a weak effect on <m>A</m>, and <m>A</m> has a weak effect on <m>B</m>.</caption>
</figure>

					<figure>
	<image source="compet_saddle.pdf"/>
						<caption>When <m>\frac{K_A}{\alpha}&lt;K_B</m> and <m>\frac{K_B}{\gamma}&lt;K_A</m>, but the coexistence equilibrium is unstable. This is equivalent to <m>\frac{K_B}{K_A}&gt;\alpha</m> and <m>\frac{K_A}{K_B}&gt;\gamma</m>, which suggests that <m>B</m> has a weak effect on <m>A</m>, and <m>A</m> has a weak effect on <m>B</m>. The <sq>winner</sq> depends on the initial conditions.</caption>
</figure>

				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="parameters-rates-and-units-prelude-to-chemical-kinetics">
				<title>Parameters, rates, and units: Prelude to chemical kinetics</title>


				<paragraphs xml:id="parameters-rates-and-units">
					<title>Parameters, rates, and units</title>

					<p>
						We always need to keep in mind the fact that our parameters and rates have important units. We will review a few familiar examples to motivate this concept before moving on to biochemical kinetics of enzymatic reactions.
					</p>


					<paragraphs xml:id="example-1-sir-models">
						<title>Example 1: SIR models</title>

						<p>
							Recall the SIR model (illustrated in Fig. <xref ref="fig::sir_flow" />), where <m>S</m>, <m>I</m>, and <m>R</m> are the host population densities of susceptible, infect<em>ious</em>, and recovered (or removed) hosts. Susceptible hosts are infected at a rate <m>\beta(N)\left(\frac{I}{N}\right)</m> and infectious hosts recover (or are removed by death) at a rate <m>\gamma</m>. =[draw, fill=white, minimum size=3em, circle] =[ fill=white, minimum size=3em, circle]
						</p>

						<p>
							The prevailing models in the literature are called <sq>mass action</sq> and <sq>constant contact</sq>, which refers specifically to the choice of the function <m>\beta(N)</m> within our transmission function.
						</p>

						<p><ol>
							<li>
													<p>
							constant contact (frequency dependent) assumes that <m>\beta(N)=\beta_0</m><!-- linebreak --><me>\begin{aligned}
\beta(N)\left(\frac{I}{N}\right)S&amp;=\overset{ \overset{\displaystyle{\left[\frac{\text{1}}{\text{time}}\right]}}{\big\downarrow}}{\beta_0}  \times\overset{ \overset{\displaystyle{\left[\frac{\text{host}}{\text{host}}\right]}}{\big\downarrow}}{\left(\frac{I}{N}\right)} \times\overset{ \overset{\displaystyle{\left[\text{host}\right]}}{\big\downarrow}}{S} \end{aligned}</me>
						</p>
							</li>

							<li>
													<p>
							mass action (density dependent) assumes that <m>\beta(N)=\beta_1 N</m><!-- linebreak --><me>\begin{aligned}
\beta(N)\left(\frac{I}{N}\right)S&amp;=\beta_1 N\left(\frac{I}{N}\right)S\\
&amp;=\underset {\underset{\displaystyle{\left[\frac{\text{1}}{\text{host $\cdot$ time}}\right]}}{\big\uparrow}}{ \beta_1} \times\underset {\underset{\displaystyle{\left[\text{host}\right]}}{\big\uparrow}}{ I}\times\underset {\underset{\displaystyle{\left[\text{host}\right]}}{\big\uparrow}}{ S}\end{aligned}</me>
						</p>
							</li>

						</ol></p>

						<p>
							Notice that we have to assign different units to the <sq>transmission parameter</sq> <m>\beta(N)</m> depending on its form.
						</p>


						<paragraphs xml:id="example-2-predator---prey-equations">
							<title>Example 2: Predator - Prey equations</title>

							<p>
								Consider the densities of prey (<m>X</m>) and its predator (<m>Y</m>), given by the following (slightly incorrect, or at least misleading equations), <me>\begin{aligned}
\frac{d^{} {X}}{d {t}^{}}&amp;=rX-sXY\\
\frac{d^{} {Y}}{d {t}^{}}&amp;=sXY-qY.\end{aligned}</me> The interaction term, <m>sXY</m>, is the term that we focus on. This term represents predation in the <m>\frac{d^{} {X}}{d {t}^{}}</m>-equation, but growth in the <m>\frac{d^{} {Y}}{d {t}^{}}</m>-equation (see Fig. <xref ref="fig::PP_units" />).
							</p>

							<table>
								<caption></caption>
								<tabular>
								<row class="odd">
									<cell halign="center">predation</cell>
									<cell halign="center"><m>\rightarrow</m></cell>
									<cell halign="center">growth</cell>
								</row>
								<row class="even">
									<cell halign="center">loss of <m>X</m></cell>
									<cell halign="center"><m>\rightarrow</m></cell>
									<cell halign="center">gain of <m>Y</m></cell>
								</row>
								<row class="odd">
									<cell halign="center"><m>\frac{\text{prey}}{\text{time}}</m></cell>
									<cell halign="center"><m>\rightarrow</m></cell>
									<cell halign="center"><m>\frac{\text{predator}}{\text{time}}</m></cell>
								</row>
								<row class="even">
									<cell halign="center"><m>sXY</m></cell>
									<cell halign="center"><m>\rightarrow</m></cell>
									<cell halign="center"><m>sXY</m></cell>
								</row>
								<row class="odd">
									<cell halign="center"><m>\underset {\underset{\displaystyle{\left[\frac{\text{1}}{\text{predator $\cdot$ time}}\right]}}{\big\uparrow}}{ s} \times\underset {\underset{\displaystyle{\left[\text{prey}\right]}}{\big\uparrow}}{ X}\times\underset {\underset{\displaystyle{\left[\text{predator}\right]}}{\big\uparrow}}{ Y}</m></cell>
									<cell halign="center"><m>\rightarrow</m></cell>
									<cell halign="center"><m>\underset {\underset{\displaystyle{\left[\frac{\text{1}}{\text{predator $\cdot$ time}}\right]}}{\big\uparrow}}{ s} \times\underset {\underset{\displaystyle{\left[\text{prey}\right]}}{\big\uparrow}}{ X}\times\underset {\underset{\displaystyle{\left[\text{predator}\right]}}{\big\uparrow}}{ Y}</m></cell>
								</row>
								</tabular>
							</table>

							<p>
								Indeed, <m>sXY</m> describes the rate of predation on <m>X</m>, but it cannot describe, as it is now, the growth rate of <m>Y</m>. The unit’s in the second equation are inconsistent, thus, the model must be wrong! In fact, we have <me>\begin{aligned}
\frac{d^{} {X}}{d {t}^{}}&amp;=rX-sXY\\
\frac{d^{} {Y}}{d {t}^{}}&amp;=\varepsilon sXY-qY, \end{aligned}</me> where <me>\varepsilon\sim\frac{\text{predator}}{\text{prey}},</me> is some (probably small) number describing the <sq>conversion efficiency</sq> of producing new predators from consumed prey.
							</p>

						</paragraphs>
					</paragraphs>
				</paragraphs>

				<paragraphs xml:id="michaelis-menten-kinetics">
					<title>Michaelis-Menten kinetics</title>

					<p>
						The introduction to units will highlight the <sq>fact</sq> that units in reaction kinetics are somewhat less tangible and slightly more difficult to interpret. We will study the dynamics of cell receptors (<m>X_0, X_1</m>) as they shuttle extracellular nutrients (<m>N</m>) into the cell. We denote the concentration of cellular nutrient by <m>C</m>.
					</p>

					<p>
						We wish to apply the <sq>law of mass action</sq> which simply states,
					</p>

					<p>
						<em>in a bimolecular reaction, the reaction rate is proportional<!-- linebreak -->to the product of the concentrations of reactants</em>.
					</p>

					<p>
						Assuming that <m>[A]</m> and <m>[B]</m> are the concentrations of reactants, <me>\begin{aligned}
\text{rate}&amp;\propto [A][B]\\
&amp;=k[A][B],\end{aligned}</me> where the constant of proportionality, <m>k</m>, is called the <sq>rate constant.</sq>
					</p>

					<p>
						Since the law of mass action relies on concentrations of reactants, we must reconsider our receptors and nutrients in terms of <sq>concentrations</sq>. For a given cellular component <m>Z</m>, the <sq>volumetric concentration of <m>Z</m></sq> is, <me>\left[\begin{tabular}{c}\text{concentration}\\\text{of $Z$}\end{tabular}\right]=\left[\begin{tabular}{c}\text{average number}\\\text{of $Z$ per cell}\end{tabular}\right]\times\left[\begin{tabular}{c}\text{average number of}\\\text{cells per volume}\end{tabular}\right].</me> Treating <m>N</m>, <m>X_0</m>, <m>X_1</m>, and <m>C</m> as volumetric concentrations we can use the reaction diagram (Fig. <xref ref="fig::nutrient_recept" />) to build differential equations to describe the changes in concentrations.
					</p>

					<p>
						INSERT REACTION
					</p>

					<p>
						As an example, there are two ways that the extracellular nutrient concentration changes giving two terms to the <m>\frac{d^{} {N}}{d {t}^{}}</m> equation. <me>\begin{aligned}
\frac{d^{} {N}}{d {t}^{}} &amp; = -\left(\text{losses when free nutrient binds to empty receptor}\right)\\
&amp;\qquad +\left(\text{gains when occupied receptors release nutrient extracellularly}\right)\\
&amp; = -k_+ N X_0 + k_- X_1\end{aligned}</me>
					</p>

					<p>
						Similarly, we can add the remaining equations, <me>\begin{aligned}
\frac{d^{} {N}}{d {t}^{}} &amp; = -k_+ N X_0 + k_- X_1\\
\frac{d^{} {X_0}}{d {t}^{}} &amp; = -k_+ N X_0 + k_- X_1 + k_i X_i\\
\frac{d^{} {X_1}}{d {t}^{}} &amp; = k_+ N X_0 - k_- X_1 - k_i X_i\\
\frac{d^{} {C}}{d {t}^{}} &amp; = k_i X_1\end{aligned}</me> Given this model, our first goal is to make some simplifications through astute observations. Both <m>X_0</m> and <m>X_1</m> are receptor states, and if we add the two differential equations, <me>\frac{d^{} {X_0}}{d {t}^{}}+\frac{d^{} {X_1}}{d {t}^{}}=0,</me> we see that the total receptor concentration is conserved, <m>R</m>. With this we can write <m>X_0=R-X_1.</m> <me>\begin{aligned}
\frac{d^{} {N}}{d {t}^{}} &amp; = -k_+ N (R-X_1) + k_- X_1\\
\frac{d^{} {X_1}}{d {t}^{}} &amp; = k_+ N (R-X_1) - k_- X_1 - k_i X_i\end{aligned}</me> Reshuffling a bit, <me>\begin{aligned}
\frac{d^{} {N}}{d {t}^{}} &amp; = -k_+ N R+(k_+N + k_-) X_1\\
\frac{d^{} {X_1}}{d {t}^{}} &amp; = k_+ N R- (k_+ N + k_- + k_i )X_i\end{aligned}</me>
					</p>

					<p>
						We can study these equations in the phase plane. Assuming all parameters are positive, both nullclines saturate to a value <m>X_1\rightarrow R</m> at large <m>N</m>. Knowing very little about parameters, we know that the half saturation constant of the <m>X_1</m> nullcline is larger than that of the <m>N</m> nullcline. The nullclines, direction arrows on the nullclines, and a sample trajectory are illustrated in Fig. <xref ref="fig::mm_kinetics" />.
					</p>

					<figure>
	<image source="mm_nullclines.pdf"/>
						<caption>Nutrient-receptor reaction.</caption>
</figure>

				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="equilibrium-assumption-vs.-the-quasi-steady-state-assumption">
				<title>Equilibrium assumption vs. the Quasi-steady state assumption</title>

				<p>
					The notes of the following section have not been typeset. A rough, handwritten copy is included. If you have a better copy, I’d be happy to see it.
				</p>


				<paragraphs xml:id="equilibrium-assumption">
					<title>Equilibrium assumption</title>

				</paragraphs>

				<paragraphs xml:id="quasi-steady-state-assumption">
					<title>Quasi-steady state assumption</title>

				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="nullclines-and-neuroscience">
				<title>Nullclines and Neuroscience</title>

				<p>
					Following on the heels of the quasi-steady state assumption, we will close with an application of fast and slow dynamics that arises in mathematical models of neurons.
				</p>

				<p>
					This example, called the FitzHugh-Nagumo model allows us to synthesize much of the material from continuous time dynamical systems: phase plane, equilibria, analysis, and approximation.
				</p>

			</subsubsection>
		</subsection>
	</section>

	<section xml:id="discrete-time">
		<title>Discrete-time</title>


		<subsection xml:id="introduction-and-linear-discrete-time-models">
			<title>Introduction and Linear discrete-time models</title>


			<subsubsection xml:id="introduction-to-models-and-notation">
				<title>Introduction to models and notation</title>


				<paragraphs xml:id="what-is-mathematical-biology">
					<title>What is mathematical biology?</title>


					<paragraphs xml:id="what-is-mathematics">
						<title>What is mathematics?</title>

						<p>
							The study of number, quantity, space.
						</p>


						<paragraphs xml:id="what-is-biology">
							<title>What is biology?</title>

							<p>
								The study of life.
							</p>

						</paragraphs>

						<paragraphs xml:id="what-is-mathematical-biology-1">
							<title>What is mathematical biology?</title>

							<p>
								Using mathematical tools to study life.
							</p>

							<p><ul>
								<li>
															<p>
								Understanding the details of interactions between interacting populations of chemicals, cells, or individuals
							</p>
								</li>

								<li>
															<p>
								Understanding or hypothesizing the mechanisms by which any biological quantities (numbers, densities, concentrations) change over time (or space)
							</p>
								</li>

							</ul></p>

						</paragraphs>

						<paragraphs xml:id="biological-science-vs.-physical-science">
							<title>Biological science vs. Physical science</title>

							<p>
								Physics has <sq>laws</sq>, biology has no such <sq>laws</sq>.
							</p>

						</paragraphs>
					</paragraphs>
				</paragraphs>

				<paragraphs xml:id="what-are-our-goals-for-mathematical-biology">
					<title>What are our goals for mathematical biology</title>

					<p><ul>
						<li>
											<p>
						Draw qualitative conclusions about biological processes.
					</p>
						</li>

						<li>
											<p>
						Apply simplified mechanisms to complex systems.
					</p>
						</li>

						<li>
											<p>
						Guide thought experiments and physical experiments.
					</p>
						</li>

						<li>
											<p>
						Occasionally make precise, quantitative predictions.
					</p>
						</li>

					</ul></p>

				</paragraphs>

				<paragraphs xml:id="what-is-a-mathematical-model">
					<title>What is a mathematical model?</title>


					<paragraphs xml:id="features-and-definitions">
						<title>Features and definitions</title>

						<p>
							A mathematical model is an abstract mathematical description of any (biological) system, using logic, notation, and techniques of mathematics.
						</p>

					</paragraphs>

					<paragraphs xml:id="a-familiar-example">
						<title>A familiar example</title>

						<p>
							Picture a tall, cylindrical water tower with radius <m>r</m> in which the height of the water is <m>h</m>. We want to know how fast the water level is dropping as we draw water from the bottom of the tank at a fixed flow. Our situation relies on the following relationship between volume of water and height of water. <me>(\text{change in volume})\propto(\text{change in height})</me> But what is the actual relationship between the two, and how do we replace <sq><m>\propto</m></sq> with <sq><m>=</m></sq>? First, <me>V=\pi r^2 h,</me> and differentiating, <me>\frac{d^{} {V}}{d {t}^{}} = \pi r^2 \frac{d^{} {h}}{d {t}^{}}.</me>
						</p>

						<p>
							Pause to think about this. We want to know how the height <m>h(t)</m> is changing as a function of time. We are thinking of a cylinder with a fixed radius, <m>r</m>. We will assume that we are in control of the outflow from the tank, <m>\displaystyle \frac{d^{} {V}}{d {t}^{}}</m>.
						</p>

						<p>
							We can write a model for the height, <me>\frac{d^{} {h}}{d {t}^{}}=\frac{\frac{d^{} {V}}{d {t}^{}}}{\pi r^2}.</me>
						</p>

						<p>
							Let’s assume we fix the outflow at <m>\displaystyle100\,\frac{\text{ft}^3}{\text{sec}}</m>, by adjusting the outflow knob. The first consequence is that the volume of water in the tank is decreasing, so that <m>\displaystyle\frac{d^{} {V}}{d {t}^{}}</m> should be negative.
						</p>

						<p>
							We’ll now use our model to study the dynamics of water depth in two theoretical water tanks: one tall and thin and the other short and thick.
						</p>

						<p>
							When <m>r=10</m>, <me>\frac{d^{} {h}}{d {t}^{}}=\frac{-100\,\frac{\text{ft}^3}{\text{sec}}}{\pi \times(10 \text{ft})^2}=-\frac{1}{\pi}\,\frac{\text{ft}}{\text{sec}}.</me> So that the water height <em>drops</em> about 1 foot in approximately 3 seconds.
						</p>

						<p>
							When <m>r=100</m>, <me>\frac{d^{} {h}}{d {t}^{}}=\frac{-100\,\frac{\text{ft}^3}{\text{sec}}}{\pi \times(100 \text{ft})^2}=-\frac{1}{100\pi}\,\frac{\text{ft}}{\text{sec}}.</me> So that the water height <em>drops</em> about 1 foot in approximately 5 minutes!
						</p>

						<p>
							This model allows us to discuss two important and often confused concepts in modeling: the distinction between parameters and (state) variables. The <q>state variable</q> is the <sq>thing</sq> that we are making an effort to model. Here it is the height, <m>h(t)</m> of the water in the tower. Everything else - the outflow volume <m>\left(\displaystyle \frac{d^{} {V}}{d {t}^{}}\right)</m> and the radius <m>(r)</m> is known, or under our control. We call these things parameters. Changing parameters affects the evolution of state variables.
						</p>

					</paragraphs>
				</paragraphs>

				<paragraphs xml:id="why-do-we-write-models-and-what-can-we-model">
					<title>Why do we write models and what can we model?</title>


					<paragraphs xml:id="counting">
						<title>Counting</title>

						<p>
							Models allow us to count things that might be too expensive, too time consuming, or otherwise impossible to count: animals, cells, proteins, viruses, molecules.
						</p>

					</paragraphs>

					<paragraphs xml:id="what-do-we-count">
						<title>What do we count?</title>

						<p><ul>
							<li>
													<p>
							Populations of individual plants or animals that interact (Ecology)
						</p>
							</li>

							<li>
													<p>
							Populations of cells <em>within</em> individuals that interact (Physiology, e.g., Immunology)
						</p>
							</li>

							<li>
													<p>
							Populations of molecules and chemicals <em>within</em> cells that interact (Physiology, e.g., Neurobiology)
						</p>
							</li>

						</ul></p>

					</paragraphs>
				</paragraphs>

				<paragraphs xml:id="what-does-a-model-look-like">
					<title>What does a model look like?</title>

					<p>
						A model is a description of <q>how things change</q> (like the height of water in a water tower). Biologically similar things might change in very different ways and be governed by very different processes.
					</p>


					<paragraphs xml:id="thinking-about-time">
						<title>Thinking about time</title>

						<p>
							We should think about how the organisms, or components of our model, interact with one another.<!-- linebreak -->Dynamics of some plants and animals are characterized by discrete, non-overlapping generations.
						</p>

						<p><ul>
							<li>
													<p>
							Insects might reproduce over just a few days and be dormant over the remainder of the year.
						</p>
							</li>

							<li>
													<p>
							Plants might set seeds over a short season.
						</p>
							</li>

						</ul></p>

						<p>
							Alternatively, we might have a set of measurements at a regular interval (e.g., 2-weeks) that we wish to explain. Many human diseases are often reported to organizations like CDC and WHO at weekly, bi-weekly, or monthly intervals (e.g, measles, cholera, HIV).
						</p>

						<p>
							Other organisms like yeast, bacteria, mice, and so on, might be best described by <sq>continuous-time</sq> dynamics.
						</p>

					</paragraphs>

					<paragraphs xml:id="thinking-about-interactions">
						<title>Thinking about interactions</title>

						<p>
							Interactions might be characterized as linear or non-linear.
						</p>

						<p><ul>
							<li>
													<p>
							From chemistry, <q>first-order reactions</q> are linear - exponential growth or decay result from first order reactions (linear-models).
						</p>
							</li>

							<li>
													<p>
							Reactions with multiple reactants (interactions between Na and Cl, foxes and bunnies, humans and zombies are give rise to nonlinear models - products or functions state variables.
						</p>
							</li>

						</ul></p>

					</paragraphs>

					<paragraphs xml:id="do-we-always-arrive-at-the-same-answer">
						<title>Do we always arrive at the same answer?</title>

						<p>
							Most of the models we study will be deterministic. This means our model (a set of rules, and initial conditions) will always give the same answer.
						</p>

						<p>
							In contrast, some models can handle (random) variability between individuals or at different points in time. These are stochastic models, and while often more complicated, they allow us to ask and answer very different questions. As an example we’ll look at <q>birth-death process</q> models a bit later.
						</p>

					</paragraphs>
				</paragraphs>

				<paragraphs xml:id="one-dimensional-linear-discrete-time-dynamical-systems">
					<title>One-dimensional, Linear, discrete-time dynamical systems</title>


					<paragraphs xml:id="example">
						<title>Example</title>

						<p>
							Consider a population of dandelions living in your front yard over the course of one summer. Let,<!-- linebreak -->
						</p>

						<table>
							<caption></caption>
							<tabular>
							<row class="odd">
								<cell halign="left"><m>N_t</m></cell>
								<cell halign="left">be the number of flowers at the start of week <m>t</m></cell>
							</row>
							<row class="even">
								<cell halign="left"><m>N_{t+1}</m></cell>
								<cell halign="left">be the number of flowers at the start of week <m>t+1</m></cell>
							</row>
							<row class="odd">
								<cell halign="left"><m>r</m></cell>
								<cell halign="left">be the per capita production of flowers</cell>
							</row>
							</tabular>
						</table>

						<p>
							Our model for the growth of dandelions over the summer is, <me>N_{t+1}=r N_t,</me> where <m>N_t</m> is the state variable and <m>r</m> is a parameter that characterizes our population. At the beginning of summer we are lucky enough to have only <m>N_0=2</m> dandelions in the front yard.
						</p>

						<p>
							This is one of the few models we can actually solve. <me>\begin{aligned}
N_1&amp;=r N_0\\
N_2&amp;=r N_1\\
&amp;=r(r(N_0)\\
N_2&amp;=r^2 N_0\end{aligned}</me> In general, <m>N_t=r^t N_0.</m> As we have safely assumed, <m>N_0</m>, is a positive number (of flowers). When do the dandelions take over our yard?
						</p>

						<p>
							<m>N_t</m> increases each generation if <m>r&gt;1</m> and decreases each generation if <m>r&lt;1</m>. Since we defined <m>r</m> as the <sq>per capita production of new flowers,</sq> this should be comforting. If each flower does better than replacing itself we will always have an increasing number of flowers. If each flower fails to replace itself, our population will shrink. Solutions are tabulated in Tab. <xref ref="tab::dandelion_grow" />.
						</p>

<!-- div attr= xml:id="tab::dandelion_grow"-->
						<table>
							<caption>Weekly dandelion growth over the summer, for growing (left) and shrinking (right) populations. Think about what a plot of these solutions would look like.</caption>
							<tabular>
							<row header="yes">
								<cell halign="left">Week</cell>
								<cell halign="left">Population (with <m>r&gt;1</m>)</cell>
							</row>
							<row class="odd">
								<cell halign="left">0</cell>
								<cell halign="left">2</cell>
							</row>
							<row class="even">
								<cell halign="left">1</cell>
								<cell halign="left">3</cell>
							</row>
							<row class="odd">
								<cell halign="left">2</cell>
								<cell halign="left">4.5</cell>
							</row>
							<row class="even">
								<cell halign="left">3</cell>
								<cell halign="left">6.75</cell>
							</row>
							<row class="odd">
								<cell halign="left">4</cell>
								<cell halign="left">10.125</cell>
							</row>
							<row class="even">
								<cell halign="left">5</cell>
								<cell halign="left">15.188</cell>
							</row>
							<row class="odd">
								<cell halign="left">6</cell>
								<cell halign="left">22.781</cell>
							</row>
							<row class="even">
								<cell halign="left">7</cell>
								<cell halign="left">34.172</cell>
							</row>
							<row class="odd">
								<cell halign="left">8</cell>
								<cell halign="left">51.258</cell>
							</row>
							<row class="even">
								<cell halign="left">9</cell>
								<cell halign="left">76.887</cell>
							</row>
							<row class="odd">
								<cell halign="left">10</cell>
								<cell halign="left">115.33</cell>
							</row>
							</tabular>
						</table><!--</div attr= xml:id="tab::dandelion_grow">-->

<!-- div attr= xml:id="tab::dandelion_grow"-->
						<table>
							<caption>Weekly dandelion growth over the summer, for growing (left) and shrinking (right) populations. Think about what a plot of these solutions would look like.</caption>
							<tabular>
							<row header="yes">
								<cell halign="left">Week</cell>
								<cell halign="left">Population (with <m>r&lt;1</m>)</cell>
							</row>
							<row class="odd">
								<cell halign="left">0</cell>
								<cell halign="left">115</cell>
							</row>
							<row class="even">
								<cell halign="left">1</cell>
								<cell halign="left">57.5</cell>
							</row>
							<row class="odd">
								<cell halign="left">2</cell>
								<cell halign="left">28.75</cell>
							</row>
							<row class="even">
								<cell halign="left">3</cell>
								<cell halign="left">14.375</cell>
							</row>
							<row class="odd">
								<cell halign="left">4</cell>
								<cell halign="left">7.188</cell>
							</row>
							<row class="even">
								<cell halign="left">5</cell>
								<cell halign="left">3.594</cell>
							</row>
							<row class="odd">
								<cell halign="left">6</cell>
								<cell halign="left">1.797</cell>
							</row>
							<row class="even">
								<cell halign="left">7</cell>
								<cell halign="left">0.898</cell>
							</row>
							<row class="odd">
								<cell halign="left">8</cell>
								<cell halign="left">0.449</cell>
							</row>
							<row class="even">
								<cell halign="left">9</cell>
								<cell halign="left">0.225</cell>
							</row>
							<row class="odd">
								<cell halign="left">10</cell>
								<cell halign="left">0.112</cell>
							</row>
							</tabular>
						</table><!--</div attr= xml:id="tab::dandelion_grow">-->

						<p>
							We can extract more biological information by considering the factors contributing to the per capita production rate, <m>r</m>. Population growth depends on seedling recruitment and survival. Let,<!-- linebreak -->
						</p>

						<table>
							<caption></caption>
							<tabular>
							<row class="odd">
								<cell halign="left"><m>s</m></cell>
								<cell halign="left">be the number of seedlings generated per plant</cell>
							</row>
							<row class="even">
								<cell halign="left"><m>\sigma</m></cell>
								<cell halign="left">be the fraction of seedlings that survive and grow to adulthood</cell>
							</row>
							<row class="odd">
								<cell halign="left"><m>a</m></cell>
								<cell halign="left">be the fraction of adults that survive</cell>
							</row>
							</tabular>
						</table>

						<p>
							We can re-write our model <me>\begin{aligned}
N_{t+1} &amp;= rN_t\\
&amp;=s\sigma N_t+a N_t\\
N_{t+1} &amp;= (s\sigma+a)N_t\end{aligned}</me>
						</p>

						<p>
							This suggests a few ways that a population can grow,
						</p>

						<p><ul>
							<li>
													<p>
							highly productive adult plants that generate lots of seedlings (large <m>s</m>)
						</p>
							</li>

							<li>
													<p>
							highly viable seedlings that are likely to survive to <sq>adulthood</sq>
						</p>
							</li>

							<li>
													<p>
							tough adult plants that are likely to survive
						</p>
							</li>

						</ul></p>

						<p>
							In all, we need <m>r=s\sigma+a&gt;1</m> for the plants to grow.
						</p>

						<p>
							Thinking about equilibria is key to understanding dynamics of dandelions. Equilibria (or steady-states, or fixed-points) are values at which the solution is unchanging. With our notation this means <m>N_{t+1}=N_t=N^*</m>. By inspection of Figure <xref ref="fig::dandelion" />, the only equilibrium point is <m>N^*=0</m>, this is the only place that either of our labeled lines intersect the diagonal.
						</p>

					</paragraphs>
				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="linear-discrete-time-models-2d">
				<title>Linear discrete-time models (2D)</title>


				<paragraphs xml:id="more-on-linear-models-1d">
					<title>More on linear models (1D)</title>


					<paragraphs xml:id="example-ii">
						<title>Example II</title>

						<p>
							It might be the case, however, that our neighbors secretly transplant dandelions in our yards at night. To mimic this unkind reality, assume that <m>F\geq0</m> flowers are arriving each week. Our new model is,<me>N_{t+1}=r N_t+F.</me>
						</p>

						<p>
							How does <sq>flower immigration</sq> affect dynamics? If we replace both <m>N_{t+1}</m> and <m>N_t</m> by <m>N^*</m> the equilibrium value, we have <me>N^*=rN^*+F.</me> This gives us a value for the flower population, <me>N^*=\frac{F}{1-r},</me> which tells us that <m>N^*&gt;0</m> if <m>r&lt;1</m> and <m>N^*&lt;0</m> if <m>r&gt;1</m>. It is important to notice early on that only non-negative equilibria make sense on most biological situations, especially with regard to population dynamics. With immigration (importation of plants), solutions can be traced on the diagrams in Fig. <xref ref="fig::dandelion2" />.
						</p>


						<paragraphs xml:id="computational-trick.">
							<title>Computational trick.</title>

							<p>
								One way to solve this problem is to study deviations from the equilibrium, <m>N^*</m>. We’re going to assume that <m>r&lt;1</m>, since it is only then that we have a sensible equilibrium.
							</p>

							<p>
								Let <m>x_t</m> be the deviation from equilibrium at time <m>t</m> so that, <me>\begin{aligned}
{2}
N_t &amp;=N^*+x_t &amp; \qquad\text{(the definition)}\\
N_0&amp;=N^*+x_0 &amp; \qquad\text{(the initial condition)}\\\end{aligned}</me>
							</p>

							<p>
								And finally, <me>\begin{aligned}
{2}
x_{t+1} &amp;=N_{t+1}-N^* &amp; \qquad\text{(from the definition)}\\
x_{t+1} &amp;=\left(rN_t+F\right)-N^* &amp; \qquad\text{(from the model)}\\
x_{t+1} &amp;=\left(r\left(N^*+x_t\right)+F\right)-N^* &amp; \qquad\text{(from the definition)}\\
x_{t+1} &amp;=\left(rN^*+F\right)+rx_t-N^* &amp; \qquad\text{(shuffle)}\\
x_{t+1} &amp;=\left(N^*\right)+rx_t-N^* &amp; \qquad\text{(equilibrium condition)}\\
x_{t+1} &amp;=rx_t &amp; \qquad\text{(evolution of }x_t\text{)}\\\end{aligned}</me>
							</p>

							<p>
								So, it looks like <m>x_t</m> evolves according to <me>x_t=r^tx_0.</me> Which gives, <me>\begin{aligned}
N_t&amp;=N^*+x_t\\
&amp;=N^*+r^tx_0\\
&amp;=N^*+r^t\left(N_0-N^*\right)\\
N_t&amp;=(1-r^t)N^*+r^tN_0.\end{aligned}</me> Thus, the solution is a weighted average of <m>N^*</m> and <m>N_0</m>, and depends on the weight <m>r</m>. For <m>r&lt;1</m> weight moves from <m>N_0</m> to <m>N^*</m> as <m>t</m> increases (the abundance of the initial flowers is reduced). Since we have a formula for <m>N^*</m>, we can also plug it into the final equation above <me>\begin{aligned}
{2}N_t&amp;=(1-r^t)\left(\frac{F}{1-r}\right) + r^tN_0 &amp; \hspace{-2cm}\text{(from the equilibrium, }N^*)\\
N_t&amp;=\left(\sum_{k=0}^{n-1} r^k\right)F + r^tN_0 &amp; \hspace{-2cm}\text{(geometric series)}\\
N_t&amp;=\left(1+r+r^2+\dots+r^{t-1}\right)F + r^tN_0 &amp; \hspace{-2cm}\text{(expanding a geometric progression)}\\
N_t&amp;=\underbrace{F}_{\text{\begin{tabular}{c}current \\[-6pt]immigrant\\[-6pt] flowers\end{tabular}}}+\underbrace{rF}_{\text{\begin{tabular}{c}last week's\\[-6pt] immigrant \\[-6pt]flowers\end{tabular}}} + r^2F+ \dots +\underbrace{r^{t-1}F}_{\text{\begin{tabular}{c}first week's \\[-6pt] immigrant \\[-6pt]flowers\end{tabular}}} + \underbrace{r^tN_0}_{\text{\begin{tabular}{c}initial flowers\\[-6pt] that remain\end{tabular}}} &amp; \hspace{-2.5cm}\text{(distributing terms)}\end{aligned}</me> We can see what <sq>generations</sq> form our population at any given week using the last of the above formulas. Of course, we could have started here by applying our model recursively. But, this approach gives some nice information about our solution in terms of equilibria (<m>N^*</m>), initial values (<m>N_0</m>), and perturbations (<m>x_t</m>).
							</p>

						</paragraphs>
					</paragraphs>
				</paragraphs>

				<paragraphs xml:id="matrix-models-2d-linear-discrete-time-dynamics">
					<title>Matrix models: 2D, Linear, Discrete-time Dynamics</title>

					<p>
						Recall our example concerning weekly dandelion dynamics. Previously, we counted only the number of flowering plants present in our <sq>yard</sq> each week. We can count a bit more carefully, and take advantage of more biological information if we think about the ’structure’ of the population. Ignoring seeds, in reality we have at least a few ways to break down the plant community:
					</p>

					<p><ul>
						<li>
											<p>
						juveniles vs. adults
					</p>
						</li>

						<li>
											<p>
						seedlings vs. vegetative vs. flowering vs. seed-setting
					</p>
						</li>

						<li>
											<p>
						non-reproductive vs. reproductive
					</p>
						</li>

					</ul></p>

					<p>
						We will lump together the seedlings and vegetative plans as <sq>non-reproductive</sq> and the flowering and seed-setting plants as <sq>reproductive</sq>. Let <m>V_t</m> be the number of non-reproductive (vegetative) plants in the yard and <m>R_t</m> be the number of reproductive plants in the yard, both at week <m>t</m>.
					</p>

					<p>
						We will use familiar notation for parameters. Since it is challenging to count seeds after they have left the plant, and nobody vacuums seeds from the yard, we’ll focus on the life stages above.<!-- linebreak -->
					</p>

					<table>
						<caption></caption>
						<tabular>
						<row class="odd">
							<cell halign="left"><m>s</m></cell>
							<cell halign="left">be the number of seedlings generated per plant</cell>
						</row>
						<row class="even">
							<cell halign="left"><m>\sigma</m></cell>
							<cell halign="left">be the fraction of seedlings that survive to adulthood</cell>
						</row>
						<row class="odd">
							<cell halign="left"><m>a</m></cell>
							<cell halign="left">be the fraction of adults that survive</cell>
						</row>
						</tabular>
					</table>

					<p>
						This means we can write <me>\begin{aligned}
V_{t+1}&amp;=0\cdot V_t+s\cdot R_t\\
R_{t+1}&amp;=\sigma \cdot V_t+ a\cdot R_t.\end{aligned}</me> This looks like a matrix equation, <me>\left(\begin{tabular}{c}$V_{t+1}$\\$R_{t+1}$\end{tabular}\right) = \left(\begin{tabular}{cc}$0$ &amp; $s$\\$\sigma$ &amp; $a$\end{tabular}\right)\left(\begin{tabular}{c}$V_{t}$\\$R_{t}$\end{tabular}\right).</me> With a single equation, it was easy enough to determine growth. This is less obvious with a higher dimensional model. Additionally, we might be interested in the following questions:
					</p>

					<p><ul>
						<li>
											<p>
						Will the population grow?
					</p>
						</li>

						<li>
											<p>
						If it grows, how fast is it going to grow?
					</p>
						</li>

						<li>
											<p>
						What is the balance between reproductive and non-reproductive dandelions in the population?
					</p>
						</li>

					</ul></p>

					<p>
						For a plant starting in the non-reproductive state (a one week old plant), we track its lifetime reproduction in the following table:
					</p>

<!-- div attr= xml:id="tab::elr"-->
					<table>
						<caption>Starting with a single female, she must survive to adulthood (<m>\sigma</m>), then every time after survive another week as an adult (a).</caption>
						<tabular>
						<row header="yes">
							<cell halign="left">Age (Weeks)</cell>
							<cell halign="left">Population</cell>
							<cell halign="left">Fecundity</cell>
						</row>
						<row class="odd">
							<cell halign="left">1</cell>
							<cell halign="left">1</cell>
							<cell halign="left">0</cell>
						</row>
						<row class="even">
							<cell halign="left">2</cell>
							<cell halign="left"><m>\sigma</m></cell>
							<cell halign="left"><m>s</m></cell>
						</row>
						<row class="odd">
							<cell halign="left">3</cell>
							<cell halign="left"><m>\sigma</m> <m>a</m></cell>
							<cell halign="left"><m>s</m></cell>
						</row>
						<row class="even">
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
						</row>
						<row class="odd">
							<cell halign="left">n</cell>
							<cell halign="left"><m>\sigma a ^{n-2}</m></cell>
							<cell halign="left"><m>s</m></cell>
						</row>
						<row class="even">
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
						</row>
						</tabular>
					</table><!--</div attr= xml:id="tab::elr">-->

					<p>
						Next we append a column for the reproductive value of each age (remembering that our model only tracks two age classes, but once plants flower they <em>could</em> survive indefinitely):
					</p>

<!-- div attr= xml:id="tab::elr"-->
					<table>
						<caption>Starting with a single female, she must survive to adulthood (<m>\sigma</m>), then every time after survive another week as an adult (a).</caption>
						<tabular>
						<row header="yes">
							<cell halign="left">Age (Weeks)</cell>
							<cell halign="left">Population</cell>
							<cell halign="left">Fecundity</cell>
							<cell halign="left">Value</cell>
						</row>
						<row class="odd">
							<cell halign="left">1</cell>
							<cell halign="left">1</cell>
							<cell halign="left">0</cell>
							<cell halign="left">0</cell>
						</row>
						<row class="even">
							<cell halign="left">2</cell>
							<cell halign="left"><m>\sigma</m></cell>
							<cell halign="left"><m>s</m></cell>
							<cell halign="left"><m>s\sigma</m></cell>
						</row>
						<row class="odd">
							<cell halign="left">3</cell>
							<cell halign="left"><m>\sigma a</m></cell>
							<cell halign="left"><m>s</m></cell>
							<cell halign="left"><m>s\sigma</m> a</cell>
						</row>
						<row class="even">
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
						</row>
						<row class="odd">
							<cell halign="left">n</cell>
							<cell halign="left"><m>\sigma a ^{n-2}</m></cell>
							<cell halign="left"><m>s</m></cell>
							<cell halign="left"><m>s\sigma a^{n-2}</m></cell>
						</row>
						<row class="even">
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
							<cell halign="left">…</cell>
						</row>
						</tabular>
					</table><!--</div attr= xml:id="tab::elr">-->

					<p>
						Starting from seedling, the expected lifetime reproduction of a plant is <me>ELR=s\sigma+s\sigma a + s\sigma a^2 + \dots .</me> By definition <m>a</m> is a weekly survival probability for adult plants, so <m>a\leq1</m>. Keep this in mind as we press on: <me>\begin{aligned}
ELR &amp; = s\sigma+s\sigma a + s\sigma a^2 + \dots \\
&amp; = s\sigma\left(1+a+a^2+\dots\right)\\
&amp; = s\sigma \sum_{k=0}^\infty a^k\end{aligned}</me> Knowing what we do about geometric series, <me>ELR = s\sigma \sum_{k=0}^\infty a^k = s\sigma\left(\frac{1}{1-a}\right).</me> So, <m>ELR &gt;1</m> when <m>s\sigma&gt;1-a</m>. This is identical to our <sq>adult plant</sq>-only model result,<me>s\sigma+a&gt;1!</me>
					</p>


					<paragraphs xml:id="questions">
						<title>Questions</title>

						<p><ul>
							<li>
													<p>
							What’s so special about ELR as a measure of growth?
						</p>
							</li>

							<li>
													<p>
							How does ELR relate to eigenvalues?
						</p>
							</li>

						</ul></p>

					</paragraphs>

					<paragraphs xml:id="answers">
						<title>Answers</title>

						<p>
							For a matrix <m>A</m>, like our transition matrix above, a number <m>\lambda</m> is an eigenvalue with eigenvector <m>x</m> if<me>Ax=\lambda x.</me> The eigenvalue reduces the dimension in multidimensional problems. It turns matrix multiplication into scalar multiplication. How do we find eigenvalues?
						</p>

<!-- Horizontal Rule Not Implimented -->


						<paragraphs xml:id="linear-algebra-review">
							<title>Linear algebra review</title>

							<p>
								We first want to write our eigenvalue problem as:<me>Ax-\lambda x=0.</me> Then, since <m>\lambda</m> is a number, <me>(A-\lambda I)x=0,</me> where <m>I</m> is the appropriate <sq>identity matrix</sq>.
							</p>

							<p>
								Let’s take <me>A= \left(\begin{tabular}{cc}$a$ &amp; $b$\\$c$ &amp; $d$\end{tabular}\right),</me> so that <me>A-\lambda I= \left(\begin{tabular}{cc}$a-\lambda$ &amp; $b$\\$c$ &amp; $d-\lambda$\end{tabular}\right).</me>
							</p>

							<p>
								Eigenvalues solve <me>\operatorname{det}(A-\lambda I)=0.</me> <me>\begin{aligned}
0&amp;=\operatorname{det}(A-\lambda I)\\
&amp;=(a-\lambda)(d-\lambda)-bc\\
0&amp;=\lambda^2-(a+d)\lambda+ad-bc\end{aligned}</me>
							</p>

							<p>
								Solutions are<me>\lambda_{\pm}=\frac{(a+d)\pm\sqrt{(a+d)^2-4(ad-bc)}}{2}.</me> From here it helps to consider specific examples so we do not have to solve equations containing obtuse algebraic expressions.
							</p>

<!-- Horizontal Rule Not Implimented -->

						</paragraphs>
					</paragraphs>
				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="linear-discrete-time-models-2d-1">
				<title>Linear discrete-time models (2D)</title>


				<paragraphs xml:id="question.">
					<title>Question.</title>

					<p>
						How do structured and unstructured populations differ?<!-- linebreak -->From a one dimensional model ignoring plant developmental stage,<me>N_t=r N_t,</me> where <m>r=s\sigma+a</m>, we wrote a two-dimensional model,<me>P_{t+1}=MP_t,</me> where <m>P_0=(V_0, R_0)^T</m> and <me>M=\left(\begin{tabular}{cc}$0$ &amp; $s$\\$\sigma$ &amp; $a$\end{tabular}\right).</me>
					</p>

					<p>
						Keeping with our example, eigenvalues of <m>M</m> are found using <me>\det\left(\begin{tabular}{cc}$-\lambda$ &amp; $s$\\$\sigma$ &amp; $a-\lambda$\end{tabular}\right)=0.</me> This gives <me>\begin{aligned}
0&amp;=-\lambda(a-\lambda)-s\sigma\\
&amp;=\lambda^2-a\lambda-s\sigma\end{aligned}</me> Using the quadratic formula,<me>\lambda_\pm = \frac{a\pm\sqrt{a^2+4s\sigma}}{2}.</me>
					</p>

					<p>
						Suppose we know the initial plant distribution, <me>P_0=\left(\begin{tabular}{c}$V_0$\\$R_0$\end{tabular}\right),</me> the solution to our model is <me>P_t=M^tP_0.</me> First write, <m>P_0=c_1 v_1+c_2 v_2</m>, where <m>c_1, c_2</m> are constants and <m>v_1, v_2</m> are eigenvectors. We are assuming that <m>v_1, v_2</m> are linearly independent, thus they form a basis in two-dimensions, such that any other vector can be written as a linear combination. <me>\begin{aligned}
{2}
P_1&amp;=A P_0 &amp; \quad\text{(start)}\\
&amp; = A(c_1 v_1+c_2 v_2)&amp; \quad\text{(basis vectors)}\\
&amp; = c_1 Av_1+c_2 Av_2&amp; \quad\text{(distributive property)}\\
P_1&amp; = c_1 \lambda_1 v_1+c_2 \lambda_2v_2&amp; \quad\text{(eigenvalues!)}\end{aligned}</me> We can compute <m>P_2</m>, <me>\begin{aligned}
P_2&amp;=A P_1\\
&amp; = A(c_1 \lambda_1 v_1+c_2 \lambda_2 v_2)\\
&amp; = (c_1 \lambda_1) Av_1+(c_2\lambda_2) Av_2\\
&amp; = c_1 \lambda_1^2 v_1+c_2 \lambda_2^2v_2\end{aligned}</me> And similarly, <me>P_t=c_1\lambda_1^tv_1+c_2\lambda_2^tv_2.</me> If we assume that <m>|\lambda_1|&gt;|\lambda_2|</m>, then <me>P_t\approx c_1 \lambda_1^t v_1.</me> We will see how this approximation works at the end of the following example. But, perhaps motivated by this approximation, we see that the magnitude of <m>\lambda_1</m> is important to the growth of the population, both <m>V_t</m> and <m>R_t</m>. The population changes by a factor <m>\lambda_1</m> each generation. It grows if <m>\lambda_1&gt;1</m> and shrinks if <m>\lambda_1&lt;1</m>.
					</p>

					<p>
						Let <m>\lambda_1</m> be the positive eigenvalue, <m>\lambda_1&gt;1</m>, <me>\begin{aligned}
\lambda_1 = \frac{a+\sqrt{a^2+4s\sigma}}{2}&amp;&gt;1\\
a+\sqrt{a^2+4s\sigma}&amp;&gt;2\\
\sqrt{a^2+4s\sigma}&amp;&gt;2-a\\
a^2+4s\sigma&amp;&gt;(2-a)^2\\
a^2+4s\sigma&amp;&gt;4-4a+a^2\\
4s\sigma&amp;&gt;4-4a\\
s\sigma&amp;&gt;1-a\\
s\sigma+a&amp;&gt;1\end{aligned}</me> The positive eigenvalue <m>\lambda_1&gt;1</m> if <m>r=s\sigma+a&gt;1</m>, but in general, <m>ELR\neq\lambda_1</m>! But, if <m>\lambda_1&gt;1</m> so is <m>ELR</m>, and vice versa. Again, our characteristic polynomial, that governs the eigenvalues is<me>C(\lambda)=\lambda^2-a\lambda-s\sigma.</me> Since <m>s, \sigma&gt;0</m>, we have <m>C(0)&lt;0</m> and we know that <m>C(\lambda)</m> is concave up. If <m>C(1)&lt;0</m>, we know that the leading eigenvalue <m>\lambda&gt;1</m>. Lastly, let’s study the relationships between <m>1, \lambda_+</m>, and <m>r</m>. We’ve already looked at some of the relationships involving <m>1</m>. Now, <m>\lambda&lt;r=s\sigma+a</m> when <me>\begin{aligned}
0&amp;&lt;C(r)\\
0&amp;&lt;r^2-ar-s\sigma\\
s\sigma&amp;&lt;r(r-a)\\
s\sigma&amp;&lt;(s\sigma+a)(s\sigma+a-a)\\
s\sigma&amp;&lt;s\sigma(s\sigma+a)\\
0&amp;&lt;s\sigma(s\sigma+a)-s\sigma\\
0&amp;&lt;s\sigma(s\sigma+a-1)\end{aligned}</me> This is satisfied when <m>r=s\sigma+a&gt;1</m>, thus <m>1&lt;\lambda&lt;ELR</m>. For the reverse, <m>ELR&lt;\lambda&lt;1</m> when <m>r=s\sigma+a&lt;1</m>. We will also look at the relationships between <m>r</m>, <m>ELR</m>, and <m>\lambda</m> in the example, so that we can actually compute eigenpair.
					</p>


					<paragraphs xml:id="example.">
						<title>Example.</title>

						<p>
							Recall <m>r=s\sigma+a</m> was the per generation growth rate from the one-equation model. In that model, we made no distinction between plant growth stages, an assumed that all plants were capable of reproducing. When we considered the reproductive schedule of our plants, we derived <m>ELR</m> as a measure of the replacement rate of each individual plant. Let <m>a=\frac{2}{3}</m>, <m>s=\frac{16}{9}</m>, <m>\sigma=\frac{1}{2}</m>, so that, <m>r=\left(\frac{16}{9}\right)\left(\frac{1}{2}\right)+ \left(\frac{2}{3}\right)= \left(\frac{14}{9}\right)\approx1.\overline{55}</m>. Also, <m>ELR=\frac{\left(\frac{16}{9}\right)\left(\frac{1}{2}\right)}{\frac{1}{3}}=\frac{8}{3}\approx2.\overline{66}</m>.When vegetative plants are less likely to mature (small <m>\sigma</m>, Fig. <xref ref="fig::elr_eig" />) weekly adult survivorship, <m>a</m>, must increase in order for population growth to occur (<m>r, ELR, \lambda&gt;1</m>).
						</p>

						<figure>
	<image source="elr_vs_eig_a.pdf"/>
							<caption>Relationships between <m>r</m>, <m>ELR</m>, and <m>\lambda</m>, for fixed <m>s=\frac{16}{9}</m> and (left) <m>\sigma=\frac{1}{2}</m> or (right) <m>\sigma=\frac{1}{3}</m>, over a range of adult weekly survival probabilities, <m>0\leq a\leq 1</m>.</caption>
</figure>

						<figure>
	<image source="elr_vs_eig_b.pdf"/>
							<caption>Relationships between <m>r</m>, <m>ELR</m>, and <m>\lambda</m>, for fixed <m>s=\frac{16}{9}</m> and (left) <m>\sigma=\frac{1}{2}</m> or (right) <m>\sigma=\frac{1}{3}</m>, over a range of adult weekly survival probabilities, <m>0\leq a\leq 1</m>.</caption>
</figure>


						<paragraphs xml:id="question.-1">
							<title>Question.</title>

							<p>
								What is the effect of population structure (tracking flower types), in growing and shrinking flower populations (see Fig. <xref ref="fig::elr_eig" />)?<!-- linebreak -->
							</p>

						</paragraphs>

						<paragraphs xml:id="answer.">
							<title>Answer.</title>

							<p>
								Imposing structure reduces the growth rate (relative to <m>r</m>) in growing populations. Imposing structure slows the decay rate (relative to <m>r</m>) in shrinking populations.<!-- linebreak -->In this parameterization, <me>\begin{aligned}
\lambda_\pm &amp;= \frac{\frac{2}{3}\pm\sqrt{\frac{4}{9}+4\left(\frac{16}{9}\right)\left(\frac{1}{2}\right)}}{2}\\
&amp;=\frac{1}{3}\pm\frac{1}{2}\sqrt{\frac{4}{9}+\frac{32}{9}}\\
&amp;=\frac{1}{3}\pm1\\
\lambda_\pm&amp;=\frac{4}{3}, -\frac{2}{3}.\end{aligned}</me> <me>\left(\begin{tabular}{cc}$0$ &amp; $\frac{16}{9}$\\[2pt]$\frac{1}{2}$ &amp; $\frac{2}{3}$\end{tabular}\right)\left(\begin{tabular}{c}$x_1$\\$x_2$\end{tabular}\right)= \frac{4}{3}\left(\begin{tabular}{c}$x_1$\\$x_2$\end{tabular}\right).</me> Notice that <m>ELR&gt;\lambda_+&gt;1</m>, so that the population grows.
							</p>

							<figure>
	<image source="SAD.pdf"/>
								<caption>Left) Weekly temporal dynamics of vegetative and reproductive plants. Right) Stable age distribution and iterated solutions starting from <m>(V_0, R_0)=(0,1)</m>. Initial condition is black dot.</caption>
</figure>

							<p>
								The eigenvector associated with <m>\lambda=\frac{4}{3}</m> is of the form<me>v_1=\left(\begin{tabular}{c}$x_1$\\$\frac{3}{4}x_1$\end{tabular}\right).</me> The eigenvector associated with <m>\lambda=-\frac{2}{3}</m> is of the form<me>v_1=\left(\begin{tabular}{c}$x_1$\\$-\frac{3}{8}x_1$\end{tabular}\right).</me>
							</p>

						</paragraphs>

						<paragraphs xml:id="question.-2">
							<title>Question.</title>

							<p>
								How do the eigenvectors help explain long term population growth (see Fig. <xref ref="fig::SAD" />)?<!-- linebreak -->
							</p>

						</paragraphs>

						<paragraphs xml:id="answer.-1">
							<title>Answer.</title>

							<p>
								Long-term proportions approach the distribution described by the leading eigenvector. Numbers increase geometrically.<!-- linebreak -->Start with a typical initial condition <m>P_0=(V_0, R_0)=(0,1)</m>. We first want to express <m>P_0</m> as a linear combination of eigenvectors.<me>\left(\begin{tabular}{c}$0$\\$1$\end{tabular}\right) = c_1\left(\begin{tabular}{c}$1$\\$\frac{3}{4}$\end{tabular}\right)+c_2\left(\begin{tabular}{c}$1$\\$-\frac{3}{8}$\end{tabular}\right).</me> Skipping a few calculations, <m>c_1=-c_2</m> and <m>c_1=\frac{8}{9}</m>. Finally we can write, <me>\begin{aligned}
P_1&amp;=A P_0\\
&amp; = A\left(c_1\left(\begin{tabular}{c}$1$\\$\frac{3}{4}$\end{tabular}\right)+c_2 \left(\begin{tabular}{c}$1$\\$-\frac{3}{8}$\end{tabular}\right)\right)\\
&amp; = c_1 A\left(\begin{tabular}{c}$1$\\$\frac{3}{4}$\end{tabular}\right)+c_2 A\left(\begin{tabular}{c}$1$\\$-\frac{3}{8}$\end{tabular}\right)\\
P_1&amp; = c_1 \lambda_1^2 \left(\begin{tabular}{c}$1$\\$\frac{3}{4}$\end{tabular}\right)+c_2 \lambda_2^2\left(\begin{tabular}{c}$1$\\$-\frac{3}{8}$\end{tabular}\right)\\
P_1&amp; = \left(\frac{8}{9}\right) \left(\frac{4}{3}\right)^2 \left(\begin{tabular}{c}$1$\\$\frac{3}{4}$\end{tabular}\right)- \left(\frac{8}{9}\right) \left(\frac{2}{3}\right)^2\left(\begin{tabular}{c}$1$\\$-\frac{3}{8}$\end{tabular}\right),\end{aligned}</me> as before. Iterating this solution we wind up with, <me>P_t=\frac{8}{9}\left(\frac{4}{3}\right)^t\left(\begin{tabular}{c}$1$\\$\frac{3}{4}$\end{tabular}\right)-\frac{8}{9}\left(\frac{2}{3}\right)^t\left(\begin{tabular}{c}$1$\\$-\frac{3}{8}$\end{tabular}\right)</me> Since the second term contains a value <m>\lambda_2&lt;1</m> which is raised to a larger and larger power, its contribution decreases. If we ignore it (at large <m>t</m>), <me>P_t\approx\frac{8}{9}\left(\frac{4}{3}\right)^t\left(\begin{tabular}{c}$1$\\$\frac{3}{4}$\end{tabular}\right).</me>
							</p>

							<p>
								The population will grow 33% larger each generation, but the proportion of young (non-reproductive) and old (reproductive) plants will remain fixed. This suggests that juvenile (tasty young plants) will outnumber the older flowering plants, specifically, the flowering plants will be 75% the abundance of young plants. Alternatively, young plants will be 33% more abundant than old plants. It might also be useful to use our leading eigenvector approximation, rather than our exact matrix solution. We plot the approximate dynamics of each plant type, as well as the comparison of the exact and approximate solutions in Fig. <xref ref="fig::exac_app" />
							</p>

							<figure>
	<image source="exact_vs_approx.pdf"/>
								<caption>Left) Approximate dynamics using first eigenpair. Right) Iterated solutions starting from <m>(V_0, R_0)=(0,1)</m> for matrix solutions (open circles) and approximate solutions (closed circles).</caption>
</figure>

						</paragraphs>
					</paragraphs>
				</paragraphs>
			</subsubsection>
		</subsection>

		<subsection xml:id="nonlinear-discrete-time-models">
			<title>Nonlinear discrete-time models</title>


			<subsubsection xml:id="nonlinear-discrete-time-models-1d">
				<title>Nonlinear discrete-time models (1D)</title>


				<paragraphs xml:id="review-linear-models">
					<title>Review: Linear models</title>

					<p>
						We want to outline our options for solving linear, discrete-time, matrix models. We’ll take a model <me>P_{t+1}=M P_t,</me> for now we will think of <m>M</m> as a matrix and <m>P_t</m> as a vector.
					</p>

				</paragraphs>

				<paragraphs xml:id="per-capita-production-and-nonlinear-effects">
					<title>per capita production and nonlinear effects</title>

					<p>
						So far our model has roughly been, <me>N_{t+1}=r N_t,</me> or <me>P_{t+1}=M P_{t},</me> where <m>N_t</m> and <m>r</m> are scalars, or <m>P_t</m> is a vector and <m>M</m> is a matrix.
					</p>

					<p>
						As an example of a 1D model, our linear model assumes that <me>\frac{N_{t+1}}{N_t}=r,</me> or the ratio of current population to previous population is <m>r</m>, no matter the size of the previous generation. Instead, we might expect that, for a variety of reasons (like space, food, aggression, or lack of resources) this ratio decreases as the current population size increases. Mathematically, this requires <m>r=r(N_t)</m>.
					</p>

					<p>
						In words, small populations are capable of large increases from one generation to the next. But, large populations might only increase by slight amounts over generations. In fact, really large populations might actually shrink. The comparison of linear and nonlinear models is given in Fig. <xref ref="fig::pcp" />.
					</p>

					<figure>
	<image source="lin_nonlin_pcp.pdf"/>
						<caption>Per capita production plots. Left) Generation to generation change independent of population size, Right) change dependent on population size for three famous models of <sq>density dependence</sq>.</caption>
</figure>

					<p>
						Notice the peculiarity of the black line (or curve) in the right panel of Fig. <xref ref="fig::pcp" />(or <xref ref="fig::nonlin_upd" />). It quite happily <sq>goes negative</sq>, which means for an initially large enough population, the subsequent generation is multiplied by a negative number. Simply stated, that is weird. Fortunately, our other models circumvent this problem by requiring <m>p.c.p.&gt;0</m> at all population sizes.
					</p>

					<p>
						Multiplying <m>p.c.p</m> by population size <m>N_t</m> gives our updating function, <m>f(N_t)=(p.c.p.)\times N_t</m>. Then, our model is <me>N_{t+1}=f(N_t)=(p.c.p.)\times N_t.</me> Some sample updating functions are plotted in Fig. <xref ref="fig::upd" />. Notice that there are some major qualitative changes when we compare the line in the left panel to any of the curves in the right panel. Most importantly, the updating function intersects the resetting line more than once. Again, these intersections suggest that <me>N_{t+1}=N_t=N^*.</me> Recalling our previous notation and definitions, these nonlinear models possess multiple equilibria!
					</p>

					<figure>
	<image source="lin_nonlin_upd.pdf"/>
						<caption>Cobwebbing diagrams. Left) Updating functions of linear model, Right) change dependent on population size for three famous models of <sq>density dependence</sq>.</caption>
</figure>


					<paragraphs xml:id="example.-1">
						<title>Example.</title>

						<p>
							We now consider a population <m>G_t</m>, which is the number of guppies living in a bowl on our desk. For simplicity, we will assume that we start with a female guppy who is gravid. Guppies are fascinating creatures that can spawn indefinitely after mating once. We’ll ignore the fact that she gives birth to males and females, so that <sq>number of guppies</sq> above actually means ‘number of <em>female</em> guppies.
						</p>

						<p>
							Guppies are fascinating, but cruel - they are quite happy to eat each other. It’s hard to track, but we know that as the guppy tank fills we see fewer baby guppies (i.e., per capita production drops as in Fig. <xref ref="fig::pcp" />). For a model of guppy dynamics, we will assume <me>G_{t+1}=rG_t e^{-kG_t}.</me> This model has been sketched above in the green curves of Figs. <xref ref="fig::pcp" />, <xref ref="fig::upd" />.
						</p>

						<p>
							For a particular choice of parameters we find the following diagram and iterated solution.
						</p>

						<figure>
	<image source="f3.pdf"/>
							<caption>Cobwebbing diagram and iterated solution for <m>r=3.7</m>, <m>k=0.15</m>. Left) Updating function and cobwebbing, Right) Iterated solution.</caption>
</figure>

						<p>
							It appears that these solutions converge to a value <m>G^*\approx8.4</m> guppies. Can we do better than this guess? We know that our equilibrium satisfies, <me>\begin{aligned}
G^*&amp;=rG^* e^{-kG^*}\\
1&amp;=r e^{-kG^*}\\
e^{kG^*}&amp;=r \\
kG^*&amp;=\ln r \\
G^*&amp;=\frac{\ln r }{k}\end{aligned}</me> Immediately, we should see a few things. First <m>G^*=0</m> is always a solution to the first equation. Ignoring that, for <m>k&gt;0</m>, we have a positive equilibrium only when <m>r&gt;1</m> so that the logarithm is positive. We now know that for <m>r=3.7, k=0.15</m>, <m>G^*\approx8.722</m>.
						</p>

						<p>
							Depending on the intrinsic growth rate <m>r</m> (<term>rmax</term> in the code) of our guppies, we might see oscillatory or non-oscillatory approaches to equilibria. The solution generated by the black updating function (with <m>r=1</m>) approaches <m>G^*=0</m> (i.e., it has no <sq>nontrivial</sq> equilibrium point). Looking again at Fig. <xref ref="fig::f3_rmax" />, try to uncover a relationship between the tendency of the trajectory to oscillate (right panel) and the crossing point of the updating function and resetting line (left panel).
						</p>

						<figure>
	<image source="f3_rmax.pdf"/>
							<caption>Cobwebbing diagrams and iterated solutions as they depend on the maximal per capita production. Left) A collection of nice updating functions. Right) The corresponding iterated solutions.</caption>
</figure>

					</paragraphs>
				</paragraphs>

				<paragraphs xml:id="a-note-on-stability">
					<title>A note on stability</title>

					<p>
						As before (perturbations of linear non-homogeneous models), let <m>G_t=G^*+x_t</m> and recall <m>G_{t+1}=rG_t e^{-kG_t}=F(G_t)</m>. We have, <me>\begin{aligned}
\begin{split}
x_{t+1}&amp;=G_{t+1}-G^*\\
&amp;=F(G_t)-G^*\\
&amp;=\left(F(G^*)+F'(G^*)x_t+{\mathcal{O}}(x_t^2)\right)-G^*\\
&amp;=\left(\cancel{G^*}+F'(G^*)x_t+\cancel{{\mathcal{O}}(x_t^2)}\right)-\cancel{G^*}\\
x_{t+1}&amp;=F'(G^*)x_t
\end{split}\end{aligned}</me> Now, perturbations are governed by the <em>linear</em> equation <me>x_{t+1}=F'(G^*)x_t=ax_t,</me> where <m>\displaystyle a=\left.\frac{d^{} {F}}{d {G_t}^{}}\right|_{G^*}</m> describes its growth. The slope of the updating function governs stability. When,
					</p>

					<p><ul>
						<li>
											<p>
						<m>a</m> is <sq>too steep</sq> at <m>G^*</m> perturbations near <m>G^*</m> grow, so solutions diverge <em>from</em> <m>G^*</m>.
					</p>
						</li>

						<li>
											<p>
						<m>a</m> is <sq>shallow enough</sq> at <m>G^*</m> perturbations near <m>G^*</m> decay, so solutions converge <em>to</em> <m>G^*</m>.
					</p>
						</li>

					</ul></p>

				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="nonlinear-discrete-time-models-1-2d">
				<title>Nonlinear discrete-time models (1, 2D)</title>


				<paragraphs xml:id="review-p.c.p.-vs.-the-updating-function">
					<title>Review: p.c.p. vs. the updating function</title>

					<p>
						Multiplying <m>(p.c.p.)</m>, which is a function of <m>N_t</m>, by population size <m>N_t</m> gives our updating function, <m>f(N_t)=(p.c.p.)\times N_t</m>. Then, our model is <me>N_{t+1}=f(N_t)=(p.c.p.)\times N_t.</me> Some sample per capita production curves and the corresponding updating functions are plotted in Fig. <xref ref="fig::pcp_upd" />. Notice that we explicitly ignore immigration here.
					</p>

					<p>
						<image source='lin_nonlin_pcp.pdf'/><!-- linebreak --><image source='lin_nonlin_upd.pdf'/>
					</p>

					<p>
						Notice that there are some major qualitative changes when we compare the lines in the left panel to any of the curves in the right panel. Most importantly, the nonlinear updating function intersects the resetting line more than once. Again, at these intersections <me>N_{t+1}=N_t=N^*.</me> This suggests an alternative method to identify equilibria, which might sometimes be pictured more simply:
					</p>

					<p>
						Equilibria satisfy <m>N_{t+1}=N_t,</m> and we denote them by <m>N^*=N_{t+1}=N_t</m>. Given a model <m>N_{t+1}=f(N_t)N_t</m>, we can see that equilibria occur at points where <m>f(N_t)=1</m>. At values of <m>N_t</m> where our per capita production takes a value of one, we have equilibria.
					</p>

					<p>
						As before (perturbations of linear non-homogeneous models), let <m>G_t=G^*+x_t</m> and recall <m>G_{t+1}=rG_t e^{-kG_t}=F(G_t)</m>. We have, <me>\begin{aligned}
\begin{split}
x_{t+1}&amp;=G_{t+1}-G^*\\
&amp;=F(G_t)-G^*\\
&amp;=\left(F(G^*)+F'(G^*)x_t+{\mathcal{O}}(x_t^2)\right)-G^*\\
&amp;=\left(\cancel{G^*}+F'(G^*)x_t+\cancel{{\mathcal{O}}(x_t^2)}\right)-\cancel{G^*}\\
x_{t+1}&amp;=F'(G^*)x_t
\end{split}\end{aligned}</me> Now, the dynamics of <em>perturbations</em> are governed by the <em>linear</em> equation <me>x_{t+1}=F'(G^*)x_t=ax_t,</me> where <m>\displaystyle a=\left.\frac{d^{} {F}}{d {G_t}^{}}\right|_{G^*}</m> describes its growth. The slope of the updating function at or near the equilibrium point governs stability. When,
					</p>

					<p><ul>
						<li>
											<p>
						<m>a</m> is <sq>too steep</sq> at <m>G^*</m> perturbations near <m>G^*</m> grow, so solutions diverge <em>from</em> <m>G^*</m>.
					</p>
						</li>

						<li>
											<p>
						<m>a</m> is <sq>shallow enough</sq> at <m>G^*</m> perturbations near <m>G^*</m> decay, so solutions converge <em>to</em> <m>G^*</m>.
					</p>
						</li>

					</ul></p>

					<p>
						From our linear theory, we know that <m>x_t\rightarrow0</m> when <m>|a|&lt;1</m>.
					</p>


					<paragraphs xml:id="example-cont.">
						<title>Example (cont).</title>

						<p>
							Recall, <m>F(G)=rGe^{-kG}</m>, and <me>F'(G)= re^{-kG}(1-kG).</me> Evaluated at the equilibrium point, <m>G^*=\frac{\ln(r)}{k}</m>, <me>\begin{aligned}
F'(G^*)&amp;=re^{-kG^*}(1-kG^*)\\
&amp;=re^{-k\left(\frac{\ln(r)}{k}\right)}\left(1-k\left(\frac{\ln(r)}{k}\right)\right)\\
&amp;=re^{-\ln(r)}\left(1-\ln(r)\right)\\
F'(G^*)&amp;=1-\ln(r)\end{aligned}</me> We need <m>|F'(G^*)|&lt;1</m>, see Fig. <xref ref="fig::rick_bif" />. Also, <m>G^*=0</m> is stable when <m>r&lt;1</m>.
						</p>

						<figure>
	<image source="ricker_stab.pdf"/>
							<caption>Left). <m>G^*=\frac{\ln(r)}{k}</m> is stable for <m>1&lt;r&lt;e^2</m>. Right). <m>G^*=0</m> is stable for <m>0&lt;r&lt;1</m>. <m>G^*=\frac{\ln(r)}{k}</m> is stable for <m>1&lt;r&lt;e^2</m>. Beyond <m>r&gt;e^2</m>, oscillations emerge around the nontrivial equilibrium.</caption>
</figure>

						<figure>
	<image source="ricker_bif.pdf"/>
							<caption>Left). <m>G^*=\frac{\ln(r)}{k}</m> is stable for <m>1&lt;r&lt;e^2</m>. Right). <m>G^*=0</m> is stable for <m>0&lt;r&lt;1</m>. <m>G^*=\frac{\ln(r)}{k}</m> is stable for <m>1&lt;r&lt;e^2</m>. Beyond <m>r&gt;e^2</m>, oscillations emerge around the nontrivial equilibrium.</caption>
</figure>

						<p>
							<image source='ricker.pdf'/><!-- linebreak -->
						</p>

					</paragraphs>

					<paragraphs xml:id="catalog-of-models">
						<title>Catalog of models</title>

						<p><ul>
							<li>
													<p>
							<sq>Discrete logistic</sq> or Ricker model <me>N_{t+1}=N_te^{r(1-\frac{N_t}{K})},</me> Compare to our parameterization <me>N_{t+1}=rN_te^{-kN_t}.</me>
						</p>
							</li>

							<li>
													<p>
							Hassell model <me>N_{t+1}=\frac{aN_t}{(1+bN_t)^c}.</me>
						</p>
							</li>

							<li>
													<p>
							Beverton-Holt model <me>N_{t+1}=\frac{\lambda N_t}{(1+\left(\frac{\lambda-1}{K}\right)N_t)}.</me>
						</p>
							</li>

						</ul></p>

					</paragraphs>

					<paragraphs xml:id="summary-of-1d-nonlinear-difference-models">
						<title>Summary of 1D nonlinear difference models</title>

						<p><ul>
							<li>
													<p>
							Multiple equilibria<!-- linebreak -->Consequence of regulation
						</p>
							</li>

							<li>
													<p>
							Bifurcations<!-- linebreak -->Existence of equilibria depends on parameters, stability depends on parameters
						</p>
							</li>

							<li>
													<p>
							Oscillations
						</p>
							</li>

						</ul></p>

					</paragraphs>
				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="short-review-presentations">
				<title>Short Review + Presentations</title>


				<paragraphs xml:id="review-1d-vs.-2d-models-topics-and-tools">
					<title>Review: 1D vs. 2D models, topics and tools</title>

					<p>
						Today was mostly student presentations.
					</p>

				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="nonlinear-discrete-time-models-2d">
				<title>Nonlinear discrete-time models (2D)</title>


				<paragraphs xml:id="motivation-the-discrete-logistic">
					<title>Motivation: the discrete logistic</title>

					<p>
						The discrete logistic model is <me>Y_{t+1}=r(1-Y_t)Y_t,</me> where <m>Y_t</m> between <m>[0,1]</m> is the <sq>scaled density</sq> of hosts, and <m>p.c.p.=r(1-Y_t).</m> Expanding the model we can write, <me>Y_{t+1}=rY_t-(rY_t)Y_t.</me> Reading the model in this form, we can think of constant per capita births <m>r</m> but it looks like the per capita mortality is of the form <m>rY_t</m>. One interpretation of this is,
					</p>

					<p><ul>
						<li>
											<p>
						births are independent of population density
					</p>
						</li>

						<li>
											<p>
						death increases with population density
					</p>
						</li>

					</ul></p>

					<p>
						What if instead of your own species controlling your mortality (assuming you are a <m>Y_t</m>) a second species, <m>Z_t</m>, is responsible for your mortality. We’ll assume that it benefits from eating you, but would otherwise die out, its a specialist. We will assume that it is either better or worse at eating you than you are at eating/killing yourself, so that your per capita mortality as a function of the density of <m>Z_t</m> is <m>pZ_t</m>. We can rewrite <sq>your</sq> equation as, <me>Y_{t+1}=rY_t-(pZ_t)Y_t.</me>
					</p>

					<p>
						We’ll assume that a <m>Z_t</m> turns some fraction <m>\epsilon</m> of consumed <m>Y_t</m>’s into new <m>Z_t</m> (i.e., growth of <m>Z_t</m> depends directly on the amount of <m>Y_t</m> consumed). But again, in the absence of food <m>Z_t</m> will die. The equation for <m>Z_t</m> looks like, <me>Z_{t+1}=\epsilon(pY_t)Z_t-mZ_t.</me> Putting these together, we have our first 2D nonlinear system, <me>\begin{aligned}
Y_{t+1}&amp;=rY_t-pZ_tY_t\\
Z_{t+1}&amp;=\epsilon pY_tZ_t+mZ_t, \quad\text{this should be a $+m$ not a $-m$!}\end{aligned}</me>
					</p>

					<p>
						Notice that we could define <m>g=\epsilon p</m> if we wanted to simplify (the appearance) of the first term in <m>Z_{t+1}</m>. <me>\begin{aligned}
Y_{t+1}&amp;=rY_t-pZ_tY_t\\
Z_{t+1}&amp;= gY_tZ_t+mZ_t, \quad\text{this should be a $+m$ not a $-m$}!\end{aligned}</me>
					</p>


					<paragraphs xml:id="an-approach-to-nonlinear-multi-species-dynamics.">
						<title>An approach to nonlinear, multi-species dynamics.</title>

						<p>
							To study this model we could,
						</p>

						<p><ul>
							<li>
													<p>
							Iterate solutions numerically
						</p>
							</li>

							<li>
													<p>
							Attempt to <sq>solve it</sq>
						</p>
							</li>

						</ul></p>

						<p>
							To iterate our model, we would have to have parameter values and a suitable initial condition. We might not have a clue what these values are so we will ignore that approach and try to <sq>solve it.</sq> Solving such a model typically means,
						</p>

						<p><ul>
							<li>
													<p>
							compute equilibria
						</p>
							</li>

							<li>
													<p>
							compute linearization
						</p>
							</li>

							<li>
													<p>
							analyze stability
						</p>
							</li>

						</ul></p>

						<p>
							As before, equilibria requires <m>Y_{t+1}=Y_t=Y^*</m> and simultaneously <m>Z_{t+1}=Z_t=Z^*</m>. <me>\begin{aligned}
Y^*&amp;=rY^* -pZ^*Y^*\\
Z^*&amp;= gY^*Z^*+mZ^*, \quad\text{this should be a $+m$ not a $-m$!}\end{aligned}</me>
						</p>

						<p>
							To satisfy the first, either <m>Y^*=0</m> or <m>1=r-pZ^*</m>, the second of which implies, <me>Z^*=\frac{r-1}{p}.</me> To satisfy the second, either <m>Z^*=0</m> or <m>1=gY^*+m,</m> the second of which implies, <me>Y^*=\frac{1-m}{g}.</me> Thus our equilibria are <m>(Y^*, Z^*)=(0, 0)</m> or <m>(Y^*, Z^*)=(\frac{1-m}{g}, \frac{r-1}{p})</m>.
						</p>

						<p>
							We have to figure out how to determine stability at each equilibrium point to know whether or not species persist or go extinct. We might think that linear matrix theory, determinants, and eigenvalues would be of use here. Our first step is to form a linear approximation to our nonlinear dynamics near equilibria. To do so, we compute the Jacobian matrix, a matrix of partial derivatives.
						</p>

						<p>
							We notice that our model can be written as a set of two updating functions each depending on two variables, <me>\begin{aligned}
Y_{t+1}&amp;=F(Y_t, Z_t)=rY_t-pZ_tY_t\\
Z_{t+1}&amp;= G(Y_t, Z_t)=gY_tZ_t+mZ_t, \quad\text{this should be a $+m$ not a $-m$!}\end{aligned}</me> Now, the motivation and methodology are the same as with 1D models, we are interested in thinking about <m>Y_t=Y^*+y_t</m> and <m>Z_t=Z^*+z_t</m>, which means each solution (e.g., <m>Y_t</m>) is a combination of equilibrium value (e.g., <m>Y^*</m>) and some small perturbation (e.g., <m>y_t</m>). The Jacobian is a matrix of partial derivatives of our updating functions with respect to the state variables. We could derive this as we did with a Taylor series expansion of a 1D model.
						</p>

						<p>
							Then, skipping some steps, we can compute the Jacobian as follows (we will drop the subscripts for simplicity), <me>J(Y, Z)=\left(\begin{array}{cc}
\frac{\partial^{} {F}}{\partial {Y}^{}} &amp; \frac{\partial^{} {F}}{\partial {Z}^{}}\\[8pt]
\frac{\partial^{} {G}}{\partial {Y}^{}} &amp; \frac{\partial^{} {G}}{\partial {Z}^{}}
\end{array}\right).</me>
						</p>

						<p>
							Our work is not done, just yet. Since we are concerned with the dynamics <sq>near equilibrium</sq> we have to evaluate the Jacobian at the equilibrium. An example, in just a minute, should make this clear. <me>\left(\begin{array}{cc}
y_{t_1}\\[8pt]
z_{t+1}
\end{array}\right)=\left.\left(\begin{array}{cc}
\frac{\partial^{} {F}}{\partial {Y}^{}} &amp; \frac{\partial^{} {F}}{\partial {Z}^{}}\\[8pt]
\frac{\partial^{} {G}}{\partial {Y}^{}} &amp; \frac{\partial^{} {G}}{\partial {Z}^{}}
\end{array}\right)\right|_{(Y^*, Z^*)}\times\left(\begin{array}{cc}
y_{t}\\[8pt]
z_{t}
\end{array}\right).</me>
						</p>


						<paragraphs xml:id="example.-2">
							<title>Example.</title>

							<p>
								Continuing with our current model, we will compute the Jacobian. <me>\begin{aligned}
\frac{\partial^{} {F}}{\partial {Y}^{}} &amp;= \frac{\partial^{} {}}{\partial {Y}^{}}\left(rY-pZY\right)= r-pZ\\
\frac{\partial^{} {F}}{\partial {Z}^{}} &amp;= \frac{\partial^{} {}}{\partial {Z}^{}}\left(rY-pZY\right)= -pY\\
\frac{\partial^{} {G}}{\partial {Y}^{}} &amp;= \frac{\partial^{} {}}{\partial {Y}^{}}\left(gYZ-mZ\right)= gZ\\
\frac{\partial^{} {G}}{\partial {Z}^{}} &amp;= \frac{\partial^{} {}}{\partial {Z}^{}}\left(gYZ-mZ\right)= gY+m, \quad\text{this should be a $+m$ not a $-m$}.\end{aligned}</me>
							</p>

							<p>
								So,<me>J(Y,Z)=\left(\begin{array}{cc}
r-pZ\ &amp; -pY\\[8pt]
gZ &amp; gY+m
\end{array}\right), \quad\text{this should be a $+m$ not a $-m$}.</me>
							</p>

							<p>
								So at the <sq>zero</sq> equilibrium, <me>J(0,0)=\left(\begin{array}{cc}
r\ &amp; 0\\[8pt]
0 &amp; m
\end{array}\right), \quad\text{this should be a $+m$ not a $-m$}..</me>
							</p>

							<p>
								So at the nontrivial equilibrium, <me>J^*=J(Y^*,Z^*)=\left(\begin{array}{cc}
r-p\left(\frac{r-1}{p}\right)\ &amp; -p\left(\frac{1-m}{g}\right)\\[8pt]
g\left(\frac{r-1}{p}\right) &amp; g\left(\frac{1-m}{g}\right)+m
\end{array}\right)=
\left(\begin{array}{cc}
1 &amp; -p\left(\frac{1-m}{g}\right)\\[8pt]
g\left(\frac{r-1}{p}\right) &amp; 1
\end{array}\right).</me>
							</p>

							<p>
								Rather than compute and study the eigenvalues directly, we’ll take the scenic route to our solution. We will compute a few key properties of the matrix to understand the behavior of eigenvalues: trace, determinant, and discriminant. The trace of <m>J^*</m>, <me>\tau(J^*)=\operatorname{Tr}(J^*),</me> is the sum of its diagonal entries, and in this case the diagonal sums to <m>\tau=2</m>. The determinant of <m>J^*</m> is, <me>\Delta(J^*)=\operatorname{det}(J^*)=1+(1-m)(r-1).</me> The discriminant of <m>J^*</m>, is <m>\operatorname{Disc}(J^*)=\tau^2-4\Delta</m>, and <me>\operatorname{Disc}(J^*)=-4(1-m)(r-1).</me> Eigenvalues are given by, <me>\lambda_\pm=\frac{\tau\pm\sqrt{\tau^2-4\Delta}}{2},</me> and they are real if <m>\operatorname{Disc}(J^*)=\tau^2-4\Delta&gt;0</m> and imaginary otherwise. One thing is certain, we need <me>-1&lt;\frac{\tau}{2}&lt;1.</me> This is because we want the roots to be between <m>(-1,1)</m>. If we want <em>roots</em> in this interval, the vertex of the parabola better be there too. We’ll use the location of the vertex and <em>distance</em> to the roots to compute some stability criterion and build a stability diagram, next time.
							</p>

							<table>
								<caption></caption>
								<tabular>
								<row header="yes">
									<cell halign="center">Equilibrium</cell>
									<cell halign="center"><m>\tau=\operatorname{Tr}(J^*)</m></cell>
									<cell halign="center"><m>\Delta=\operatorname{det}(J^*)</m></cell>
									<cell halign="center"><m>\operatorname{Disc}(J^*)=\tau^2-4\Delta</m></cell>
									<cell halign="center"><m>\lambda_i</m></cell>
								</row>
								<row class="odd">
									<cell halign="center"><m>(0, 0)</m></cell>
									<cell halign="center"><m>r+m</m></cell>
									<cell halign="center"><m>rm</m></cell>
									<cell halign="center"><m>(r-m)^2</m></cell>
									<cell halign="center">Real</cell>
								</row>
								<row class="even">
									<cell halign="center"><m>(Y^*, Z^*)</m></cell>
									<cell halign="center"><m>2</m></cell>
									<cell halign="center"><m>1+(1-m)(r-1)</m></cell>
									<cell halign="center"><m>-4(1-m)(r-1)</m></cell>
									<cell halign="center">Complex (if <m>r&gt;1</m>)</cell>
								</row>
								</tabular>
							</table>

							<p>
								We will briefly see why this is a worrisome model, and move on to more biologically interesting models. The trivial equilibrium <m>(0, 0)</m> will be stable for stupidly small values of <m>r, m</m>. The nontrivial equilibrium is unstable and oscillatory, meaning that practically a species will crash into the number zero and go extinct.
							</p>

						</paragraphs>
					</paragraphs>
				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="nonlinear-discrete-time-models-2d-stability-criterion">
				<title>Nonlinear discrete-time models (2D): Stability criterion</title>


				<paragraphs xml:id="stability">
					<title>Stability</title>

					<p>
						Consider the Jacobian matrix <m>J^*</m> from the linearization of a 2D model. For <me>J^*=\left(\begin{array}{cc}a &amp; b\\c&amp; d\end{array}\right),</me> the associated characteristic polynomial is <me>C(\lambda)=\lambda^2-\tau \lambda+\Delta,</me> where <m>\tau</m> is the trace and <m>\Delta</m> is the determinant. Solving this with the quadratic formula, <me>\lambda_\pm=\frac{\tau\pm\sqrt{\tau^2-4\Delta}}{2}.</me>
					</p>

					<p>
						We’ll take a graphical approach to understanding the behavior of roots. First, notice that the vertex of the parabola is at <m>\frac{\tau}{2},</m> since the roots are symmetric about the vertex. We’ll assume the eigenvalues are distinct and that <m>\lambda_+&gt;\lambda_-</m>.
					</p>

					<p>
						For the leading eigenvalue, <m>\lambda_+&lt;1</m>, we need <me>\begin{aligned}
\lambda_+=\frac{\tau}{2}+\frac{\sqrt{\tau^2-4\Delta}}{2}&amp;&lt;1\\
\frac{\sqrt{\tau^2-4\Delta}}{2}&amp;&lt;1-\frac{\tau}{2}\\
\frac{\tau^2-4\Delta}{4}&amp;&lt;\left(1-\frac{\tau}{2}\right)^2\\
\frac{\tau^2}{4}-\Delta&amp;&lt;1-\tau+\frac{\tau^2}{4}\\
-\Delta&amp;&lt;1-\tau\Rightarrow -1+\tau&lt;\Delta\end{aligned}</me> If the determinant satisfies <me>-1+\tau&lt;\Delta,</me> then <m>\lambda_+&lt;1</m>.
					</p>

					<p>
						For the other eigenvalue, <m>\lambda_-&gt;-1</m>, we need <me>\begin{aligned}
\lambda_-=\frac{\tau}{2}-\frac{\sqrt{\tau^2-4\Delta}}{2}&amp;&gt;-1\\
1+\frac{\tau}{2} &amp; &gt; \frac{\sqrt{\tau^2-4\Delta}}{2}\\
\left(1+\frac{\tau}{2}\right)^2 &amp; &gt; \frac{\tau^2-4\Delta}{4}\\
1+\tau+\frac{\tau^2}{4} &amp; &gt; \frac{\tau^2}{4}-\Delta\\
1+\tau&amp; &gt; -\Delta\Rightarrow -1-\tau&lt;\Delta\end{aligned}</me> If the determinant satisfies <me>-1-\tau&lt;\Delta,</me> then <m>\lambda_-&gt;-1</m>.
					</p>

					<p>
						We need both eigenvalue conditions satisfied simultaneously, so that <me>\Delta&gt;|\tau|-1.</me> The second line from each calculation is easily visualized in the following picture, roughly, the distance from the vertex to the root, <me>\frac{\sqrt{\tau^2-4\Delta}}{2}</me> is less than the distance from the vertex to the enclosing endpoint (see Fig. <xref ref="fig::roots" />).
					</p>

					<figure>
	<image source="char_poly.pdf"/>
						<caption>Roots of the characteristic polynomial.</caption>
</figure>

					<p>
						Lastly, we need complex roots which arise when <m>\tau^2-4\Delta&lt;0</m>, to satisfy <m>|\lambda_i|&lt;1</m>. <me>\begin{aligned}
\lambda_\pm&amp;=\frac{\tau}{2}\pm\frac{\sqrt{\tau^2-4\Delta}}{2}\\
&amp;=\frac{\tau}{2}\pm i \frac{\sqrt{4\Delta-\tau^2}}{2}\\
|\lambda_\pm|&amp;=\frac{\tau^2}{4}+ \Delta-\frac{\tau^2}{4}\\
|\lambda_\pm|&amp;=\Delta\Rightarrow \Delta&lt;1\end{aligned}</me>
					</p>


					<paragraphs xml:id="stability-triangle">
						<title>Stability triangle</title>

						<p>
							We need
						</p>

						<p><ul>
							<li>
													<p>
							<m>\operatorname{det}(J^*)&lt;1</m>
						</p>
							</li>

							<li>
													<p>
							<m>\operatorname{det}(J^*) &gt; -1+| \operatorname{Tr}(J^*)|</m>
						</p>
							</li>

							<li>
													<p>
							Under <m>\operatorname{det}(J^*)=\frac{\operatorname{Tr}(J^*)^2}{4}</m> eigenvalues are real.
						</p>
							</li>

						</ul></p>

						<figure>
	<image source="discrete_stab.pdf"/>
							<caption>Roots of the characteristic polynomial. <m>\tau</m> lies along the horizontal axis and <m>\Delta</m> along the vertical axis.</caption>
</figure>

					</paragraphs>
				</paragraphs>
			</subsubsection>

			<subsubsection xml:id="nicholson-bailey-and-on-to-continuous-tim">
				<title>Nicholson-Bailey and on to continuous tim</title>


				<paragraphs xml:id="nicholson-bailey">
					<title>Nicholson-Bailey</title>

					<p>
						Stability of 2D, nonlinear, discrete-time models is summarized in Fig. <xref ref="fig::tri" />, using properties (matrix trace, determinant, and discriminant) of the Jacobian matrix evaluated at equilibrium. An equilibrium is stable only when its trace and determinant map to regions within the triangle. Transient dynamics are governed by the sign of the discriminant, when the discriminant is negative, eigenvalue are complex and trajectories are oscillatory. Otherwise, eigenvalues are real and non-oscillatory.
					</p>

					<p>
						Why do we want <sq>small</sq> eigenvalues? We want small eigenvalues because we have linearized the system near an equilibrium point. We want perturbations to decay so that our solution returns (in some way, oscillatory or not) to equilibrium. Thus, we want the <m>(0,0)</m> equilibrium of our perturbed coordinate system to be stable. If we write for some 2D nonlinear system <m>(X_t, Y_t)=(X^*+\hat x_t, Y^*+\hat y_t)</m>, where <m>\hat x_t</m> and <m>\hat y_t</m> are our perturbations, we want both <m>\hat x_t, \hat y_t\rightarrow0</m> so that <m>(X_t, Y_t)\rightarrow(X^*, Y^*)</m>. We keep using the phrase <sq>want</sq> because biologically <m>(X_t\rightarrow0,Y_t\rightarrow0)</m> and <m>(X_t\rightarrow\infty, Y_t\rightarrow\infty)</m> are often uninteresting outcomes.
					</p>

					<figure>
	<image source="discrete_stability.pdf"/>
						<caption>Eigenvalues are real in the hatched region and the equilibrium is stable. Eigenvalues are complex in the solid region and the equilibrium is stable, but approach to equilibrium is via damped oscillations. Outside these regions, corresponding equilibria are unstable. Above the parabola, solutions oscillation away from equilibria. <m>\tau</m> lies along the horizontal axis and <m>\Delta</m> along the vertical axis.</caption>
</figure>

				</paragraphs>

				<paragraphs xml:id="a-quick-example.">
					<title>A quick example.</title>

					<p>
						We built our first 2D model from a poor starting point, the discrete logistic model. We learned, intentionally and accidentally, that multiplying by negative numbers is a bad idea. We hope to develop models where the right hand sides can become small, but remain positive.
					</p>

					<p>
						We will quickly look at the classic Nicholson-Bailey model. The model assumes that caterpillars are an engine for turning out parasitoids, each infected caterpillar produces a fixed amount of parasitoid larvae. The model of invertebrate host-parasitoid dynamics is of the form, <me>\begin{aligned}
H_{t+1}&amp;= (\text{host fecundity})\times(\text{host fraction surviving parasitism})\times(\text{host population size})\\
P_{t+1}&amp;= (\text{parasitoid production per host})\times(\text{host fraction succumbing parasitism})\\
&amp;\qquad\times(\text{host population size})\end{aligned}</me>
					</p>

					<p>
						Host fecundity is just a constant, <m>\lambda</m>. The host fraction surviving parasitism is, for now, some arbitrary function of <m>P_t</m> and <m>H_t</m>, <m>f(H_t, P_t)</m>. The parasitoid production per host is another constant, <m>c</m>. Since all hosts are either parasitized or not, the fraction that succumbs to parasitism is <m>1-f(H_t, P_t)</m>.
					</p>

					<p>
						The fraction that survives parasitism, <m>f(H_t, P_t)</m>, is an important component of the model. We will now build a model for this term using some basic logic, a few key assumptions, and probability. We define the number of host-parasitoid encounters, <m>E</m>, and assume it is proportional to the densities of <m>H_t</m> and <m>P_t</m>, <me>E=aH_tP_t.</me> The parameter <m>a</m> is the constant of proportionality, and the number of encounters is bilinear in <m>H_t</m> and <m>P_t</m>. Caterpillars are a fixed size and only ’have space’ for a fixed number of parasitoids. Think of them as a parasitoid hotel, at some point all rooms are full and it doesn’t matter how many new travelers stop - they can try but there are no more rooms left.
					</p>

					<p>
						On to our last piece of the model: the Poisson distribution. This distribution governs the number of events to occur in some time interval, when events occur at some fixed rate, <m>\mu</m>. The probability of <m>r</m> events is <me>Q(r)=\frac{e^{-\mu}\mu^r}{r!}.</me> The average number of attacks per host per generation is <me>\mu=\frac{E}{H_t}=\frac{aH_tP_t}{H_t}=aP_t.</me> According to our second assumption we only care whether a host is parasitized or not (i.e., whether <m>r=0</m> or <m>r&gt;0</m>). Thus, we want <me>f(N_t, P_t)=Q(0)=\frac{e^{-aP_t}(aP_t)^0}{0!}=e^{-aP_t}.</me> Plugging in <m>f(H_t, P_t)</m>, <me>\begin{aligned}
H_{t+1}&amp;= \lambda e^{-a P_t}H_t\\
P_{t+1}&amp;=c (1-e^{-a P_t})H_t.\end{aligned}</me> A few special cases suggest that when <m>P_t=0</m>, <m>H_t</m> grows geometrically, but when <m>P_t</m> is <sq>large</sq> few hosts escape parasitism. We might wish to limit host growth in the absence of parasitism, which could be accomplished by defining <m>\lambda=\lambda(H_t)</m> as some reasonable decreasing function of host population density. Some trajectories (for parameters corresponding to those in the book) are plotted in Fig. <xref ref="fig::NBsols" />.
					</p>

					<figure>
	<image source="pars_pert.pdf"/>
						<caption>Sample dynamics of Nicholson-Bailey. Left) Perturbations in three parameters. Notice that some host populations appear to escape parasitoids. Right) Perturbations in initial conditions. Small changes in initial conditions drastically effect dynamics.</caption>
</figure>

					<figure>
	<image source="IC_pert.pdf"/>
						<caption>Sample dynamics of Nicholson-Bailey. Left) Perturbations in three parameters. Notice that some host populations appear to escape parasitoids. Right) Perturbations in initial conditions. Small changes in initial conditions drastically effect dynamics.</caption>
</figure>

					<p>
						We can pretty easily see the <sq>problems</sq> with these dynamics. Actually evaluating the stability conditions for this and other models is occasionally quite enlightening and can give a nice interpretation of the relationships between certain terms (rates and interactions) in our model. One particularly interesting situation occurs when matrix traces and determinants lie on the edges of stability, where bifurcations are borne.
					</p>

				</paragraphs>
			</subsubsection>
		</subsection>

		<subsection xml:id="references">
			<title>References</title>

			<p><ul>
				<li>
							<p>
				Leah Edelstein-Keshet. (2005). Mathematical Models in Biology. ISBN 0989715547.
			</p>
				</li>

				<li>
							<p>
				ES Allman and JA Rhodes. (2004). Mathematical Models in Biology: An Introduction Cambridge University Press.
			</p>
				</li>

				<li>
							<p>
				NJ Gotelli. (1998). A Primer of Ecology, 2nd Edition, Sinauer.
			</p>
				</li>

				<li>
							<p>
				JP Keener and J Sneyd. (2008). Mathematical Physiology, 2nd edition, Springer.
			</p>
				</li>

				<li>
							<p>
				JD Murray. (1989) Mathematical Biology. Springer, Series Biomathematics 19, 767p., ISBN 3-540-19460-6, 0-387-19460-6
			</p>
				</li>

				<li>
							<p>
				RM Nisbet, WSC Gurney (1982) Modelling Fluctuating Populations. Chichester: Wiley, 379p., ISBN 0-471-28058-5
			</p>
				</li>

				<li>
							<p>
				HG Othmer, FR Adler, MA Lewis and JC Dalton (eds). (1997) Case Studies in Mathematical Modeling: Ecology, Physiology and Cell Biology. Prentice-Hall, Inc. Upper Saddle River, NJ. ISBN 0-13-574039-8
			</p>
				</li>

				<li>
							<p>
				EC Pielou. (1977) An Introduction to Mathematical Ecology. New York: Wiley; 385 p., ISBN 0-471-01993-3
			</p>
				</li>

			</ul></p>
		</subsection>

	</section>



</article>
</pretext>
